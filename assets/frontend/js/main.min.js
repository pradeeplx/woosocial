!function(o,t){var a={cache:function(){a.els={},a.vars={},a.els.actions_list=o(".jck-woosocial-actions"),a.els.tab_links=o(".jck-woosocial-profile-link"),a.els.tab_content=o(".jck-woosocial-tab-content"),a.els.load_more_button=o(".jck-woosocial-load-more"),a.els.action_blocks=o(".jck-woosocial-action"),a.els.likes_container=o(".jck-woosocial-user-likes"),a.els.add_to_cart_buttons=o(".jck-woosocial-add-to-cart-wrapper .add_to_cart_button"),a.els.tick_icon=o('<i class="jck-woosocial-ic-tick"></i>'),a.els.loading_icon=o('<i class="jck-woosocial-ic-loading jck-woosocial-spin"></i>'),a.vars.action_offset=1,a.vars.is_hidden_class="jck-woosocial--is-hidden"},on_ready:function(){a.cache(),a.setup_follow_actions(),a.setup_like_action(),a.setup_tabs(),a.setup_load_more(),a.setup_activity_log(),a.add_to_cart()},on_scroll:function(){a.scroll_activity_log()},setup_follow_actions:function(){o(".jck-woosocial-follow-action").on("click",function(){var t=o(this),s=t.attr("data-user-id"),i=t.attr("data-type"),c="jck-woosocial-follow-action--loading";"login"===i||t.hasClass(c)||(t.addClass(c),o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_follow_action",nonce:jck_woosocial_vars.nonce,user_id:s,type:i},success:function(s){t.text(s.button.text),t.attr("data-type",s.button.type),t.removeClass(c),t.removeClass("jck-woosocial-follow-action--"+i),t.addClass("jck-woosocial-follow-action--"+s.button.type),s.add_follow_html&&a.els.actions_list.prepend(s.add_follow_html),s.remove_follow_class&&o(s.remove_follow_class).remove()},error:function(o){}}))})},setup_like_action:function(){o(t).on("click",".jck-woosocial-like-action",function(){var t=o(this),a=t.closest(".jck-woosocial-likes"),s=t.attr("data-product-id"),i=t.attr("data-type"),c=t.find(".jck-woosocial-like-button__count"),e="jck-woosocial-follow-action--loading";return t.hasClass(e)||(t.addClass(e),o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_like_action",nonce:jck_woosocial_vars.nonce,product_id:s,type:i},success:function(o){if(c.length>0){var s=parseInt(c.text()),n="like"===i?s+1:s-1;c.text(n),t.attr("data-type",o.button.type),t.removeClass(e),t.removeClass("jck-woosocial-like-action--"+i),t.addClass("jck-woosocial-like-action--"+o.button.type),o.add_like_html&&a.find(".jck-woosocial-likes__item--like-button").after(o.add_like_html),o.remove_like_class&&a.find(o.remove_like_class).remove()}},error:function(o){}})),!1})},setup_tabs:function(){a.els.tab_links.on("click",function(){var t=o(this).attr("href"),s="jck-woosocial-profile-link--active";return a.els.tab_links.removeClass(s),o(this).addClass(s),a.els.tab_content.hide(),o(t).show(),eqjs.refreshNodes(),eqjs.query(),!1})},setup_load_more:function(){a.els.load_more_button.on("click",function(){o(this).hasClass("jck-woosocial-load-more--activity")&&a.load_more_activity(o(this)),o(this).hasClass("jck-woosocial-load-more--likes")&&a.load_more_likes(o(this))})},load_more_activity:function(t){var a=parseInt(t.attr("data-limit")),s=parseInt(t.attr("data-offset")),i=a+s,c=t.attr("data-user-id"),e=t.attr("data-profile-user-id"),n=t.parent();o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_activity",nonce:jck_woosocial_vars.nonce,limit:a,offset:s,user_id:c,profile_user_id:e},success:function(o){o.activity_html?(n.before(o.activity_html),t.attr("data-offset",i)):n.remove()},error:function(o){}})},load_more_likes:function(t){var s=parseInt(t.attr("data-limit")),i=parseInt(t.attr("data-offset")),c=s+i,e=t.attr("data-user-id");o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_likes",nonce:jck_woosocial_vars.nonce,limit:s,offset:i,user_id:e},success:function(o){o.likes_html?(a.els.likes_container.append(o.likes_html),t.attr("data-offset",c)):t.remove()},error:function(o){}})},setup_activity_log:function(){a.hide_actions(a.els.action_blocks,a.vars.action_offset)},hide_actions:function(t,s){t.each(function(){o(this).offset().top>o(window).scrollTop()+o(window).height()*s&&o(this).find(".jck-woosocial-action__icon, .jck-woosocial-action__wrapper").css({opacity:0}).addClass(a.vars.is_hidden_class)})},show_actions:function(t,s){t.each(function(){o(this).offset().top<=o(window).scrollTop()+o(window).height()*s&&o(this).find(".jck-woosocial-action__icon").hasClass(a.vars.is_hidden_class)&&o(this).find(".jck-woosocial-action__icon, .jck-woosocial-action__wrapper").removeClass(a.vars.is_hidden_class).animate({opacity:1})})},scroll_activity_log:function(){window.requestAnimationFrame?window.requestAnimationFrame(function(){a.show_actions(a.els.action_blocks,a.vars.action_offset)}):setTimeout(function(){a.show_actions(a.els.action_blocks,a.vars.action_offset)},100)},add_to_cart:function(){a.els.add_to_cart_buttons.on("click",function(){var t=o(this),s=t.text();t.attr("data-button-text",s).append(a.els.loading_icon)}),o(t.body).on("added_to_cart",function(o,t,s,i){var c=i.closest(".jck-woosocial-add-to-cart-wrapper"),e=i.attr("data-button-text");c.length>0&&(i.html(e).append(a.els.tick_icon),setTimeout(function(){i.html(e)},2e3))})}};o(t).ready(a.on_ready()),o(window).on("scroll",function(){a.on_scroll()})}(jQuery,document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwiamNrX3dvb3NvY2lhbCIsImNhY2hlIiwiZWxzIiwidmFycyIsImFjdGlvbnNfbGlzdCIsInRhYl9saW5rcyIsInRhYl9jb250ZW50IiwibG9hZF9tb3JlX2J1dHRvbiIsImFjdGlvbl9ibG9ja3MiLCJsaWtlc19jb250YWluZXIiLCJhZGRfdG9fY2FydF9idXR0b25zIiwidGlja19pY29uIiwibG9hZGluZ19pY29uIiwiYWN0aW9uX29mZnNldCIsImlzX2hpZGRlbl9jbGFzcyIsIm9uX3JlYWR5Iiwic2V0dXBfZm9sbG93X2FjdGlvbnMiLCJzZXR1cF9saWtlX2FjdGlvbiIsInNldHVwX3RhYnMiLCJzZXR1cF9sb2FkX21vcmUiLCJzZXR1cF9hY3Rpdml0eV9sb2ciLCJhZGRfdG9fY2FydCIsIm9uX3Njcm9sbCIsInNjcm9sbF9hY3Rpdml0eV9sb2ciLCJvbiIsIiRidXR0b24iLCJ0aGlzIiwidXNlcl9pZCIsImF0dHIiLCJ0eXBlIiwibG9hZGluZ19jbGFzcyIsImhhc0NsYXNzIiwiYWRkQ2xhc3MiLCJhamF4IiwidXJsIiwiamNrX3dvb3NvY2lhbF92YXJzIiwiYWpheF91cmwiLCJkYXRhVHlwZSIsImNyb3NzRG9tYWluIiwiZGF0YSIsImFjdGlvbiIsIm5vbmNlIiwic3VjY2VzcyIsInRleHQiLCJidXR0b24iLCJyZW1vdmVDbGFzcyIsImFkZF9mb2xsb3dfaHRtbCIsInByZXBlbmQiLCJyZW1vdmVfZm9sbG93X2NsYXNzIiwicmVtb3ZlIiwiZXJyb3IiLCIkY3VycmVudF9saWtlc19saXN0IiwiY2xvc2VzdCIsInByb2R1Y3RfaWQiLCIkY291bnQiLCJmaW5kIiwibGVuZ3RoIiwiY291bnQiLCJwYXJzZUludCIsIm5ld19jb3VudCIsImFkZF9saWtlX2h0bWwiLCJhZnRlciIsInJlbW92ZV9saWtlX2NsYXNzIiwidGFyZ2V0IiwiYWN0aXZlX2NsYXNzIiwiaGlkZSIsInNob3ciLCJlcWpzIiwicmVmcmVzaE5vZGVzIiwicXVlcnkiLCJsb2FkX21vcmVfYWN0aXZpdHkiLCJsb2FkX21vcmVfbGlrZXMiLCIkbG9hZF9tb3JlX2J1dHRvbiIsImxpbWl0Iiwib2Zmc2V0IiwibmV4dF9vZmZzZXQiLCJwcm9maWxlX3VzZXJfaWQiLCIkbG9hZF9tb3JlX2l0ZW0iLCJwYXJlbnQiLCJhY3Rpdml0eV9odG1sIiwiYmVmb3JlIiwibGlrZXNfaHRtbCIsImFwcGVuZCIsImhpZGVfYWN0aW9ucyIsIiRhY3Rpb25fYmxvY2tzIiwiZWFjaCIsInRvcCIsIndpbmRvdyIsInNjcm9sbFRvcCIsImhlaWdodCIsImNzcyIsIm9wYWNpdHkiLCJzaG93X2FjdGlvbnMiLCJhbmltYXRlIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwic2V0VGltZW91dCIsImJ1dHRvbl90ZXh0IiwiYm9keSIsImUiLCJmcmFnbWVudHMiLCJjYXJ0X2hhc2giLCIkd29vc29jaWFsX2J1dHRvbl93cmFwcGVyIiwiaHRtbCIsInJlYWR5IiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUVBLEdBQUFDLElBRUFDLE1BQUEsV0FDQUQsRUFBQUUsT0FDQUYsRUFBQUcsUUFFQUgsRUFBQUUsSUFBQUUsYUFBQU4sRUFBQSwwQkFDQUUsRUFBQUUsSUFBQUcsVUFBQVAsRUFBQSwrQkFDQUUsRUFBQUUsSUFBQUksWUFBQVIsRUFBQSw4QkFDQUUsRUFBQUUsSUFBQUssaUJBQUFULEVBQUEsNEJBQ0FFLEVBQUFFLElBQUFNLGNBQUFWLEVBQUEseUJBQ0FFLEVBQUFFLElBQUFPLGdCQUFBWCxFQUFBLDZCQUNBRSxFQUFBRSxJQUFBUSxvQkFBQVosRUFBQSwwREFDQUUsRUFBQUUsSUFBQVMsVUFBQWIsRUFBQSx5Q0FDQUUsRUFBQUUsSUFBQVUsYUFBQWQsRUFBQSwrREFHQUUsRUFBQUcsS0FBQVUsY0FBQSxFQUNBYixFQUFBRyxLQUFBVyxnQkFBQSw0QkFJQUMsU0FBQSxXQUVBZixFQUFBQyxRQUNBRCxFQUFBZ0IsdUJBQ0Fo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LEVBQUF2RSxFQUFBRyxLQUFBLG1CQUVBeUUsR0FBQTdDLE9BQUEsSUFFQS9CLEVBQ0E2RSxLQUFBTixHQUNBZCxPQUFBbEYsRUFBQUUsSUFBQVMsV0FFQW9GLFdBQUEsV0FFQXRFLEVBQUE2RSxLQUFBTixJQUVBLFNBVUFsRyxHQUFBQyxHQUFBd0csTUFBQXZHLEVBQUFlLFlBRUFqQixFQUFBeUYsUUFBQS9ELEdBQUEsU0FBQSxXQUNBeEIsRUFBQXNCLGVBR0FrRixPQUFBekciLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oJCwgZG9jdW1lbnQpIHtcbiAgICBcbiAgICB2YXIgamNrX3dvb3NvY2lhbCA9IHtcbiAgICAgICAgXG4gICAgICAgIGNhY2hlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzID0ge307XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnZhcnMgPSB7fTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuYWN0aW9uc19saXN0ID0gJCgnLmpjay13b29zb2NpYWwtYWN0aW9ucycpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMudGFiX2xpbmtzID0gJCgnLmpjay13b29zb2NpYWwtcHJvZmlsZS1saW5rJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50YWJfY29udGVudCA9ICQoJy5qY2std29vc29jaWFsLXRhYi1jb250ZW50Jyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5sb2FkX21vcmVfYnV0dG9uID0gJCgnLmpjay13b29zb2NpYWwtbG9hZC1tb3JlJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5hY3Rpb25fYmxvY2tzID0gJCgnLmpjay13b29zb2NpYWwtYWN0aW9uJyk7ICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5saWtlc19jb250YWluZXIgPSAkKCcuamNrLXdvb3NvY2lhbC11c2VyLWxpa2VzJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5hZGRfdG9fY2FydF9idXR0b25zID0gJCgnLmpjay13b29zb2NpYWwtYWRkLXRvLWNhcnQtd3JhcHBlciAuYWRkX3RvX2NhcnRfYnV0dG9uJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50aWNrX2ljb24gPSAkKCc8aSBjbGFzcz1cImpjay13b29zb2NpYWwtaWMtdGlja1wiPjwvaT4nKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmxvYWRpbmdfaWNvbiA9ICQoJzxpIGNsYXNzPVwiamNrLXdvb3NvY2lhbC1pYy1sb2FkaW5nIGpjay13b29zb2NpYWwtc3BpblwiPjwvaT4nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnZhcnMuYWN0aW9uX29mZnNldCA9IDE7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnZhcnMuaXNfaGlkZGVuX2NsYXNzID0gXCJqY2std29vc29jaWFsLS1pcy1oaWRkZW5cIjtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuIFxuICAgICAgICBvbl9yZWFkeTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuY2FjaGUoKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuc2V0dXBfZm9sbG93X2FjdGlvbnMoKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuc2V0dXBfbGlrZV9hY3Rpb24oKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuc2V0dXBfdGFicygpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9sb2FkX21vcmUoKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuc2V0dXBfYWN0aXZpdHlfbG9nKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmFkZF90b19jYXJ0KCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIG9uX3Njcm9sbDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuc2Nyb2xsX2FjdGl2aXR5X2xvZygpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgIFxuICAgICAgICBzZXR1cF9mb2xsb3dfYWN0aW9uczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQoJy5qY2std29vc29jaWFsLWZvbGxvdy1hY3Rpb24nKS5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciAkYnV0dG9uID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9pZCA9ICRidXR0b24uYXR0cignZGF0YS11c2VyLWlkJyksXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAkYnV0dG9uLmF0dHIoJ2RhdGEtdHlwZScpLFxuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nX2NsYXNzID0gJ2pjay13b29zb2NpYWwtZm9sbG93LWFjdGlvbi0tbG9hZGluZyc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoIHR5cGUgPT09IFwibG9naW5cIiApIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoICEkYnV0dG9uLmhhc0NsYXNzKGxvYWRpbmdfY2xhc3MpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAkYnV0dG9uLmFkZENsYXNzKGxvYWRpbmdfY2xhc3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICBcdFx0XHRcdHR5cGU6ICAgICAgICBcIkdFVFwiLFxuICAgICAgICAgICAgXHRcdFx0XHR1cmw6ICAgICAgICAgamNrX3dvb3NvY2lhbF92YXJzLmFqYXhfdXJsLFxuICAgICAgICAgICAgXHRcdFx0XHRjYWNoZTogICAgICAgZmFsc2UsXG4gICAgICAgICAgICBcdFx0XHRcdGRhdGFUeXBlOiAgICBcImpzb25wXCIsXHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0Y3Jvc3NEb21haW46IHRydWUsXG4gICAgICAgICAgICBcdFx0XHRcdGRhdGE6IHtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRhY3Rpb246ICAnamNrX3dvb3NvY2lhbF9mb2xsb3dfYWN0aW9uJyxcbiAgICAgICAgICAgIFx0XHRcdFx0XHRub25jZTogICBqY2tfd29vc29jaWFsX3ZhcnMubm9uY2UsXG4gICAgICAgICAgICBcdFx0XHRcdFx0dXNlcl9pZDogdXNlcl9pZCxcbiAgICAgICAgICAgIFx0XHRcdFx0XHR0eXBlOiAgICB0eXBlXG4gICAgICAgICAgICBcdFx0XHRcdH0sXG4gICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLnRleHQoZGF0YS5idXR0b24udGV4dCk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5hdHRyKCdkYXRhLXR5cGUnLGRhdGEuYnV0dG9uLnR5cGUpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24ucmVtb3ZlQ2xhc3MobG9hZGluZ19jbGFzcyk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5yZW1vdmVDbGFzcygnamNrLXdvb3NvY2lhbC1mb2xsb3ctYWN0aW9uLS0nK3R5cGUpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24uYWRkQ2xhc3MoJ2pjay13b29zb2NpYWwtZm9sbG93LWFjdGlvbi0tJytkYXRhLmJ1dHRvbi50eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHRpZihkYXRhLmFkZF9mb2xsb3dfaHRtbCkge1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHRqY2tfd29vc29jaWFsLmVscy5hY3Rpb25zX2xpc3QucHJlcGVuZChkYXRhLmFkZF9mb2xsb3dfaHRtbCk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0fVxuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdGlmKGRhdGEucmVtb3ZlX2ZvbGxvd19jbGFzcykge1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkKGRhdGEucmVtb3ZlX2ZvbGxvd19jbGFzcykucmVtb3ZlKCk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0fVxuICAgICAgICAgICAgXHRcdFx0XHR9LFxuICAgICAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdH1cbiAgICAgICAgICAgIFx0XHRcdH0pO1xuICAgICAgICBcdFx0XHRcbiAgICAgICAgXHRcdFx0fVxuICAgIFx0XHRcdFxuICAgIFx0XHRcdH1cblx0XHRcdFxuXHRcdFx0fSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNldHVwX2xpa2VfYWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5qY2std29vc29jaWFsLWxpa2UtYWN0aW9uJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgJGJ1dHRvbiA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICRjdXJyZW50X2xpa2VzX2xpc3QgPSAkYnV0dG9uLmNsb3Nlc3QoJy5qY2std29vc29jaWFsLWxpa2VzJyksXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfaWQgPSAkYnV0dG9uLmF0dHIoJ2RhdGEtcHJvZHVjdC1pZCcpLFxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gJGJ1dHRvbi5hdHRyKCdkYXRhLXR5cGUnKSxcbiAgICAgICAgICAgICAgICAgICAgJGNvdW50ID0gJGJ1dHRvbi5maW5kKCcuamNrLXdvb3NvY2lhbC1saWtlLWJ1dHRvbl9fY291bnQnKSxcbiAgICAgICAgICAgICAgICAgICAgbG9hZGluZ19jbGFzcyA9ICdqY2std29vc29jaWFsLWZvbGxvdy1hY3Rpb24tLWxvYWRpbmcnO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggISRidXR0b24uaGFzQ2xhc3MobG9hZGluZ19jbGFzcykgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgJGJ1dHRvbi5hZGRDbGFzcyhsb2FkaW5nX2NsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgIFx0XHRcdFx0dHlwZTogXCJHRVRcIixcbiAgICAgICAgXHRcdFx0XHR1cmw6IGpja193b29zb2NpYWxfdmFycy5hamF4X3VybCxcbiAgICAgICAgXHRcdFx0XHRjYWNoZTogZmFsc2UsXG4gICAgICAgIFx0XHRcdFx0ZGF0YVR5cGU6IFwianNvbnBcIixcdFx0XHRcdFxuICAgICAgICBcdFx0XHRcdGNyb3NzRG9tYWluOiB0cnVlLFxuICAgICAgICBcdFx0XHRcdGRhdGE6IHtcbiAgICAgICAgXHRcdFx0XHRcdGFjdGlvbjogJ2pja193b29zb2NpYWxfbGlrZV9hY3Rpb24nLFxuICAgICAgICBcdFx0XHRcdFx0bm9uY2U6IGpja193b29zb2NpYWxfdmFycy5ub25jZSxcbiAgICAgICAgXHRcdFx0XHRcdHByb2R1Y3RfaWQ6IHByb2R1Y3RfaWQsXG4gICAgICAgIFx0XHRcdFx0XHR0eXBlOiB0eXBlXG4gICAgICAgIFx0XHRcdFx0fSxcbiAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICBcdFx0XHRcdFx0aWYoICRjb3VudC5sZW5ndGggPiAwICkge1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdHZhciBjb3VudCA9IHBhcnNlSW50KCRjb3VudC50ZXh0KCkpLFxuICAgICAgICAgICAgXHRcdFx0XHRcdCAgICBuZXdfY291bnQgPSB0eXBlID09PSBcImxpa2VcIiA/IGNvdW50KzEgOiBjb3VudC0xO1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdCRjb3VudC50ZXh0KCBuZXdfY291bnQgKTsgXG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5hdHRyKCdkYXRhLXR5cGUnLCBkYXRhLmJ1dHRvbi50eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLnJlbW92ZUNsYXNzKGxvYWRpbmdfY2xhc3MpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24ucmVtb3ZlQ2xhc3MoJ2pjay13b29zb2NpYWwtbGlrZS1hY3Rpb24tLScrdHlwZSk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5hZGRDbGFzcygnamNrLXdvb3NvY2lhbC1saWtlLWFjdGlvbi0tJytkYXRhLmJ1dHRvbi50eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHRpZihkYXRhLmFkZF9saWtlX2h0bWwpIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0JGN1cnJlbnRfbGlrZXNfbGlzdC5maW5kKCcuamNrLXdvb3NvY2lhbC1saWtlc19faXRlbS0tbGlrZS1idXR0b24nKS5hZnRlcihkYXRhLmFkZF9saWtlX2h0bWwpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdH1cbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHRpZihkYXRhLnJlbW92ZV9saWtlX2NsYXNzKSB7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdCRjdXJyZW50X2xpa2VzX2xpc3QuZmluZChkYXRhLnJlbW92ZV9saWtlX2NsYXNzKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHR9ICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgIFx0XHRcdFx0XHR9XG4gICAgICAgIFx0XHRcdFx0fSxcbiAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICBcdFx0XHRcdH1cbiAgICAgICAgXHRcdFx0fSk7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc2V0dXBfdGFiczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLnRhYl9saW5rcy5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKSxcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlX2NsYXNzID0gJ2pjay13b29zb2NpYWwtcHJvZmlsZS1saW5rLS1hY3RpdmUnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLnRhYl9saW5rcy5yZW1vdmVDbGFzcyhhY3RpdmVfY2xhc3MpO1xuICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoYWN0aXZlX2NsYXNzKTtcbiAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50YWJfY29udGVudC5oaWRlKCk7XG4gICAgICAgICAgICAgICAgJCh0YXJnZXQpLnNob3coKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBlcWpzLnJlZnJlc2hOb2RlcygpO1xuICAgICAgICAgICAgICAgIGVxanMucXVlcnkoKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc2V0dXBfbG9hZF9tb3JlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMubG9hZF9tb3JlX2J1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICQodGhpcykuaGFzQ2xhc3MoJ2pjay13b29zb2NpYWwtbG9hZC1tb3JlLS1hY3Rpdml0eScpICkge1xuICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmxvYWRfbW9yZV9hY3Rpdml0eSggJCh0aGlzKSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICQodGhpcykuaGFzQ2xhc3MoJ2pjay13b29zb2NpYWwtbG9hZC1tb3JlLS1saWtlcycpICkge1xuICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmxvYWRfbW9yZV9saWtlcyggJCh0aGlzKSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBsb2FkX21vcmVfYWN0aXZpdHk6IGZ1bmN0aW9uKCAkbG9hZF9tb3JlX2J1dHRvbiApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGxpbWl0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtbGltaXQnKSApLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHBhcnNlSW50KCAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLW9mZnNldCcpICksXG4gICAgICAgICAgICAgICAgbmV4dF9vZmZzZXQgPSBsaW1pdCtvZmZzZXQsXG4gICAgICAgICAgICAgICAgdXNlcl9pZCA9ICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtdXNlci1pZCcpLFxuICAgICAgICAgICAgICAgIHByb2ZpbGVfdXNlcl9pZCA9ICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtcHJvZmlsZS11c2VyLWlkJyksXG4gICAgICAgICAgICAgICAgJGxvYWRfbW9yZV9pdGVtID0gJGxvYWRfbW9yZV9idXR0b24ucGFyZW50KCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAkLmFqYXgoe1xuXHRcdFx0XHR0eXBlOiAgICAgICAgXCJHRVRcIixcblx0XHRcdFx0dXJsOiAgICAgICAgIGpja193b29zb2NpYWxfdmFycy5hamF4X3VybCxcblx0XHRcdFx0Y2FjaGU6ICAgICAgIGZhbHNlLFxuXHRcdFx0XHRkYXRhVHlwZTogICAgXCJqc29ucFwiLFx0XHRcdFx0XG5cdFx0XHRcdGNyb3NzRG9tYWluOiB0cnVlLFxuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uOiAgICAgICAgICAnamNrX3dvb3NvY2lhbF9sb2FkX21vcmVfYWN0aXZpdHknLFxuXHRcdFx0XHRcdG5vbmNlOiAgICAgICAgICAgamNrX3dvb3NvY2lhbF92YXJzLm5vbmNlLFxuXHRcdFx0XHRcdGxpbWl0OiAgICAgICAgICAgbGltaXQsXG5cdFx0XHRcdFx0b2Zmc2V0OiAgICAgICAgICBvZmZzZXQsXG5cdFx0XHRcdFx0dXNlcl9pZDogICAgICAgICB1c2VyX2lkLFxuXHRcdFx0XHRcdHByb2ZpbGVfdXNlcl9pZDogcHJvZmlsZV91c2VyX2lkXG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiggZGF0YS5hY3Rpdml0eV9odG1sICkge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0JGxvYWRfbW9yZV9pdGVtLmJlZm9yZSggZGF0YS5hY3Rpdml0eV9odG1sICk7XG4gICAgXHRcdFx0XHRcdCRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtb2Zmc2V0JywgbmV4dF9vZmZzZXQpIDtcbiAgICBcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fSBlbHNlIHtcbiAgICBcdFx0XHRcdFx0XG4gICAgXHRcdFx0XHRcdCRsb2FkX21vcmVfaXRlbS5yZW1vdmUoKTtcbiAgICBcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgIFx0XHRcdFx0XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBsb2FkX21vcmVfbGlrZXM6IGZ1bmN0aW9uKCAkbG9hZF9tb3JlX2J1dHRvbiApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGxpbWl0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtbGltaXQnKSApLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHBhcnNlSW50KCAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLW9mZnNldCcpICksXG4gICAgICAgICAgICAgICAgbmV4dF9vZmZzZXQgPSBsaW1pdCtvZmZzZXQsXG4gICAgICAgICAgICAgICAgdXNlcl9pZCA9ICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtdXNlci1pZCcpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgJC5hamF4KHtcblx0XHRcdFx0dHlwZTogICAgICAgIFwiR0VUXCIsXG5cdFx0XHRcdHVybDogICAgICAgICBqY2tfd29vc29jaWFsX3ZhcnMuYWpheF91cmwsXG5cdFx0XHRcdGNhY2hlOiAgICAgICBmYWxzZSxcblx0XHRcdFx0ZGF0YVR5cGU6ICAgIFwianNvbnBcIixcdFx0XHRcdFxuXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcblx0XHRcdFx0ZGF0YToge1xuXHRcdFx0XHRcdGFjdGlvbjogICdqY2tfd29vc29jaWFsX2xvYWRfbW9yZV9saWtlcycsXG5cdFx0XHRcdFx0bm9uY2U6ICAgamNrX3dvb3NvY2lhbF92YXJzLm5vbmNlLFxuXHRcdFx0XHRcdGxpbWl0OiAgIGxpbWl0LFxuXHRcdFx0XHRcdG9mZnNldDogIG9mZnNldCxcblx0XHRcdFx0XHR1c2VyX2lkOiB1c2VyX2lkXG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiggZGF0YS5saWtlc19odG1sICkge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0amNrX3dvb3NvY2lhbC5lbHMubGlrZXNfY29udGFpbmVyLmFwcGVuZCggZGF0YS5saWtlc19odG1sICk7XG4gICAgXHRcdFx0XHRcdCRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtb2Zmc2V0JywgbmV4dF9vZmZzZXQpIDtcbiAgICBcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fSBlbHNlIHtcbiAgICBcdFx0XHRcdFx0XG4gICAgXHRcdFx0XHRcdCRsb2FkX21vcmVfYnV0dG9uLnJlbW92ZSgpO1xuICAgIFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgXHRcdFx0XHRcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNldHVwX2FjdGl2aXR5X2xvZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuaGlkZV9hY3Rpb25zKGpja193b29zb2NpYWwuZWxzLmFjdGlvbl9ibG9ja3MsIGpja193b29zb2NpYWwudmFycy5hY3Rpb25fb2Zmc2V0KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgaGlkZV9hY3Rpb25zOiBmdW5jdGlvbigkYWN0aW9uX2Jsb2NrcywgYWN0aW9uX29mZnNldCkge1xuICAgIFx0XHRcbiAgICBcdFx0JGFjdGlvbl9ibG9ja3MuZWFjaChmdW5jdGlvbigpe1xuICAgIFx0XHRcdFxuICAgIFx0XHRcdGlmKCAkKHRoaXMpLm9mZnNldCgpLnRvcCA+ICQod2luZG93KS5zY3JvbGxUb3AoKSskKHdpbmRvdykuaGVpZ2h0KCkqYWN0aW9uX29mZnNldCApIHtcbiAgICAgICAgXHRcdFx0JCh0aGlzKS5maW5kKCcuamNrLXdvb3NvY2lhbC1hY3Rpb25fX2ljb24sIC5qY2std29vc29jaWFsLWFjdGlvbl9fd3JhcHBlcicpLmNzcyh7IG9wYWNpdHk6IDAgfSkuYWRkQ2xhc3MoamNrX3dvb3NvY2lhbC52YXJzLmlzX2hpZGRlbl9jbGFzcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgIFx0XHRcdFxuICAgIFx0XHR9KTtcbiAgICBcdFx0XG4gICAgXHR9LFxuICAgIFxuICAgIFx0c2hvd19hY3Rpb25zOiBmdW5jdGlvbigkYWN0aW9uX2Jsb2NrcywgYWN0aW9uX29mZnNldCkge1xuICAgIFx0XHRcbiAgICBcdFx0JGFjdGlvbl9ibG9ja3MuZWFjaChmdW5jdGlvbigpe1xuICAgIFx0XHRcdFxuICAgIFx0XHRcdGlmKCAkKHRoaXMpLm9mZnNldCgpLnRvcCA8PSAkKHdpbmRvdykuc2Nyb2xsVG9wKCkrJCh3aW5kb3cpLmhlaWdodCgpKmFjdGlvbl9vZmZzZXQgJiYgJCh0aGlzKS5maW5kKCcuamNrLXdvb3NvY2lhbC1hY3Rpb25fX2ljb24nKS5oYXNDbGFzcyhqY2tfd29vc29jaWFsLnZhcnMuaXNfaGlkZGVuX2NsYXNzKSApIHtcbiAgICAgICAgXHRcdFx0JCh0aGlzKS5maW5kKCcuamNrLXdvb3NvY2lhbC1hY3Rpb25fX2ljb24sIC5qY2std29vc29jaWFsLWFjdGlvbl9fd3JhcHBlcicpXG4gICAgICAgIFx0XHRcdCAgICAucmVtb3ZlQ2xhc3MoamNrX3dvb3NvY2lhbC52YXJzLmlzX2hpZGRlbl9jbGFzcylcbiAgICAgICAgXHRcdFx0ICAgIC5hbmltYXRlKHsgb3BhY2l0eTogMSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgXHRcdFx0XG4gICAgXHRcdH0pO1xuICAgIFx0XHRcbiAgICBcdH0sXG4gICAgXHRcbiAgICBcdHNjcm9sbF9hY3Rpdml0eV9sb2c6IGZ1bmN0aW9uKCkge1xuICAgICAgICBcdFxuICAgICAgICBcdGlmKCF3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKSB7XG4gICAgICAgICAgICBcdFxuXHRcdFx0ICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsgamNrX3dvb3NvY2lhbC5zaG93X2FjdGlvbnMoamNrX3dvb3NvY2lhbC5lbHMuYWN0aW9uX2Jsb2NrcywgamNrX3dvb3NvY2lhbC52YXJzLmFjdGlvbl9vZmZzZXQpOyB9LCAxMDApO1xuICAgICAgICAgICBcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpeyBqY2tfd29vc29jaWFsLnNob3dfYWN0aW9ucyhqY2tfd29vc29jaWFsLmVscy5hY3Rpb25fYmxvY2tzLCBqY2tfd29vc29jaWFsLnZhcnMuYWN0aW9uX29mZnNldCk7IH0pOyAgXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICBcdH0sXG4gICAgXHRcbiAgICBcdGFkZF90b19jYXJ0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgXHRcbiAgICAgICAgXHRqY2tfd29vc29jaWFsLmVscy5hZGRfdG9fY2FydF9idXR0b25zLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBcdFxuICAgICAgICAgICAgXHR2YXIgJGJ1dHRvbiA9ICQodGhpcyksXG4gICAgICAgICAgICBcdCAgICBidXR0b25fdGV4dCA9ICRidXR0b24udGV4dCgpO1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgICAgICAgICAgJGJ1dHRvblxuICAgICAgICAgICAgICAgIC5hdHRyKCdkYXRhLWJ1dHRvbi10ZXh0JyxidXR0b25fdGV4dClcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCBqY2tfd29vc29jaWFsLmVscy5sb2FkaW5nX2ljb24gKTtcbiAgICAgICAgICAgIFx0XG4gICAgICAgIFx0fSk7XG4gICAgICAgIFx0XG4gICAgICAgIFx0JCggZG9jdW1lbnQuYm9keSApLm9uKCAnYWRkZWRfdG9fY2FydCcsIGZ1bmN0aW9uKCBlLCBmcmFnbWVudHMsIGNhcnRfaGFzaCwgJGJ1dHRvbiApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciAkd29vc29jaWFsX2J1dHRvbl93cmFwcGVyID0gJGJ1dHRvbi5jbG9zZXN0KCcuamNrLXdvb3NvY2lhbC1hZGQtdG8tY2FydC13cmFwcGVyJyksXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbl90ZXh0ID0gJGJ1dHRvbi5hdHRyKCdkYXRhLWJ1dHRvbi10ZXh0Jyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICR3b29zb2NpYWxfYnV0dG9uX3dyYXBwZXIubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICRidXR0b25cbiAgICAgICAgICAgICAgICAgICAgLmh0bWwoIGJ1dHRvbl90ZXh0ICkgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoIGpja193b29zb2NpYWwuZWxzLnRpY2tfaWNvbiApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAkYnV0dG9uLmh0bWwoIGJ1dHRvbl90ZXh0ICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFx0XG4gICAgICAgIFx0fSk7XG4gICAgICAgIFx0XG4gICAgXHR9XG4gICAgIFxuICAgIH07XG4gICAgXG5cdCQoZG9jdW1lbnQpLnJlYWR5KCBqY2tfd29vc29jaWFsLm9uX3JlYWR5KCkgKTtcblx0XG5cdCQod2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oKXtcbiAgICBcdGpja193b29zb2NpYWwub25fc2Nyb2xsKCk7XG4gICAgfSk7XG5cbn0oalF1ZXJ5LCBkb2N1bWVudCkpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==