!function(o,a){var t={cache:function(){t.els={},t.vars={},t.els.$actions_list=o(".jck_woo_social-actions"),t.els.$tab_links=o(".jck_woo_social-tab-link"),t.els.$tab_content=o(".jck_woo_social-tab-content"),t.els.$load_more_button=o(".jck_woo_social-load-more"),t.els.$action_blocks=o(".jck_woo_social-action"),t.vars.action_offset=1,t.vars.is_hidden_class="jck_woo_social--is-hidden"},on_ready:function(){t.cache(),t.setup_follow_actions(),t.setup_like_action(),t.setup_tabs(),t.setup_load_more(),t.setup_activity_log()},on_scroll:function(){t.scroll_activity_log()},setup_follow_actions:function(){o(".jck_woo_social-follow-action").on("click",function(){var a=o(this),s=a.attr("data-user-id"),i=a.attr("data-type"),c="jck_woo_social-follow-action--loading";"login"===i||a.hasClass(c)||(a.addClass(c),o.ajax({type:"GET",url:jck_woo_social_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woo_social_follow_action",nonce:jck_woo_social_vars.nonce,user_id:s,type:i},success:function(s){a.text(s.button.text),a.attr("data-type",s.button.type),a.removeClass(c),a.removeClass("jck_woo_social-follow-action--"+i),a.addClass("jck_woo_social-follow-action--"+s.button.type),s.add_follow_html&&t.els.$actions_list.prepend(s.add_follow_html),s.remove_follow_class&&o(s.remove_follow_class).remove()},error:function(o){}}))})},setup_like_action:function(){o(a).on("click",".jck-woo-social-like-action",function(){var a=o(this),t=a.closest(".jck-woo-social-likes"),s=a.attr("data-product-id"),i=a.attr("data-type"),c=a.find(".jck-woo-social-like-button__count"),e="jck_woo_social-follow-action--loading";return a.hasClass(e)||(a.addClass(e),o.ajax({type:"GET",url:jck_woo_social_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woo_social_like_action",nonce:jck_woo_social_vars.nonce,product_id:s,type:i},success:function(o){if(c.length>0){var s=parseInt(c.text()),n="like"===i?s+1:s-1;c.text(n),a.attr("data-type",o.button.type),a.removeClass(e),a.removeClass("jck_woo_social-like-action--"+i),a.addClass("jck_woo_social-like-action--"+o.button.type),o.add_like_html&&t.find(".jck-woo-social-likes__item--like-button").after(o.add_like_html),o.remove_like_class&&t.find(o.remove_like_class).remove()}},error:function(o){}})),!1})},setup_tabs:function(){t.els.$tab_links.on("click",function(){var a=o(this).attr("href"),s="jck_woo_social-tab-link--active";return t.els.$tab_links.removeClass(s),o(this).addClass(s),t.els.$tab_content.hide(),o(a).show(),!1})},setup_load_more:function(){t.els.$load_more_button.on("click",function(){o(this).hasClass("jck_woo_social-load-more--activity")&&t.load_more_activity(o(this)),o(this).hasClass("jck_woo_social-load-more--likes")&&t.load_more_likes(o(this))})},load_more_activity:function(a){var t=parseInt(a.attr("data-limit")),s=parseInt(a.attr("data-offset")),i=t+s,c=a.attr("data-user-id"),e=a.attr("data-profile-user-id"),n=a.parent();o.ajax({type:"GET",url:jck_woo_social_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woo_social_load_more_activity",nonce:jck_woo_social_vars.nonce,limit:t,offset:s,user_id:c,profile_user_id:e},success:function(o){o.activity_html?(n.before(o.activity_html),a.attr("data-offset",i)):n.remove()},error:function(o){}})},load_more_likes:function(a){var t=parseInt(a.attr("data-limit")),s=parseInt(a.attr("data-offset")),i=a.attr("data-user-id");o.ajax({type:"GET",url:jck_woo_social_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woo_social_load_more_likes",nonce:jck_woo_social_vars.nonce,limit:t,offset:s,user_id:i},success:function(a){a.likes_html&&o(".products").append(a.likes_html)},error:function(o){}})},setup_activity_log:function(){t.hide_actions(t.els.$action_blocks,t.vars.action_offset)},hide_actions:function(a,s){a.each(function(){o(this).offset().top>o(window).scrollTop()+o(window).height()*s&&o(this).find(".jck_woo_social-action__icon, .jck_woo_social-action__wrapper").css({opacity:0}).addClass(t.vars.is_hidden_class)})},show_actions:function(a,s){a.each(function(){o(this).offset().top<=o(window).scrollTop()+o(window).height()*s&&o(this).find(".jck_woo_social-action__icon").hasClass(t.vars.is_hidden_class)&&o(this).find(".jck_woo_social-action__icon, .jck_woo_social-action__wrapper").removeClass(t.vars.is_hidden_class).animate({opacity:1})})},scroll_activity_log:function(){window.requestAnimationFrame?window.requestAnimationFrame(function(){t.show_actions(t.els.$action_blocks,t.vars.action_offset)}):setTimeout(function(){t.show_actions(t.els.$action_blocks,t.vars.action_offset)},100)}};o(a).ready(t.on_ready()),o(window).on("scroll",function(){t.on_scroll()})}(jQuery,document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwiamNrX3dvb19zb2NpYWwiLCJjYWNoZSIsImVscyIsInZhcnMiLCIkYWN0aW9uc19saXN0IiwiJHRhYl9saW5rcyIsIiR0YWJfY29udGVudCIsIiRsb2FkX21vcmVfYnV0dG9uIiwiJGFjdGlvbl9ibG9ja3MiLCJhY3Rpb25fb2Zmc2V0IiwiaXNfaGlkZGVuX2NsYXNzIiwib25fcmVhZHkiLCJzZXR1cF9mb2xsb3dfYWN0aW9ucyIsInNldHVwX2xpa2VfYWN0aW9uIiwic2V0dXBfdGFicyIsInNldHVwX2xvYWRfbW9yZSIsInNldHVwX2FjdGl2aXR5X2xvZyIsIm9uX3Njcm9sbCIsInNjcm9sbF9hY3Rpdml0eV9sb2ciLCJvbiIsIiRidXR0b24iLCJ0aGlzIiwidXNlcl9pZCIsImF0dHIiLCJ0eXBlIiwibG9hZGluZ19jbGFzcyIsImhhc0NsYXNzIiwiYWRkQ2xhc3MiLCJhamF4IiwidXJsIiwiamNrX3dvb19zb2NpYWxfdmFycyIsImFqYXhfdXJsIiwiZGF0YVR5cGUiLCJjcm9zc0RvbWFpbiIsImRhdGEiLCJhY3Rpb24iLCJub25jZSIsInN1Y2Nlc3MiLCJ0ZXh0IiwiYnV0dG9uIiwicmVtb3ZlQ2xhc3MiLCJhZGRfZm9sbG93X2h0bWwiLCJwcmVwZW5kIiwicmVtb3ZlX2ZvbGxvd19jbGFzcyIsInJlbW92ZSIsImVycm9yIiwiJGN1cnJlbnRfbGlrZXNfbGlzdCIsImNsb3Nlc3QiLCJwcm9kdWN0X2lkIiwiJGNvdW50IiwiZmluZCIsImxlbmd0aCIsImNvdW50IiwicGFyc2VJbnQiLCJuZXdfY291bnQiLCJhZGRfbGlrZV9odG1sIiwiYWZ0ZXIiLCJyZW1vdmVfbGlrZV9jbGFzcyIsInRhcmdldCIsImFjdGl2ZV9jbGFzcyIsImhpZGUiLCJzaG93IiwibG9hZF9tb3JlX2FjdGl2aXR5IiwibG9hZF9tb3JlX2xpa2VzIiwibGltaXQiLCJvZmZzZXQiLCJuZXh0X29mZnNldCIsInByb2ZpbGVfdXNlcl9pZCIsIiRsb2FkX21vcmVfaXRlbSIsInBhcmVudCIsImFjdGl2aXR5X2h0bWwiLCJiZWZvcmUiLCJsaWtlc19odG1sIiwiYXBwZW5kIiwiaGlkZV9hY3Rpb25zIiwiZWFjaCIsInRvcCIsIndpbmRvdyIsInNjcm9sbFRvcCIsImhlaWdodCIsImNzcyIsIm9wYWNpdHkiLCJzaG93X2FjdGlvbnMiLCJhbmltYXRlIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwic2V0VGltZW91dCIsInJlYWR5IiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUVBLEdBQUFDLElBRUFDLE1BQUEsV0FDQUQsRUFBQUUsT0FDQUYsRUFBQUcsUUFFQUgsRUFBQUUsSUFBQUUsY0FBQU4sRUFBQSwyQkFDQUUsRUFBQUUsSUFBQUcsV0FBQVAsRUFBQSw0QkFDQUUsRUFBQUUsSUFBQUksYUFBQVIsRUFBQSwrQkFDQUUsRUFBQUUsSUFBQUssa0JBQUFULEVBQUEsNkJBQ0FFLEVBQUFFLElBQUFNLGVBQUFWLEVBQUEsMEJBRUFFLEVBQUFHLEtBQUFNLGNBQUEsRUFDQVQsRUFBQUcsS0FBQU8sZ0JBQUEsNkJBSUFDLFNBQUEsV0FFQVgsRUFBQUMsUUFDQUQsRUFBQVksdUJBQ0FaLEVBQUFhLG9CQUNBYixFQUFBYyxhQUNBZCxFQUFBZSxrQkFDQWYsRUFBQWdCLHNCQUlBQyxVQUFBLFdBRUFqQixFQUFBa0IsdUJBSUFOLHFCQUFBLFdBRUFkLEVBQUEsaUNBQUFxQixHQUFBLFFBQUEsV0FFQSxHQUFBQyxHQUFBdEIsRUFBQXVCLE1BQ0FDLEVBQUFGLEVBQUFHLEtBQUEsZ0JBQ0FDLEVBQUFKLEVBQUFHLEtBQUEsYUFDQUUsRUFBQSx1Q0FFQSxXQUFBRCxHQUlBSixFQUFBTSxTQUFBRCxLQUVBTCxFQUFBTyxTQUFBRixHQUVBM0IsRUFBQThCLE1BQ0FKLEtBQUEsTUFDQUssSUFBQUMsb0JBQUFDLFNBQ0E5QixPQUFBLEVBQ0ErQixTQUFBLFFBQ0FDLGFBQUEsRUFDQUMsTUFDQUMsT0FBQSwrQkFDQUMs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RUFBQUcsS0FBQU8saUJBQ0F5RSxTQUFBRixRQUFBLE9BT0EvRCxvQkFBQSxXQUVBMkQsT0FBQU8sc0JBTUFQLE9BQUFPLHNCQUFBLFdBQUFwRixFQUFBa0YsYUFBQWxGLEVBQUFFLElBQUFNLGVBQUFSLEVBQUFHLEtBQUFNLGlCQUpBNEUsV0FBQSxXQUFBckYsRUFBQWtGLGFBQUFsRixFQUFBRSxJQUFBTSxlQUFBUixFQUFBRyxLQUFBTSxnQkFBQSxNQVlBWCxHQUFBQyxHQUFBdUYsTUFBQXRGLEVBQUFXLFlBRUFiLEVBQUErRSxRQUFBMUQsR0FBQSxTQUFBLFdBQ0FuQixFQUFBaUIsZUFHQXNFLE9BQUF4RiIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigkLCBkb2N1bWVudCkge1xuICAgIFxuICAgIHZhciBqY2tfd29vX3NvY2lhbCA9IHtcbiAgICAgICAgXG4gICAgICAgIGNhY2hlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGpja193b29fc29jaWFsLmVscyA9IHt9O1xuICAgICAgICAgICAgamNrX3dvb19zb2NpYWwudmFycyA9IHt9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vX3NvY2lhbC5lbHMuJGFjdGlvbnNfbGlzdCA9ICQoJy5qY2tfd29vX3NvY2lhbC1hY3Rpb25zJyk7XG4gICAgICAgICAgICBqY2tfd29vX3NvY2lhbC5lbHMuJHRhYl9saW5rcyA9ICQoJy5qY2tfd29vX3NvY2lhbC10YWItbGluaycpO1xuICAgICAgICAgICAgamNrX3dvb19zb2NpYWwuZWxzLiR0YWJfY29udGVudCA9ICQoJy5qY2tfd29vX3NvY2lhbC10YWItY29udGVudCcpO1xuICAgICAgICAgICAgamNrX3dvb19zb2NpYWwuZWxzLiRsb2FkX21vcmVfYnV0dG9uID0gJCgnLmpja193b29fc29jaWFsLWxvYWQtbW9yZScpO1xuICAgICAgICAgICAgamNrX3dvb19zb2NpYWwuZWxzLiRhY3Rpb25fYmxvY2tzID0gJCgnLmpja193b29fc29jaWFsLWFjdGlvbicpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vX3NvY2lhbC52YXJzLmFjdGlvbl9vZmZzZXQgPSAxO1xuICAgICAgICAgICAgamNrX3dvb19zb2NpYWwudmFycy5pc19oaWRkZW5fY2xhc3MgPSBcImpja193b29fc29jaWFsLS1pcy1oaWRkZW5cIjtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuIFxuICAgICAgICBvbl9yZWFkeTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29fc29jaWFsLmNhY2hlKCk7XG4gICAgICAgICAgICBqY2tfd29vX3NvY2lhbC5zZXR1cF9mb2xsb3dfYWN0aW9ucygpO1xuICAgICAgICAgICAgamNrX3dvb19zb2NpYWwuc2V0dXBfbGlrZV9hY3Rpb24oKTtcbiAgICAgICAgICAgIGpja193b29fc29jaWFsLnNldHVwX3RhYnMoKTtcbiAgICAgICAgICAgIGpja193b29fc29jaWFsLnNldHVwX2xvYWRfbW9yZSgpO1xuICAgICAgICAgICAgamNrX3dvb19zb2NpYWwuc2V0dXBfYWN0aXZpdHlfbG9nKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIG9uX3Njcm9sbDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29fc29jaWFsLnNjcm9sbF9hY3Rpdml0eV9sb2coKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICBcbiAgICAgICAgc2V0dXBfZm9sbG93X2FjdGlvbnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkKCcuamNrX3dvb19zb2NpYWwtZm9sbG93LWFjdGlvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyICRidXR0b24gPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICB1c2VyX2lkID0gJGJ1dHRvbi5hdHRyKCdkYXRhLXVzZXItaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICRidXR0b24uYXR0cignZGF0YS10eXBlJyksXG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmdfY2xhc3MgPSAnamNrX3dvb19zb2NpYWwtZm9sbG93LWFjdGlvbi0tbG9hZGluZyc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoIHR5cGUgPT09IFwibG9naW5cIiApIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoICEkYnV0dG9uLmhhc0NsYXNzKGxvYWRpbmdfY2xhc3MpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAkYnV0dG9uLmFkZENsYXNzKGxvYWRpbmdfY2xhc3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICBcdFx0XHRcdHR5cGU6IFwiR0VUXCIsXG4gICAgICAgICAgICBcdFx0XHRcdHVybDogamNrX3dvb19zb2NpYWxfdmFycy5hamF4X3VybCxcbiAgICAgICAgICAgIFx0XHRcdFx0Y2FjaGU6IGZhbHNlLFxuICAgICAgICAgICAgXHRcdFx0XHRkYXRhVHlwZTogXCJqc29ucFwiLFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdGNyb3NzRG9tYWluOiB0cnVlLFxuICAgICAgICAgICAgXHRcdFx0XHRkYXRhOiB7XG4gICAgICAgICAgICBcdFx0XHRcdFx0YWN0aW9uIDogJ2pja193b29fc29jaWFsX2ZvbGxvd19hY3Rpb24nLFxuICAgICAgICAgICAgXHRcdFx0XHRcdG5vbmNlIDogamNrX3dvb19zb2NpYWxfdmFycy5ub25jZSxcbiAgICAgICAgICAgIFx0XHRcdFx0XHR1c2VyX2lkIDogdXNlcl9pZCxcbiAgICAgICAgICAgIFx0XHRcdFx0XHR0eXBlIDogdHlwZVxuICAgICAgICAgICAgXHRcdFx0XHR9LFxuICAgICAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi50ZXh0KGRhdGEuYnV0dG9uLnRleHQpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24uYXR0cignZGF0YS10eXBlJyxkYXRhLmJ1dHRvbi50eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLnJlbW92ZUNsYXNzKGxvYWRpbmdfY2xhc3MpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24ucmVtb3ZlQ2xhc3MoJ2pja193b29fc29jaWFsLWZvbGxvdy1hY3Rpb24tLScrdHlwZSk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5hZGRDbGFzcygnamNrX3dvb19zb2NpYWwtZm9sbG93LWFjdGlvbi0tJytkYXRhLmJ1dHRvbi50eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHRpZihkYXRhLmFkZF9mb2xsb3dfaHRtbCkge1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHRqY2tfd29vX3NvY2lhbC5lbHMuJGFjdGlvbnNfbGlzdC5wcmVwZW5kKGRhdGEuYWRkX2ZvbGxvd19odG1sKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHR9XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0aWYoZGF0YS5yZW1vdmVfZm9sbG93X2NsYXNzKSB7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdCQoZGF0YS5yZW1vdmVfZm9sbG93X2NsYXNzKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHR9XG4gICAgICAgICAgICBcdFx0XHRcdH0sXG4gICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0fVxuICAgICAgICAgICAgXHRcdFx0fSk7XG4gICAgICAgIFx0XHRcdFxuICAgICAgICBcdFx0XHR9XG4gICAgXHRcdFx0XG4gICAgXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc2V0dXBfbGlrZV9hY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmpjay13b28tc29jaWFsLWxpa2UtYWN0aW9uJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgJGJ1dHRvbiA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICRjdXJyZW50X2xpa2VzX2xpc3QgPSAkYnV0dG9uLmNsb3Nlc3QoJy5qY2std29vLXNvY2lhbC1saWtlcycpLFxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X2lkID0gJGJ1dHRvbi5hdHRyKCdkYXRhLXByb2R1Y3QtaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICRidXR0b24uYXR0cignZGF0YS10eXBlJyksXG4gICAgICAgICAgICAgICAgICAgICRjb3VudCA9ICRidXR0b24uZmluZCgnLmpjay13b28tc29jaWFsLWxpa2UtYnV0dG9uX19jb3VudCcpLFxuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nX2NsYXNzID0gJ2pja193b29fc29jaWFsLWZvbGxvdy1hY3Rpb24tLWxvYWRpbmcnO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggISRidXR0b24uaGFzQ2xhc3MobG9hZGluZ19jbGFzcykgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgJGJ1dHRvbi5hZGRDbGFzcyhsb2FkaW5nX2NsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgIFx0XHRcdFx0dHlwZTogXCJHRVRcIixcbiAgICAgICAgXHRcdFx0XHR1cmw6IGpja193b29fc29jaWFsX3ZhcnMuYWpheF91cmwsXG4gICAgICAgIFx0XHRcdFx0Y2FjaGU6IGZhbHNlLFxuICAgICAgICBcdFx0XHRcdGRhdGFUeXBlOiBcImpzb25wXCIsXHRcdFx0XHRcbiAgICAgICAgXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcbiAgICAgICAgXHRcdFx0XHRkYXRhOiB7XG4gICAgICAgIFx0XHRcdFx0XHRhY3Rpb24gOiAnamNrX3dvb19zb2NpYWxfbGlrZV9hY3Rpb24nLFxuICAgICAgICBcdFx0XHRcdFx0bm9uY2UgOiBqY2tfd29vX3NvY2lhbF92YXJzLm5vbmNlLFxuICAgICAgICBcdFx0XHRcdFx0cHJvZHVjdF9pZCA6IHByb2R1Y3RfaWQsXG4gICAgICAgIFx0XHRcdFx0XHR0eXBlIDogdHlwZVxuICAgICAgICBcdFx0XHRcdH0sXG4gICAgICAgIFx0XHRcdFx0XG4gICAgICAgIFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgXHRcdFx0XHRcdGlmKCAkY291bnQubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHR2YXIgY291bnQgPSBwYXJzZUludCgkY291bnQudGV4dCgpKSxcbiAgICAgICAgICAgIFx0XHRcdFx0XHQgICAgbmV3X2NvdW50ID0gdHlwZSA9PT0gXCJsaWtlXCIgPyBjb3VudCsxIDogY291bnQtMTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkY291bnQudGV4dCggbmV3X2NvdW50ICk7IFxuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24uYXR0cignZGF0YS10eXBlJywgZGF0YS5idXR0b24udHlwZSk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5yZW1vdmVDbGFzcyhsb2FkaW5nX2NsYXNzKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLnJlbW92ZUNsYXNzKCdqY2tfd29vX3NvY2lhbC1saWtlLWFjdGlvbi0tJyt0eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLmFkZENsYXNzKCdqY2tfd29vX3NvY2lhbC1saWtlLWFjdGlvbi0tJytkYXRhLmJ1dHRvbi50eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHRpZihkYXRhLmFkZF9saWtlX2h0bWwpIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0JGN1cnJlbnRfbGlrZXNfbGlzdC5maW5kKCcuamNrLXdvby1zb2NpYWwtbGlrZXNfX2l0ZW0tLWxpa2UtYnV0dG9uJykuYWZ0ZXIoZGF0YS5hZGRfbGlrZV9odG1sKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHR9XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0aWYoZGF0YS5yZW1vdmVfbGlrZV9jbGFzcykge1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkY3VycmVudF9saWtlc19saXN0LmZpbmQoZGF0YS5yZW1vdmVfbGlrZV9jbGFzcykucmVtb3ZlKCk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0fSAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICBcdFx0XHRcdFx0fVxuICAgICAgICBcdFx0XHRcdH0sXG4gICAgICAgIFx0XHRcdFx0XG4gICAgICAgIFx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgXHRcdFx0XHR9XG4gICAgICAgIFx0XHRcdH0pO1xuICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNldHVwX3RhYnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vX3NvY2lhbC5lbHMuJHRhYl9saW5rcy5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKSxcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlX2NsYXNzID0gJ2pja193b29fc29jaWFsLXRhYi1saW5rLS1hY3RpdmUnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGpja193b29fc29jaWFsLmVscy4kdGFiX2xpbmtzLnJlbW92ZUNsYXNzKGFjdGl2ZV9jbGFzcyk7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhhY3RpdmVfY2xhc3MpO1xuICAgICAgICAgICAgICAgIGpja193b29fc29jaWFsLmVscy4kdGFiX2NvbnRlbnQuaGlkZSgpO1xuICAgICAgICAgICAgICAgICQodGFyZ2V0KS5zaG93KCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNldHVwX2xvYWRfbW9yZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29fc29jaWFsLmVscy4kbG9hZF9tb3JlX2J1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICQodGhpcykuaGFzQ2xhc3MoJ2pja193b29fc29jaWFsLWxvYWQtbW9yZS0tYWN0aXZpdHknKSApIHtcbiAgICAgICAgICAgICAgICAgICAgamNrX3dvb19zb2NpYWwubG9hZF9tb3JlX2FjdGl2aXR5KCAkKHRoaXMpICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggJCh0aGlzKS5oYXNDbGFzcygnamNrX3dvb19zb2NpYWwtbG9hZC1tb3JlLS1saWtlcycpICkge1xuICAgICAgICAgICAgICAgICAgICBqY2tfd29vX3NvY2lhbC5sb2FkX21vcmVfbGlrZXMoICQodGhpcykgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgbG9hZF9tb3JlX2FjdGl2aXR5OiBmdW5jdGlvbiggJGxvYWRfbW9yZV9idXR0b24gKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBsaW1pdCA9IHBhcnNlSW50KCAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLWxpbWl0JykgKSxcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBwYXJzZUludCggJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1vZmZzZXQnKSApLFxuICAgICAgICAgICAgICAgIG5leHRfb2Zmc2V0ID0gbGltaXQrb2Zmc2V0LFxuICAgICAgICAgICAgICAgIHVzZXJfaWQgPSAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLXVzZXItaWQnKSxcbiAgICAgICAgICAgICAgICBwcm9maWxlX3VzZXJfaWQgPSAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLXByb2ZpbGUtdXNlci1pZCcpLFxuICAgICAgICAgICAgICAgICRsb2FkX21vcmVfaXRlbSA9ICRsb2FkX21vcmVfYnV0dG9uLnBhcmVudCgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgJC5hamF4KHtcblx0XHRcdFx0dHlwZTogXCJHRVRcIixcblx0XHRcdFx0dXJsOiBqY2tfd29vX3NvY2lhbF92YXJzLmFqYXhfdXJsLFxuXHRcdFx0XHRjYWNoZTogZmFsc2UsXG5cdFx0XHRcdGRhdGFUeXBlOiBcImpzb25wXCIsXHRcdFx0XHRcblx0XHRcdFx0Y3Jvc3NEb21haW46IHRydWUsXG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRhY3Rpb24gOiAnamNrX3dvb19zb2NpYWxfbG9hZF9tb3JlX2FjdGl2aXR5Jyxcblx0XHRcdFx0XHRub25jZSA6IGpja193b29fc29jaWFsX3ZhcnMubm9uY2UsXG5cdFx0XHRcdFx0bGltaXQgOiBsaW1pdCxcblx0XHRcdFx0XHRvZmZzZXQgOiBvZmZzZXQsXG5cdFx0XHRcdFx0dXNlcl9pZCA6IHVzZXJfaWQsXG5cdFx0XHRcdFx0cHJvZmlsZV91c2VyX2lkIDogcHJvZmlsZV91c2VyX2lkXG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiggZGF0YS5hY3Rpdml0eV9odG1sICkge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0JGxvYWRfbW9yZV9pdGVtLmJlZm9yZSggZGF0YS5hY3Rpdml0eV9odG1sICk7XG4gICAgXHRcdFx0XHRcdCRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtb2Zmc2V0JywgbmV4dF9vZmZzZXQpIDtcbiAgICBcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fSBlbHNlIHtcbiAgICBcdFx0XHRcdFx0XG4gICAgXHRcdFx0XHRcdCRsb2FkX21vcmVfaXRlbS5yZW1vdmUoKTtcbiAgICBcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgIFx0XHRcdFx0XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBsb2FkX21vcmVfbGlrZXM6IGZ1bmN0aW9uKCAkbG9hZF9tb3JlX2J1dHRvbiApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGxpbWl0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtbGltaXQnKSApLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHBhcnNlSW50KCAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLW9mZnNldCcpICksXG4gICAgICAgICAgICAgICAgbmV4dF9vZmZzZXQgPSBsaW1pdCtvZmZzZXQsXG4gICAgICAgICAgICAgICAgdXNlcl9pZCA9ICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtdXNlci1pZCcpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgJC5hamF4KHtcblx0XHRcdFx0dHlwZTogXCJHRVRcIixcblx0XHRcdFx0dXJsOiBqY2tfd29vX3NvY2lhbF92YXJzLmFqYXhfdXJsLFxuXHRcdFx0XHRjYWNoZTogZmFsc2UsXG5cdFx0XHRcdGRhdGFUeXBlOiBcImpzb25wXCIsXHRcdFx0XHRcblx0XHRcdFx0Y3Jvc3NEb21haW46IHRydWUsXG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRhY3Rpb24gOiAnamNrX3dvb19zb2NpYWxfbG9hZF9tb3JlX2xpa2VzJyxcblx0XHRcdFx0XHRub25jZSA6IGpja193b29fc29jaWFsX3ZhcnMubm9uY2UsXG5cdFx0XHRcdFx0bGltaXQgOiBsaW1pdCxcblx0XHRcdFx0XHRvZmZzZXQgOiBvZmZzZXQsXG5cdFx0XHRcdFx0dXNlcl9pZCA6IHVzZXJfaWRcblx0XHRcdFx0fSxcblx0XHRcdFx0XG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCBkYXRhICkge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKCBkYXRhLmxpa2VzX2h0bWwgKSB7XG4gICAgXHRcdFx0XHRcdFxuICAgIFx0XHRcdFx0XHQkKCcucHJvZHVjdHMnKS5hcHBlbmQoIGRhdGEubGlrZXNfaHRtbCApO1xuICAgIFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgXHRcdFx0XHRcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNldHVwX2FjdGl2aXR5X2xvZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29fc29jaWFsLmhpZGVfYWN0aW9ucyhqY2tfd29vX3NvY2lhbC5lbHMuJGFjdGlvbl9ibG9ja3MsIGpja193b29fc29jaWFsLnZhcnMuYWN0aW9uX29mZnNldCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGhpZGVfYWN0aW9uczogZnVuY3Rpb24oJGFjdGlvbl9ibG9ja3MsIGFjdGlvbl9vZmZzZXQpIHtcbiAgICBcdFx0XG4gICAgXHRcdCRhY3Rpb25fYmxvY2tzLmVhY2goZnVuY3Rpb24oKXtcbiAgICBcdFx0XHRcbiAgICBcdFx0XHRpZiggJCh0aGlzKS5vZmZzZXQoKS50b3AgPiAkKHdpbmRvdykuc2Nyb2xsVG9wKCkrJCh3aW5kb3cpLmhlaWdodCgpKmFjdGlvbl9vZmZzZXQgKSB7XG4gICAgICAgIFx0XHRcdCQodGhpcykuZmluZCgnLmpja193b29fc29jaWFsLWFjdGlvbl9faWNvbiwgLmpja193b29fc29jaWFsLWFjdGlvbl9fd3JhcHBlcicpLmNzcyh7IG9wYWNpdHk6IDAgfSkuYWRkQ2xhc3MoamNrX3dvb19zb2NpYWwudmFycy5pc19oaWRkZW5fY2xhc3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICBcdFx0XHRcbiAgICBcdFx0fSk7XG4gICAgXHRcdFxuICAgIFx0fSxcbiAgICBcbiAgICBcdHNob3dfYWN0aW9uczogZnVuY3Rpb24oJGFjdGlvbl9ibG9ja3MsIGFjdGlvbl9vZmZzZXQpIHtcbiAgICBcdFx0XG4gICAgXHRcdCRhY3Rpb25fYmxvY2tzLmVhY2goZnVuY3Rpb24oKXtcbiAgICBcdFx0XHRcbiAgICBcdFx0XHRpZiggJCh0aGlzKS5vZmZzZXQoKS50b3AgPD0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpKyQod2luZG93KS5oZWlnaHQoKSphY3Rpb25fb2Zmc2V0ICYmICQodGhpcykuZmluZCgnLmpja193b29fc29jaWFsLWFjdGlvbl9faWNvbicpLmhhc0NsYXNzKGpja193b29fc29jaWFsLnZhcnMuaXNfaGlkZGVuX2NsYXNzKSApIHtcbiAgICAgICAgXHRcdFx0JCh0aGlzKS5maW5kKCcuamNrX3dvb19zb2NpYWwtYWN0aW9uX19pY29uLCAuamNrX3dvb19zb2NpYWwtYWN0aW9uX193cmFwcGVyJylcbiAgICAgICAgXHRcdFx0ICAgIC5yZW1vdmVDbGFzcyhqY2tfd29vX3NvY2lhbC52YXJzLmlzX2hpZGRlbl9jbGFzcylcbiAgICAgICAgXHRcdFx0ICAgIC5hbmltYXRlKHsgb3BhY2l0eTogMSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgXHRcdFx0XG4gICAgXHRcdH0pO1xuICAgIFx0XHRcbiAgICBcdH0sXG4gICAgXHRcbiAgICBcdHNjcm9sbF9hY3Rpdml0eV9sb2c6IGZ1bmN0aW9uKCkge1xuICAgICAgICBcdFxuICAgICAgICBcdGlmKCF3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKSB7XG4gICAgICAgICAgICBcdFxuXHRcdFx0ICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsgamNrX3dvb19zb2NpYWwuc2hvd19hY3Rpb25zKGpja193b29fc29jaWFsLmVscy4kYWN0aW9uX2Jsb2NrcywgamNrX3dvb19zb2NpYWwudmFycy5hY3Rpb25fb2Zmc2V0KTsgfSwgMTAwKTtcbiAgICAgICAgICAgXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXsgamNrX3dvb19zb2NpYWwuc2hvd19hY3Rpb25zKGpja193b29fc29jaWFsLmVscy4kYWN0aW9uX2Jsb2NrcywgamNrX3dvb19zb2NpYWwudmFycy5hY3Rpb25fb2Zmc2V0KTsgfSk7ICBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgIFx0fVxuICAgICBcbiAgICB9O1xuICAgIFxuXHQkKGRvY3VtZW50KS5yZWFkeSggamNrX3dvb19zb2NpYWwub25fcmVhZHkoKSApO1xuXHRcblx0JCh3aW5kb3cpLm9uKCdzY3JvbGwnLCBmdW5jdGlvbigpe1xuICAgIFx0amNrX3dvb19zb2NpYWwub25fc2Nyb2xsKCk7XG4gICAgfSk7XG5cbn0oalF1ZXJ5LCBkb2N1bWVudCkpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==