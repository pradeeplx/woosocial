!function(o,a){var t={cache:function(){t.els={},t.vars={},t.vars.is_hidden_class="jck-woosocial--is-hidden",t.vars.animate_spin_class="jck-woosocial-spin",t.vars.add_to_cart_buttons_class=".jck-woosocial-add-to-cart-wrapper .add_to_cart_button",t.vars.card_grid_cards_class=".jck-woosocial-card-grid .jck-woosocial-card",t.vars.card_hover_class="jck-woosocial-card--hover",t.els.document_body=o(a.body),t.els.actions_list=o(".jck-woosocial-actions"),t.els.tab_links=o(".jck-woosocial-profile-link"),t.els.tab_content=o(".jck-woosocial-tab-content"),t.els.load_more_button=o(".jck-woosocial-load-more"),t.els.action_blocks=o(".jck-woosocial-action"),t.els.likes_container=o(".jck-woosocial-user-likes"),t.els.add_to_cart_buttons=o(".jck-woosocial-add-to-cart-wrapper .add_to_cart_button"),t.els.tick_icon=o('<i class="jck-woosocial-ic-tick"></i>'),t.els.loading_icon=o('<i class="jck-woosocial-ic-loading jck-woosocial-spin"></i>'),t.els.card_grids=o(".jck-woosocial-card-grid"),t.els.breakpoint_elements=o("[data-breakpoints]"),t.els.breakpoints=[]},on_ready:function(){t.cache(),t.setup_follow_actions(),t.setup_like_action(),t.setup_tabs(),t.setup_load_more(),t.add_to_cart(),t.setup_breakpoints(),t.check_breakpoints(),t.setup_cards()},on_scroll:function(){},on_resize:function(){t.check_breakpoints()},setup_follow_actions:function(){o(".jck-woosocial-follow-action").on("click",function(){var a=o(this),s=a.attr("data-user-id"),e=a.attr("data-type"),i="jck-woosocial-follow-action--loading";"login"===e||a.hasClass(i)||(a.addClass(i),o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_follow_action",nonce:jck_woosocial_vars.nonce,user_id:s,type:e},success:function(s){a.text(s.button.text),a.attr("data-type",s.button.type),a.removeClass(i),a.removeClass("jck-woosocial-follow-action--"+e),a.addClass("jck-woosocial-follow-action--"+s.button.type),s.add_follow_html&&t.els.actions_list.prepend(s.add_follow_html),s.remove_follow_class&&o(s.remove_follow_class).remove()},error:function(o){}}))})},setup_like_action:function(){o(a).on("click",".jck-woosocial-like-action",function(){var a=o(this),t=a.closest(".jck-woosocial-likes"),s=a.attr("data-product-id"),e=a.attr("data-type"),i=a.find(".jck-woosocial-like-button__count"),c="jck-woosocial-follow-action--loading";return a.hasClass(c)||(a.addClass(c),o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_like_action",nonce:jck_woosocial_vars.nonce,product_id:s,type:e},success:function(o){if(i.length>0){var s=parseInt(i.text()),n="like"===e?s+1:s-1;i.text(n),a.attr("data-type",o.button.type),a.removeClass(c),a.removeClass("jck-woosocial-like-action--"+e),a.addClass("jck-woosocial-like-action--"+o.button.type),o.add_like_html&&t.find(".jck-woosocial-likes__item--like-button").after(o.add_like_html),o.remove_like_class&&t.find(o.remove_like_class).remove()}},error:function(o){}})),!1})},setup_tabs:function(){t.els.tab_links.on("click",function(){var a=o(this).attr("href"),s="jck-woosocial-profile-link--active";return t.els.tab_links.removeClass(s),o(this).addClass(s),t.els.tab_content.hide(),o(a).show(),t.check_breakpoints(),!1})},spin_icon_start:function(o){o.addClass(t.vars.animate_spin_class)},spin_icon_stop:function(o){o.removeClass(t.vars.animate_spin_class)},disable_load_more_button:function(o){o.html(jck_woosocial_vars.strings.no_more).removeAttr("href").addClass("jck-woosocial-load-more--disabled")},setup_load_more:function(){t.els.load_more_button.on("click",function(){var a=o(this),s=a.find("i");return a.hasClass("jck-woosocial-load-more--disabled")?!1:(t.spin_icon_start(s),o(this).hasClass("jck-woosocial-load-more--activity")&&t.load_more_activity(o(this),function(){t.spin_icon_stop(s)}),void(o(this).hasClass("jck-woosocial-load-more--likes")&&t.load_more_likes(o(this),function(){t.spin_icon_stop(s)})))})},load_more_activity:function(a,s){var e=parseInt(a.attr("data-limit")),i=parseInt(a.attr("data-offset")),c=e+i,n=a.attr("data-user-id"),l=a.attr("data-profile-user-id"),r=a.closest("li");o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_activity",nonce:jck_woosocial_vars.nonce,limit:e,offset:i,user_id:n,profile_user_id:l},success:function(o){o.activity_html?(r.before(o.activity_html),a.attr("data-offset",c)):t.disable_load_more_button(a),void 0!==s&&s(o)},error:function(o){}})},load_more_likes:function(a,s){var e=parseInt(a.attr("data-limit")),i=parseInt(a.attr("data-offset")),c=e+i,n=a.attr("data-user-id");o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_likes",nonce:jck_woosocial_vars.nonce,limit:e,offset:i,user_id:n},success:function(o){o.likes_html?(t.els.likes_container.append(o.likes_html),a.attr("data-offset",c)):t.disable_load_more_button(a),void 0!==s&&s(o)},error:function(o){}})},add_to_cart:function(){t.els.document_body.on("click",t.vars.add_to_cart_buttons_class,function(){var a=o(this),s=a.text();a.attr("data-button-text",s).append(t.els.loading_icon)}),t.els.document_body.on("added_to_cart",function(o,a,s,e){var i=e.closest(".jck-woosocial-add-to-cart-wrapper"),c=e.attr("data-button-text");i.length>0&&(e.html(c).append(t.els.tick_icon),setTimeout(function(){e.html(c)},2e3))})},setup_breakpoints:function(){t.els.breakpoint_elements.length>0&&t.els.breakpoint_elements.each(function(a,s){var e=o(s),i=e.attr("data-breakpoints"),c=o.parseJSON(i),n={element:e,breakpoints:c,width:0};t.els.breakpoints.push(n)}),t.els.document_body.on("element_width_change",function(o,a){t.update_breakpoints(a)})},check_breakpoints:function(){t.els.breakpoints.length>0&&o.each(t.els.breakpoints,function(o,a){var s=a.width,e=a.element.width();e!==s&&(a.width=e,t.els.document_body.trigger("element_width_change",[a]))})},update_breakpoints:function(a){var t=!1;o.each(a.breakpoints,function(o,s){a.width<=s.max_width&&(t?s.max_width<=t&&(t=s.max_width):t=s.max_width)}),o.each(a.breakpoints,function(o,s){s.max_width===t?a.element.addClass(s["class"]):a.element.removeClass(s["class"])})},setup_cards:function(){t.els.document_body.hoverIntent(function(){var a=o(this);a.addClass(t.vars.card_hover_class)},function(){var a=o(this);a.removeClass(t.vars.card_hover_class)},t.vars.card_grid_cards_class)}};o(a).ready(t.on_ready()),o(window).on("scroll",function(){t.on_scroll()}),o(window).on("resize",function(){t.on_resize()})}(jQuery,document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwiamNrX3dvb3NvY2lhbCIsImNhY2hlIiwiZWxzIiwidmFycyIsImlzX2hpZGRlbl9jbGFzcyIsImFuaW1hdGVfc3Bpbl9jbGFzcyIsImFkZF90b19jYXJ0X2J1dHRvbnNfY2xhc3MiLCJjYXJkX2dyaWRfY2FyZHNfY2xhc3MiLCJjYXJkX2hvdmVyX2NsYXNzIiwiZG9jdW1lbnRfYm9keSIsImJvZHkiLCJhY3Rpb25zX2xpc3QiLCJ0YWJfbGlua3MiLCJ0YWJfY29udGVudCIsImxvYWRfbW9yZV9idXR0b24iLCJhY3Rpb25fYmxvY2tzIiwibGlrZXNfY29udGFpbmVyIiwiYWRkX3RvX2NhcnRfYnV0dG9ucyIsInRpY2tfaWNvbiIsImxvYWRpbmdfaWNvbiIsImNhcmRfZ3JpZHMiLCJicmVha3BvaW50X2VsZW1lbnRzIiwiYnJlYWtwb2ludHMiLCJvbl9yZWFkeSIsInNldHVwX2ZvbGxvd19hY3Rpb25zIiwic2V0dXBfbGlrZV9hY3Rpb24iLCJzZXR1cF90YWJzIiwic2V0dXBfbG9hZF9tb3JlIiwiYWRkX3RvX2NhcnQiLCJzZXR1cF9icmVha3BvaW50cyIsImNoZWNrX2JyZWFrcG9pbnRzIiwic2V0dXBfY2FyZHMiLCJvbl9zY3JvbGwiLCJvbl9yZXNpemUiLCJvbiIsIiRidXR0b24iLCJ0aGlzIiwidXNlcl9pZCIsImF0dHIiLCJ0eXBlIiwibG9hZGluZ19jbGFzcyIsImhhc0NsYXNzIiwiYWRkQ2xhc3MiLCJhamF4IiwidXJsIiwiamNrX3dvb3NvY2lhbF92YXJzIiwiYWpheF91cmwiLCJkYXRhVHlwZSIsImNyb3NzRG9tYWluIiwiZGF0YSIsImFjdGlvbiIsIm5vbmNlIiwic3VjY2VzcyIsInRleHQiLCJidXR0b24iLCJyZW1vdmVDbGFzcyIsImFkZF9mb2xsb3dfaHRtbCIsInByZXBlbmQiLCJyZW1vdmVfZm9sbG93X2NsYXNzIiwicmVtb3ZlIiwiZXJyb3IiLCIkY3VycmVudF9saWtlc19saXN0IiwiY2xvc2VzdCIsInByb2R1Y3RfaWQiLCIkY291bnQiLCJmaW5kIiwibGVuZ3RoIiwiY291bnQiLCJwYXJzZUludCIsIm5ld19jb3VudCIsImFkZF9saWtlX2h0bWwiLCJhZnRlciIsInJlbW92ZV9saWtlX2NsYXNzIiwidGFyZ2V0IiwiYWN0aXZlX2NsYXNzIiwiaGlkZSIsInNob3ciLCJzcGluX2ljb25fc3RhcnQiLCIkaWNvbiIsInNwaW5faWNvbl9zdG9wIiwiZGlzYWJsZV9sb2FkX21vcmVfYnV0dG9uIiwiaHRtbCIsInN0cmluZ3MiLCJub19tb3JlIiwicmVtb3ZlQXR0ciIsIiRsb2FkX21vcmVfYnV0dG9uIiwiJGxvYWRfbW9yZV9pY29uIiwibG9hZF9tb3JlX2FjdGl2aXR5IiwibG9hZF9tb3JlX2xpa2VzIiwiY2FsbGJhY2siLCJsaW1pdCIsIm9mZnNldCIsIm5leHRfb2Zmc2V0IiwicHJvZmlsZV91c2VyX2lkIiwiJGxvYWRfbW9yZV9pdGVtIiwiYWN0aXZpdHlfaHRtbCIsImJlZm9yZSIsInVuZGVmaW5lZCIsImxpa2VzX2h0bWwiLCJhcHBlbmQiLCJidXR0b25fdGV4dCIsImUiLCJmcmFnbWVudHMiLCJjYXJ0X2hhc2giLCIkd29vc29jaWFsX2J1dHRvbl93cmFwcGVyIiwic2V0VGltZW91dCIsImVhY2giLCJpbmRleCIsImVsZW1lbnQiLCIkZWxlbWVudCIsImJyZWFrcG9pbnRzX2FycmF5IiwicGFyc2VKU09OIiwiYnJlYWtwb2ludF9vYmplY3QiLCJ3aWR0aCIsInB1c2giLCJldmVudCIsInVwZGF0ZV9icmVha3BvaW50cyIsInByZXZpb3VzX3dpZHRoIiwiY3VycmVudF93aWR0aCIsInRyaWdnZXIiLCJjdXJyZW50X2JyZWFrcG9pbnQiLCJicmVha3BvaW50X2RhdGEiLCJtYXhfd2lkdGgiLCJob3ZlckludGVudCIsIiRjYXJkIiwicmVhZHkiLCJ3aW5kb3ciLCJqUXVlcnkiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBRUEsR0FBQUMsSUFFQUMsTUFBQSxX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cEUsRUFBQTRHLEtBQUExRyxFQUFBRSxJQUFBb0IsWUFBQSxTQUFBcUYsRUFBQUssR0FFQSxHQUFBSyxHQUFBTCxFQUFBQyxNQUNBSyxFQUFBTixFQUFBSixRQUFBSyxPQUVBSyxLQUFBRCxJQUVBTCxFQUFBQyxNQUFBSyxFQUVBdEgsRUFBQUUsSUFBQU8sY0FBQThHLFFBQUEsd0JBQUFQLFFBVUFJLG1CQUFBLFNBQUFKLEdBRUEsR0FBQVEsSUFBQSxDQUlBMUgsR0FBQTRHLEtBQUFNLEVBQUExRixZQUFBLFNBQUFxRixFQUFBYyxHQUVBVCxFQUFBQyxPQUFBUSxFQUFBQyxZQUVBRixFQUlBQyxFQUFBQyxXQUFBRixJQUVBQSxFQUFBQyxFQUFBQyxXQUpBRixFQUFBQyxFQUFBQyxhQWNBNUgsRUFBQTRHLEtBQUFNLEVBQUExRixZQUFBLFNBQUFxRixFQUFBYyxHQUVBQSxFQUFBQyxZQUFBRixFQUVBUixFQUFBSixRQUFBbEUsU0FBQStFLEVBQUFBLFVBSUFULEVBQUFKLFFBQUFyRCxZQUFBa0UsRUFBQUEsYUFRQTFGLFlBQUEsV0FFQS9CLEVBQUFFLElBQUFPLGNBQUFrSCxZQUVBLFdBRUEsR0FBQUMsR0FBQTlILEVBQUFzQyxLQUVBd0YsR0FBQWxGLFNBQUExQyxFQUFBRyxLQUFBSyxtQkFJQSxXQUVBLEdBQUFvSCxHQUFBOUgsRUFBQXNDLEtBRUF3RixHQUFBckUsWUFBQXZELEVBQUFHLEtBQUFLLG1CQUlBUixFQUFBRyxLQUFBSSx3QkFPQVQsR0FBQUMsR0FBQThILE1BQUE3SCxFQUFBdUIsWUFDQXpCLEVBQUFnSSxRQUFBNUYsR0FBQSxTQUFBLFdBQUFsQyxFQUFBZ0MsY0FDQWxDLEVBQUFnSSxRQUFBNUYsR0FBQSxTQUFBLFdBQUFsQyxFQUFBaUMsZUFFQThGLE9BQUFoSSIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigkLCBkb2N1bWVudCkge1xuICAgIFxuICAgIHZhciBqY2tfd29vc29jaWFsID0ge1xuICAgICAgICBcbiAgICAgICAgY2FjaGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMgPSB7fTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwudmFycyA9IHt9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnZhcnMuaXNfaGlkZGVuX2NsYXNzID0gXCJqY2std29vc29jaWFsLS1pcy1oaWRkZW5cIjtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwudmFycy5hbmltYXRlX3NwaW5fY2xhc3MgPSBcImpjay13b29zb2NpYWwtc3BpblwiO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC52YXJzLmFkZF90b19jYXJ0X2J1dHRvbnNfY2xhc3MgPSAnLmpjay13b29zb2NpYWwtYWRkLXRvLWNhcnQtd3JhcHBlciAuYWRkX3RvX2NhcnRfYnV0dG9uJztcbiAgICAgICAgICAgIGpja193b29zb2NpYWwudmFycy5jYXJkX2dyaWRfY2FyZHNfY2xhc3MgPSAnLmpjay13b29zb2NpYWwtY2FyZC1ncmlkIC5qY2std29vc29jaWFsLWNhcmQnO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC52YXJzLmNhcmRfaG92ZXJfY2xhc3MgPSAnamNrLXdvb3NvY2lhbC1jYXJkLS1ob3Zlcic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmRvY3VtZW50X2JvZHkgPSAkKGRvY3VtZW50LmJvZHkpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuYWN0aW9uc19saXN0ID0gJCgnLmpjay13b29zb2NpYWwtYWN0aW9ucycpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMudGFiX2xpbmtzID0gJCgnLmpjay13b29zb2NpYWwtcHJvZmlsZS1saW5rJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50YWJfY29udGVudCA9ICQoJy5qY2std29vc29jaWFsLXRhYi1jb250ZW50Jyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5sb2FkX21vcmVfYnV0dG9uID0gJCgnLmpjay13b29zb2NpYWwtbG9hZC1tb3JlJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5hY3Rpb25fYmxvY2tzID0gJCgnLmpjay13b29zb2NpYWwtYWN0aW9uJyk7ICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5saWtlc19jb250YWluZXIgPSAkKCcuamNrLXdvb3NvY2lhbC11c2VyLWxpa2VzJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5hZGRfdG9fY2FydF9idXR0b25zID0gJCgnLmpjay13b29zb2NpYWwtYWRkLXRvLWNhcnQtd3JhcHBlciAuYWRkX3RvX2NhcnRfYnV0dG9uJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50aWNrX2ljb24gPSAkKCc8aSBjbGFzcz1cImpjay13b29zb2NpYWwtaWMtdGlja1wiPjwvaT4nKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmxvYWRpbmdfaWNvbiA9ICQoJzxpIGNsYXNzPVwiamNrLXdvb3NvY2lhbC1pYy1sb2FkaW5nIGpjay13b29zb2NpYWwtc3BpblwiPjwvaT4nKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmNhcmRfZ3JpZHMgPSAkKCcuamNrLXdvb3NvY2lhbC1jYXJkLWdyaWQnKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmJyZWFrcG9pbnRfZWxlbWVudHMgPSAkKCdbZGF0YS1icmVha3BvaW50c10nKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmJyZWFrcG9pbnRzID0gW107XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiBcbiAgICAgICAgb25fcmVhZHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmNhY2hlKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX2ZvbGxvd19hY3Rpb25zKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX2xpa2VfYWN0aW9uKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX3RhYnMoKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuc2V0dXBfbG9hZF9tb3JlKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmFkZF90b19jYXJ0KCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX2JyZWFrcG9pbnRzKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmNoZWNrX2JyZWFrcG9pbnRzKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX2NhcmRzKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIG9uX3Njcm9sbDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIG9uX3Jlc2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuY2hlY2tfYnJlYWtwb2ludHMoKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICBcbiAgICAgICAgc2V0dXBfZm9sbG93X2FjdGlvbnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkKCcuamNrLXdvb3NvY2lhbC1mb2xsb3ctYWN0aW9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgJGJ1dHRvbiA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgIHVzZXJfaWQgPSAkYnV0dG9uLmF0dHIoJ2RhdGEtdXNlci1pZCcpLFxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gJGJ1dHRvbi5hdHRyKCdkYXRhLXR5cGUnKSxcbiAgICAgICAgICAgICAgICAgICAgbG9hZGluZ19jbGFzcyA9ICdqY2std29vc29jaWFsLWZvbGxvdy1hY3Rpb24tLWxvYWRpbmcnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKCB0eXBlID09PSBcImxvZ2luXCIgKSB7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmKCAhJGJ1dHRvbi5oYXNDbGFzcyhsb2FkaW5nX2NsYXNzKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgJGJ1dHRvbi5hZGRDbGFzcyhsb2FkaW5nX2NsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgXHRcdFx0XHR0eXBlOiAgICAgICAgXCJHRVRcIixcbiAgICAgICAgICAgIFx0XHRcdFx0dXJsOiAgICAgICAgIGpja193b29zb2NpYWxfdmFycy5hamF4X3VybCxcbiAgICAgICAgICAgIFx0XHRcdFx0Y2FjaGU6ICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgXHRcdFx0XHRkYXRhVHlwZTogICAgXCJqc29ucFwiLFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdGNyb3NzRG9tYWluOiB0cnVlLFxuICAgICAgICAgICAgXHRcdFx0XHRkYXRhOiB7XG4gICAgICAgICAgICBcdFx0XHRcdFx0YWN0aW9uOiAgJ2pja193b29zb2NpYWxfZm9sbG93X2FjdGlvbicsXG4gICAgICAgICAgICBcdFx0XHRcdFx0bm9uY2U6ICAgamNrX3dvb3NvY2lhbF92YXJzLm5vbmNlLFxuICAgICAgICAgICAgXHRcdFx0XHRcdHVzZXJfaWQ6IHVzZXJfaWQsXG4gICAgICAgICAgICBcdFx0XHRcdFx0dHlwZTogICAgdHlwZVxuICAgICAgICAgICAgXHRcdFx0XHR9LFxuICAgICAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi50ZXh0KGRhdGEuYnV0dG9uLnRleHQpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24uYXR0cignZGF0YS10eXBlJyxkYXRhLmJ1dHRvbi50eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLnJlbW92ZUNsYXNzKGxvYWRpbmdfY2xhc3MpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24ucmVtb3ZlQ2xhc3MoJ2pjay13b29zb2NpYWwtZm9sbG93LWFjdGlvbi0tJyt0eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLmFkZENsYXNzKCdqY2std29vc29jaWFsLWZvbGxvdy1hY3Rpb24tLScrZGF0YS5idXR0b24udHlwZSk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0aWYoZGF0YS5hZGRfZm9sbG93X2h0bWwpIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0amNrX3dvb3NvY2lhbC5lbHMuYWN0aW9uc19saXN0LnByZXBlbmQoZGF0YS5hZGRfZm9sbG93X2h0bWwpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdH1cbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHRpZihkYXRhLnJlbW92ZV9mb2xsb3dfY2xhc3MpIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0JChkYXRhLnJlbW92ZV9mb2xsb3dfY2xhc3MpLnJlbW92ZSgpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdH1cbiAgICAgICAgICAgIFx0XHRcdFx0fSxcbiAgICAgICAgICAgIFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdGVycm9yOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHR9XG4gICAgICAgICAgICBcdFx0XHR9KTtcbiAgICAgICAgXHRcdFx0XG4gICAgICAgIFx0XHRcdH1cbiAgICBcdFx0XHRcbiAgICBcdFx0XHR9XG5cdFx0XHRcblx0XHRcdH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzZXR1cF9saWtlX2FjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuamNrLXdvb3NvY2lhbC1saWtlLWFjdGlvbicsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyICRidXR0b24gPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICAkY3VycmVudF9saWtlc19saXN0ID0gJGJ1dHRvbi5jbG9zZXN0KCcuamNrLXdvb3NvY2lhbC1saWtlcycpLFxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X2lkID0gJGJ1dHRvbi5hdHRyKCdkYXRhLXByb2R1Y3QtaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICRidXR0b24uYXR0cignZGF0YS10eXBlJyksXG4gICAgICAgICAgICAgICAgICAgICRjb3VudCA9ICRidXR0b24uZmluZCgnLmpjay13b29zb2NpYWwtbGlrZS1idXR0b25fX2NvdW50JyksXG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmdfY2xhc3MgPSAnamNrLXdvb3NvY2lhbC1mb2xsb3ctYWN0aW9uLS1sb2FkaW5nJztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICEkYnV0dG9uLmhhc0NsYXNzKGxvYWRpbmdfY2xhc3MpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICRidXR0b24uYWRkQ2xhc3MobG9hZGluZ19jbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICBcdFx0XHRcdHR5cGU6IFwiR0VUXCIsXG4gICAgICAgIFx0XHRcdFx0dXJsOiBqY2tfd29vc29jaWFsX3ZhcnMuYWpheF91cmwsXG4gICAgICAgIFx0XHRcdFx0Y2FjaGU6IGZhbHNlLFxuICAgICAgICBcdFx0XHRcdGRhdGFUeXBlOiBcImpzb25wXCIsXHRcdFx0XHRcbiAgICAgICAgXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcbiAgICAgICAgXHRcdFx0XHRkYXRhOiB7XG4gICAgICAgIFx0XHRcdFx0XHRhY3Rpb246ICdqY2tfd29vc29jaWFsX2xpa2VfYWN0aW9uJyxcbiAgICAgICAgXHRcdFx0XHRcdG5vbmNlOiBqY2tfd29vc29jaWFsX3ZhcnMubm9uY2UsXG4gICAgICAgIFx0XHRcdFx0XHRwcm9kdWN0X2lkOiBwcm9kdWN0X2lkLFxuICAgICAgICBcdFx0XHRcdFx0dHlwZTogdHlwZVxuICAgICAgICBcdFx0XHRcdH0sXG4gICAgICAgIFx0XHRcdFx0XG4gICAgICAgIFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgXHRcdFx0XHRcdGlmKCAkY291bnQubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHR2YXIgY291bnQgPSBwYXJzZUludCgkY291bnQudGV4dCgpKSxcbiAgICAgICAgICAgIFx0XHRcdFx0XHQgICAgbmV3X2NvdW50ID0gdHlwZSA9PT0gXCJsaWtlXCIgPyBjb3VudCsxIDogY291bnQtMTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkY291bnQudGV4dCggbmV3X2NvdW50ICk7IFxuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24uYXR0cignZGF0YS10eXBlJywgZGF0YS5idXR0b24udHlwZSk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5yZW1vdmVDbGFzcyhsb2FkaW5nX2NsYXNzKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLnJlbW92ZUNsYXNzKCdqY2std29vc29jaWFsLWxpa2UtYWN0aW9uLS0nK3R5cGUpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24uYWRkQ2xhc3MoJ2pjay13b29zb2NpYWwtbGlrZS1hY3Rpb24tLScrZGF0YS5idXR0b24udHlwZSk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0aWYoZGF0YS5hZGRfbGlrZV9odG1sKSB7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdCRjdXJyZW50X2xpa2VzX2xpc3QuZmluZCgnLmpjay13b29zb2NpYWwtbGlrZXNfX2l0ZW0tLWxpa2UtYnV0dG9uJykuYWZ0ZXIoZGF0YS5hZGRfbGlrZV9odG1sKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHR9XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0aWYoZGF0YS5yZW1vdmVfbGlrZV9jbGFzcykge1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkY3VycmVudF9saWtlc19saXN0LmZpbmQoZGF0YS5yZW1vdmVfbGlrZV9jbGFzcykucmVtb3ZlKCk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0fSAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICBcdFx0XHRcdFx0fVxuICAgICAgICBcdFx0XHRcdH0sXG4gICAgICAgIFx0XHRcdFx0XG4gICAgICAgIFx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgXHRcdFx0XHR9XG4gICAgICAgIFx0XHRcdH0pO1xuICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNldHVwX3RhYnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50YWJfbGlua3Mub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gJCh0aGlzKS5hdHRyKCdocmVmJyksXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZV9jbGFzcyA9ICdqY2std29vc29jaWFsLXByb2ZpbGUtbGluay0tYWN0aXZlJztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50YWJfbGlua3MucmVtb3ZlQ2xhc3MoYWN0aXZlX2NsYXNzKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKGFjdGl2ZV9jbGFzcyk7XG4gICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMudGFiX2NvbnRlbnQuaGlkZSgpO1xuICAgICAgICAgICAgICAgICQodGFyZ2V0KS5zaG93KCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5jaGVja19icmVha3BvaW50cygpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzcGluX2ljb25fc3RhcnQ6IGZ1bmN0aW9uKCAkaWNvbiApe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkaWNvbi5hZGRDbGFzcyggamNrX3dvb3NvY2lhbC52YXJzLmFuaW1hdGVfc3Bpbl9jbGFzcyApO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzcGluX2ljb25fc3RvcDogZnVuY3Rpb24oICRpY29uICl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICRpY29uLnJlbW92ZUNsYXNzKCBqY2tfd29vc29jaWFsLnZhcnMuYW5pbWF0ZV9zcGluX2NsYXNzICk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGRpc2FibGVfbG9hZF9tb3JlX2J1dHRvbjogZnVuY3Rpb24oICRidXR0b24gKXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJGJ1dHRvblxuICAgICAgICAgICAgLmh0bWwoIGpja193b29zb2NpYWxfdmFycy5zdHJpbmdzLm5vX21vcmUgKVxuICAgICAgICAgICAgLnJlbW92ZUF0dHIoJ2hyZWYnKVxuICAgICAgICAgICAgLmFkZENsYXNzKFwiamNrLXdvb3NvY2lhbC1sb2FkLW1vcmUtLWRpc2FibGVkXCIpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzZXR1cF9sb2FkX21vcmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5sb2FkX21vcmVfYnV0dG9uLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyICRsb2FkX21vcmVfYnV0dG9uID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgJGxvYWRfbW9yZV9pY29uID0gJGxvYWRfbW9yZV9idXR0b24uZmluZCgnaScpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggJGxvYWRfbW9yZV9idXR0b24uaGFzQ2xhc3MoXCJqY2std29vc29jaWFsLWxvYWQtbW9yZS0tZGlzYWJsZWRcIikgKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zcGluX2ljb25fc3RhcnQoICRsb2FkX21vcmVfaWNvbiApO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICQodGhpcykuaGFzQ2xhc3MoJ2pjay13b29zb2NpYWwtbG9hZC1tb3JlLS1hY3Rpdml0eScpICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5sb2FkX21vcmVfYWN0aXZpdHkoICQodGhpcyksIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuc3Bpbl9pY29uX3N0b3AoICRsb2FkX21vcmVfaWNvbiApO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggJCh0aGlzKS5oYXNDbGFzcygnamNrLXdvb3NvY2lhbC1sb2FkLW1vcmUtLWxpa2VzJykgKSB7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmxvYWRfbW9yZV9saWtlcyggJCh0aGlzKSwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zcGluX2ljb25fc3RvcCggJGxvYWRfbW9yZV9pY29uICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgbG9hZF9tb3JlX2FjdGl2aXR5OiBmdW5jdGlvbiggJGxvYWRfbW9yZV9idXR0b24sIGNhbGxiYWNrICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgbGltaXQgPSBwYXJzZUludCggJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1saW1pdCcpICksXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtb2Zmc2V0JykgKSxcbiAgICAgICAgICAgICAgICBuZXh0X29mZnNldCA9IGxpbWl0K29mZnNldCxcbiAgICAgICAgICAgICAgICB1c2VyX2lkID0gJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS11c2VyLWlkJyksXG4gICAgICAgICAgICAgICAgcHJvZmlsZV91c2VyX2lkID0gJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1wcm9maWxlLXVzZXItaWQnKSxcbiAgICAgICAgICAgICAgICAkbG9hZF9tb3JlX2l0ZW0gPSAkbG9hZF9tb3JlX2J1dHRvbi5jbG9zZXN0KCdsaScpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgJC5hamF4KHtcblx0XHRcdFx0dHlwZTogICAgICAgIFwiR0VUXCIsXG5cdFx0XHRcdHVybDogICAgICAgICBqY2tfd29vc29jaWFsX3ZhcnMuYWpheF91cmwsXG5cdFx0XHRcdGNhY2hlOiAgICAgICBmYWxzZSxcblx0XHRcdFx0ZGF0YVR5cGU6ICAgIFwianNvbnBcIixcdFx0XHRcdFxuXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcblx0XHRcdFx0ZGF0YToge1xuXHRcdFx0XHRcdGFjdGlvbjogICAgICAgICAgJ2pja193b29zb2NpYWxfbG9hZF9tb3JlX2FjdGl2aXR5Jyxcblx0XHRcdFx0XHRub25jZTogICAgICAgICAgIGpja193b29zb2NpYWxfdmFycy5ub25jZSxcblx0XHRcdFx0XHRsaW1pdDogICAgICAgICAgIGxpbWl0LFxuXHRcdFx0XHRcdG9mZnNldDogICAgICAgICAgb2Zmc2V0LFxuXHRcdFx0XHRcdHVzZXJfaWQ6ICAgICAgICAgdXNlcl9pZCxcblx0XHRcdFx0XHRwcm9maWxlX3VzZXJfaWQ6IHByb2ZpbGVfdXNlcl9pZFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIGRhdGEgKSB7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoIGRhdGEuYWN0aXZpdHlfaHRtbCApIHtcbiAgICBcdFx0XHRcdFx0XG4gICAgXHRcdFx0XHRcdCRsb2FkX21vcmVfaXRlbS5iZWZvcmUoIGRhdGEuYWN0aXZpdHlfaHRtbCApO1xuICAgIFx0XHRcdFx0XHQkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLW9mZnNldCcsIG5leHRfb2Zmc2V0KSA7XG4gICAgXHRcdFx0XHRcdFxuXHRcdFx0XHRcdH0gZWxzZSB7XG4gICAgXHRcdFx0XHRcdFxuICAgIFx0XHRcdFx0XHRqY2tfd29vc29jaWFsLmRpc2FibGVfbG9hZF9tb3JlX2J1dHRvbiggJGxvYWRfbW9yZV9idXR0b24gKTtcbiAgICBcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKGNhbGxiYWNrICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIFx0XHRcdGNhbGxiYWNrKGRhdGEpO1xuICAgICAgICAgICAgXHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0fSxcblx0XHRcdFx0XG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICBcdFx0XHRcdFxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgbG9hZF9tb3JlX2xpa2VzOiBmdW5jdGlvbiggJGxvYWRfbW9yZV9idXR0b24sIGNhbGxiYWNrICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgbGltaXQgPSBwYXJzZUludCggJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1saW1pdCcpICksXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtb2Zmc2V0JykgKSxcbiAgICAgICAgICAgICAgICBuZXh0X29mZnNldCA9IGxpbWl0K29mZnNldCxcbiAgICAgICAgICAgICAgICB1c2VyX2lkID0gJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS11c2VyLWlkJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAkLmFqYXgoe1xuXHRcdFx0XHR0eXBlOiAgICAgICAgXCJHRVRcIixcblx0XHRcdFx0dXJsOiAgICAgICAgIGpja193b29zb2NpYWxfdmFycy5hamF4X3VybCxcblx0XHRcdFx0Y2FjaGU6ICAgICAgIGZhbHNlLFxuXHRcdFx0XHRkYXRhVHlwZTogICAgXCJqc29ucFwiLFx0XHRcdFx0XG5cdFx0XHRcdGNyb3NzRG9tYWluOiB0cnVlLFxuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uOiAgJ2pja193b29zb2NpYWxfbG9hZF9tb3JlX2xpa2VzJyxcblx0XHRcdFx0XHRub25jZTogICBqY2tfd29vc29jaWFsX3ZhcnMubm9uY2UsXG5cdFx0XHRcdFx0bGltaXQ6ICAgbGltaXQsXG5cdFx0XHRcdFx0b2Zmc2V0OiAgb2Zmc2V0LFxuXHRcdFx0XHRcdHVzZXJfaWQ6IHVzZXJfaWRcblx0XHRcdFx0fSxcblx0XHRcdFx0XG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCBkYXRhICkge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKCBkYXRhLmxpa2VzX2h0bWwgKSB7XG4gICAgXHRcdFx0XHRcdFxuICAgIFx0XHRcdFx0XHRqY2tfd29vc29jaWFsLmVscy5saWtlc19jb250YWluZXIuYXBwZW5kKCBkYXRhLmxpa2VzX2h0bWwgKTtcbiAgICBcdFx0XHRcdFx0JGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1vZmZzZXQnLCBuZXh0X29mZnNldCkgO1xuICAgIFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9IGVsc2Uge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0amNrX3dvb3NvY2lhbC5kaXNhYmxlX2xvYWRfbW9yZV9idXR0b24oICRsb2FkX21vcmVfYnV0dG9uICk7XG4gICAgXHRcdFx0XHRcdFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihjYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBcdFx0XHRjYWxsYmFjayhkYXRhKTtcbiAgICAgICAgICAgIFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgXHRcdFx0XHRcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICBcdFxuICAgIFx0YWRkX3RvX2NhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBcdFxuICAgICAgICBcdGpja193b29zb2NpYWwuZWxzLmRvY3VtZW50X2JvZHkub24oJ2NsaWNrJywgamNrX3dvb3NvY2lhbC52YXJzLmFkZF90b19jYXJ0X2J1dHRvbnNfY2xhc3MsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBcdFxuICAgICAgICAgICAgXHR2YXIgJGJ1dHRvbiA9ICQodGhpcyksXG4gICAgICAgICAgICBcdCAgICBidXR0b25fdGV4dCA9ICRidXR0b24udGV4dCgpO1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgICAgICAgICAgJGJ1dHRvblxuICAgICAgICAgICAgICAgIC5hdHRyKCdkYXRhLWJ1dHRvbi10ZXh0JyxidXR0b25fdGV4dClcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCBqY2tfd29vc29jaWFsLmVscy5sb2FkaW5nX2ljb24gKTtcbiAgICAgICAgICAgIFx0XG4gICAgICAgIFx0fSk7XG4gICAgICAgIFx0XG4gICAgICAgIFx0amNrX3dvb3NvY2lhbC5lbHMuZG9jdW1lbnRfYm9keS5vbiggJ2FkZGVkX3RvX2NhcnQnLCBmdW5jdGlvbiggZSwgZnJhZ21lbnRzLCBjYXJ0X2hhc2gsICRidXR0b24gKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgJHdvb3NvY2lhbF9idXR0b25fd3JhcHBlciA9ICRidXR0b24uY2xvc2VzdCgnLmpjay13b29zb2NpYWwtYWRkLXRvLWNhcnQtd3JhcHBlcicpLFxuICAgICAgICAgICAgICAgICAgICBidXR0b25fdGV4dCA9ICRidXR0b24uYXR0cignZGF0YS1idXR0b24tdGV4dCcpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKCAkd29vc29jaWFsX2J1dHRvbl93cmFwcGVyLmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAkYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5odG1sKCBidXR0b25fdGV4dCApICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCBqY2tfd29vc29jaWFsLmVscy50aWNrX2ljb24gKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgJGJ1dHRvbi5odG1sKCBidXR0b25fdGV4dCApO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0sIDIwMDApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBcdFxuICAgICAgICBcdH0pO1xuICAgICAgICBcdFxuICAgIFx0fSxcbiAgICBcdFxuICAgICAgICBzZXR1cF9icmVha3BvaW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmKCBqY2tfd29vc29jaWFsLmVscy5icmVha3BvaW50X2VsZW1lbnRzLmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gc3RvcmUgYnJlYWtwb2ludCBkYXRhIGluIGNhY2hlIGZvciBmdXR1cmUgcmVmZXJlbmNlXG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5icmVha3BvaW50X2VsZW1lbnRzLmVhY2goZnVuY3Rpb24oIGluZGV4LCBlbGVtZW50ICl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCksXG4gICAgICAgICAgICAgICAgXHQgICAgYnJlYWtwb2ludHMgPSAkZWxlbWVudC5hdHRyKCdkYXRhLWJyZWFrcG9pbnRzJyksXG4gICAgICAgICAgICAgICAgXHQgICAgYnJlYWtwb2ludHNfYXJyYXkgPSAkLnBhcnNlSlNPTiggYnJlYWtwb2ludHMgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnRfb2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgXHRlbGVtZW50OiAkZWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha3BvaW50czogYnJlYWtwb2ludHNfYXJyYXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5icmVha3BvaW50cy5wdXNoKCBicmVha3BvaW50X29iamVjdCApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyB3aGVuIGFuIGVsZW1lbnQgd2lkdGggaGFzIGNoYW5nZWQsIHRyaWdnZXIgYnJlYWtwb2ludCB1cGRhdGVcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuZG9jdW1lbnRfYm9keS5vbignZWxlbWVudF93aWR0aF9jaGFuZ2UnLCBmdW5jdGlvbiggZXZlbnQsIGJyZWFrcG9pbnRfb2JqZWN0ICl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLnVwZGF0ZV9icmVha3BvaW50cyggYnJlYWtwb2ludF9vYmplY3QgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBjaGVja19icmVha3BvaW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgIFxuICAgICAgICAgICAgaWYoIGpja193b29zb2NpYWwuZWxzLmJyZWFrcG9pbnRzLmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFx0JC5lYWNoKGpja193b29zb2NpYWwuZWxzLmJyZWFrcG9pbnRzLCBmdW5jdGlvbihpbmRleCwgYnJlYWtwb2ludF9vYmplY3Qpe1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZpb3VzX3dpZHRoID0gYnJlYWtwb2ludF9vYmplY3Qud2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3dpZHRoID0gYnJlYWtwb2ludF9vYmplY3QuZWxlbWVudC53aWR0aCgpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoIGN1cnJlbnRfd2lkdGggIT09IHByZXZpb3VzX3dpZHRoICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha3BvaW50X29iamVjdC53aWR0aCA9IGN1cnJlbnRfd2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIFx0XG4gICAgICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5kb2N1bWVudF9ib2R5LnRyaWdnZXIoJ2VsZW1lbnRfd2lkdGhfY2hhbmdlJywgW2JyZWFrcG9pbnRfb2JqZWN0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIH0sXG5cbiAgICBcdHVwZGF0ZV9icmVha3BvaW50czogZnVuY3Rpb24oIGJyZWFrcG9pbnRfb2JqZWN0ICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgY3VycmVudF9icmVha3BvaW50ID0gZmFsc2U7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGZpZ3VyZSBvdXQgd2hpY2ggYnJlYWtwb2ludCBkYXRhIHdlIHdhbnQgdG8gdXNlXG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQuZWFjaCggYnJlYWtwb2ludF9vYmplY3QuYnJlYWtwb2ludHMsIGZ1bmN0aW9uKCBpbmRleCwgYnJlYWtwb2ludF9kYXRhICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBcdFxuICAgICAgICAgICAgICAgIGlmKCBicmVha3BvaW50X29iamVjdC53aWR0aCA8PSBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoICEgY3VycmVudF9icmVha3BvaW50ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2JyZWFrcG9pbnQgPSBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIGJyZWFrcG9pbnRfZGF0YS5tYXhfd2lkdGggPD0gY3VycmVudF9icmVha3BvaW50ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2JyZWFrcG9pbnQgPSBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIG5vdyB3ZSBrbm93IHRoZSBicmVha3BvaW50IHRvIHVzZSwgYXBwbHkgdGhhdCBjbGFzcyBhbmQgcmVtb3ZlIHRoZSBvdGhlcnNcbiAgICAgICAgICAgICAgICAgICAgXHRcbiAgICAgICAgICAgICQuZWFjaCggYnJlYWtwb2ludF9vYmplY3QuYnJlYWtwb2ludHMsIGZ1bmN0aW9uKCBpbmRleCwgYnJlYWtwb2ludF9kYXRhICl7XG5cbiAgICAgICAgICAgICAgICBpZiggYnJlYWtwb2ludF9kYXRhLm1heF93aWR0aCA9PT0gY3VycmVudF9icmVha3BvaW50ICkge1xuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnRfb2JqZWN0LmVsZW1lbnQuYWRkQ2xhc3MoIGJyZWFrcG9pbnRfZGF0YS5jbGFzcyApO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICBicmVha3BvaW50X29iamVjdC5lbGVtZW50LnJlbW92ZUNsYXNzKCBicmVha3BvaW50X2RhdGEuY2xhc3MgKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIFx0XG4gICAgXHR9LFxuICAgIFx0XG4gICAgXHRzZXR1cF9jYXJkczogZnVuY3Rpb24oKSB7XG4gICAgICAgIFx0XG4gICAgICAgIFx0amNrX3dvb3NvY2lhbC5lbHMuZG9jdW1lbnRfYm9keS5ob3ZlckludGVudCggXG4gICAgICAgICAgICBcdFxuICAgICAgICBcdCAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgICAgICBcdCAgICB2YXIgJGNhcmQgPSAkKHRoaXMpO1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgICAgICBcdCAgICAkY2FyZC5hZGRDbGFzcyggamNrX3dvb3NvY2lhbC52YXJzLmNhcmRfaG92ZXJfY2xhc3MgKTtcbiAgICAgICAgICAgIFx0ICAgIFxuICAgICAgICBcdCAgICB9LCBcbiAgICAgICAgXHQgICAgXG4gICAgICAgIFx0ICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBcdCAgICBcbiAgICAgICAgICAgIFx0ICAgIHZhciAkY2FyZCA9ICQodGhpcyk7XG4gICAgICAgICAgICBcdCAgICBcbiAgICAgICAgICAgIFx0ICAgICRjYXJkLnJlbW92ZUNsYXNzKCBqY2tfd29vc29jaWFsLnZhcnMuY2FyZF9ob3Zlcl9jbGFzcyApO1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgIFx0ICAgIH0sIFxuICAgICAgICBcdCAgICBcbiAgICAgICAgXHQgICAgamNrX3dvb3NvY2lhbC52YXJzLmNhcmRfZ3JpZF9jYXJkc19jbGFzcyBcbiAgICAgICAgICAgICk7XG4gICAgICAgIFx0XG4gICAgXHR9XG4gICAgIFxuICAgIH07XG4gICAgXG5cdCQoZG9jdW1lbnQpLnJlYWR5KCBqY2tfd29vc29jaWFsLm9uX3JlYWR5KCkgKTtcdFxuXHQkKHdpbmRvdykub24oJ3Njcm9sbCcsIGZ1bmN0aW9uKCkgeyBqY2tfd29vc29jaWFsLm9uX3Njcm9sbCgpOyB9ICk7XG5cdCQod2luZG93KS5vbigncmVzaXplJywgZnVuY3Rpb24oKSB7IGpja193b29zb2NpYWwub25fcmVzaXplKCk7IH0gKTtcblxufShqUXVlcnksIGRvY3VtZW50KSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9