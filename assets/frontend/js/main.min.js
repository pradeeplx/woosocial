!function(o,a){var t={cache:function(){t.els={},t.vars={},t.vars.is_hidden_class="jck-woosocial--is-hidden",t.vars.animate_spin_class="jck-woosocial-spin",t.vars.add_to_cart_buttons_class=".jck-woosocial-add-to-cart-wrapper .add_to_cart_button",t.vars.card_grid_cards_class=".jck-woosocial-card-grid .jck-woosocial-card",t.vars.card_hover_class="jck-woosocial-card--hover",t.els.document_body=o(a.body),t.els.actions_list=o(".jck-woosocial-actions"),t.els.tab_links=o(".jck-woosocial-profile-link"),t.els.tab_content=o(".jck-woosocial-tab-content"),t.els.load_more_button=o(".jck-woosocial-load-more"),t.els.action_blocks=o(".jck-woosocial-action"),t.els.likes_container=o(".jck-woosocial-user-likes"),t.els.following_container=o(".jck-woosocial-following"),t.els.followers_container=o(".jck-woosocial-followers"),t.els.add_to_cart_buttons=o(".jck-woosocial-add-to-cart-wrapper .add_to_cart_button"),t.els.tick_icon=o('<i class="jck-woosocial-ic-tick"></i>'),t.els.loading_icon=o('<i class="jck-woosocial-ic-loading jck-woosocial-spin"></i>'),t.els.card_grids=o(".jck-woosocial-card-grid"),t.els.breakpoint_elements=o("[data-breakpoints]"),t.els.breakpoints=[]},on_ready:function(){t.cache(),t.setup_follow_actions(),t.setup_product_like_action(),t.setup_tabs(),t.setup_load_more(),t.add_to_cart(),t.setup_breakpoints(),t.check_breakpoints(),t.setup_cards()},on_scroll:function(){},on_resize:function(){t.check_breakpoints()},setup_follow_actions:function(){o(".jck-woosocial-follow-action").on("click",function(){var a=o(this),s=a.attr("data-user-id"),e=a.attr("data-type"),i="jck-woosocial-follow-action--loading";"login"!==e&&(a.hasClass(i)||(a.addClass(i),o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_follow_action",nonce:jck_woosocial_vars.nonce,user_id:s,type:e},success:function(o){a.text(o.button.text),a.attr("data-type",o.button.type),a.removeClass(i),a.removeClass("jck-woosocial-follow-action--"+e),a.addClass("jck-woosocial-follow-action--"+o.button.type),o.add_follow_html&&t.els.actions_list.prepend(o.add_follow_html)},error:function(o){}})))})},setup_product_like_action:function(){o(a).on("click",".jck-woosocial-product-like-action",function(){{var a=o(this),t=a.closest(".jck-woosocial-product-likes"),s=a.attr("data-product-id"),e=a.attr("data-type"),i=a.find(".jck-woosocial-product-like-button__count"),c="jck-woosocial-product-like-action--loading",n=a.find("i");a.closest(".jck-woosocial-action")}return"login"!==e?(a.hasClass(c)||(a.addClass(c),o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_product_like_action",nonce:jck_woosocial_vars.nonce,product_id:s,type:e},success:function(o){if(i.length>0){var s=parseInt(i.text()),l="like"===e?s+1:s-1;i.text(l),a.attr("data-type",o.button.type),a.removeClass(c),a.removeClass("jck-woosocial-product-like-action--"+e),a.addClass("jck-woosocial-product-like-action--"+o.button.type),"unlike"===o.button.type?n.attr("class","jck-woosocial-ic-heart-full"):n.attr("class","jck-woosocial-ic-heart"),o.add_like_html&&t.find(".jck-woosocial-product-likes__item--like-button").after(o.add_like_html),o.remove_like_class&&t.find(o.remove_like_class).remove()}},error:function(o){}})),!1):void 0})},setup_tabs:function(){t.els.tab_links.on("click",function(){var a=o(this).attr("href"),s="jck-woosocial-profile-link--active";return t.els.tab_links.removeClass(s),o(this).addClass(s),t.els.tab_content.hide(),o(a).show(),t.check_breakpoints(),!1})},spin_icon_start:function(o){o.addClass(t.vars.animate_spin_class)},spin_icon_stop:function(o){o.removeClass(t.vars.animate_spin_class)},disable_load_more_button:function(o){o.html(jck_woosocial_vars.strings.no_more).removeAttr("href").addClass("jck-woosocial-load-more--disabled")},setup_load_more:function(){t.els.load_more_button.on("click",function(){var a=o(this),s=a.find("i");return a.hasClass("jck-woosocial-load-more--disabled")?!1:(t.spin_icon_start(s),o(this).hasClass("jck-woosocial-load-more--activity")&&t.load_more_activity(o(this),function(){t.spin_icon_stop(s)}),o(this).hasClass("jck-woosocial-load-more--likes")&&t.load_more_likes(o(this),function(){t.spin_icon_stop(s)}),o(this).hasClass("jck-woosocial-load-more--followers")&&t.load_more_followers(o(this),function(){t.spin_icon_stop(s)}),void(o(this).hasClass("jck-woosocial-load-more--following")&&t.load_more_following(o(this),function(){t.spin_icon_stop(s)})))})},load_more_activity:function(a,s){var e=parseInt(a.attr("data-limit")),i=parseInt(a.attr("data-offset")),c=e+i,n=a.attr("data-user-id"),l=a.attr("data-profile-user-id"),r=a.closest("li");o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_activity",nonce:jck_woosocial_vars.nonce,limit:e,offset:i,user_id:n,profile_user_id:l},success:function(o){o.activity_html?(r.before(o.activity_html),a.attr("data-offset",c)):t.disable_load_more_button(a),void 0!==s&&s(o)},error:function(o){}})},load_more_likes:function(a,s){var e=parseInt(a.attr("data-limit")),i=parseInt(a.attr("data-offset")),c=e+i,n=a.attr("data-user-id");o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_likes",nonce:jck_woosocial_vars.nonce,limit:e,offset:i,user_id:n},success:function(o){o.likes_html?(t.els.likes_container.append(o.likes_html),a.attr("data-offset",c)):t.disable_load_more_button(a),void 0!==s&&s(o)},error:function(o){}})},load_more_followers:function(a,s){var e=parseInt(a.attr("data-limit")),i=parseInt(a.attr("data-offset")),c=e+i,n=a.attr("data-user-id");o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_followers",nonce:jck_woosocial_vars.nonce,limit:e,offset:i,user_id:n},success:function(o){console.log(o),o.followers_html?(t.els.followers_container.append(o.followers_html),a.attr("data-offset",c)):t.disable_load_more_button(a),void 0!==s&&s(o)},error:function(o){}})},load_more_following:function(a,s){var e=parseInt(a.attr("data-limit")),i=parseInt(a.attr("data-offset")),c=e+i,n=a.attr("data-user-id");o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_following",nonce:jck_woosocial_vars.nonce,limit:e,offset:i,user_id:n},success:function(o){console.log(o),o.following_html?(t.els.following_container.append(o.following_html),a.attr("data-offset",c)):t.disable_load_more_button(a),void 0!==s&&s(o)},error:function(o){}})},add_to_cart:function(){t.els.document_body.on("click",t.vars.add_to_cart_buttons_class,function(){var a=o(this),s=a.text();a.attr("data-button-text",s).append(t.els.loading_icon)}),t.els.document_body.on("added_to_cart",function(o,a,s,e){var i=e.closest(".jck-woosocial-add-to-cart-wrapper"),c=e.attr("data-button-text");i.length>0&&(e.html(c).append(t.els.tick_icon),setTimeout(function(){e.html(c)},2e3))})},setup_breakpoints:function(){t.els.breakpoint_elements.length>0&&t.els.breakpoint_elements.each(function(a,s){var e=o(s),i=e.attr("data-breakpoints"),c=o.parseJSON(i),n={element:e,breakpoints:c,width:0};t.els.breakpoints.push(n)}),t.els.document_body.on("element_width_change",function(o,a){t.update_breakpoints(a)})},check_breakpoints:function(){t.els.breakpoints.length>0&&o.each(t.els.breakpoints,function(o,a){var s=a.width,e=a.element.width();e!==s&&(a.width=e,t.els.document_body.trigger("element_width_change",[a]))})},update_breakpoints:function(a){var t=!1;o.each(a.breakpoints,function(o,s){a.width<=s.max_width&&(t?s.max_width<=t&&(t=s.max_width):t=s.max_width)}),o.each(a.breakpoints,function(o,s){s.max_width===t?a.element.addClass(s["class"]):a.element.removeClass(s["class"])})},setup_cards:function(){t.els.document_body.hoverIntent(function(){var a=o(this);a.addClass(t.vars.card_hover_class)},function(){var a=o(this);a.removeClass(t.vars.card_hover_class)},t.vars.card_grid_cards_class)}};o(a).ready(t.on_ready()),o(window).on("scroll",function(){t.on_scroll()}),o(window).on("resize",function(){t.on_resize()})}(jQuery,document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwiamNrX3dvb3NvY2lhbCIsImNhY2hlIiwiZWxzIiwidmFycyIsImlzX2hpZGRlbl9jbGFzcyIsImFuaW1hdGVfc3Bpbl9jbGFzcyIsImFkZF90b19jYXJ0X2J1dHRvbnNfY2xhc3MiLCJjYXJkX2dyaWRfY2FyZHNfY2xhc3MiLCJjYXJkX2hvdmVyX2NsYXNzIiwiZG9jdW1lbnRfYm9keSIsImJvZHkiLCJhY3Rpb25zX2xpc3QiLCJ0YWJfbGlua3MiLCJ0YWJfY29udGVudCIsImxvYWRfbW9yZV9idXR0b24iLCJhY3Rpb25fYmxvY2tzIiwibGlrZXNfY29udGFpbmVyIiwiZm9sbG93aW5nX2NvbnRhaW5lciIsImZvbGxvd2Vyc19jb250YWluZXIiLCJhZGRfdG9fY2FydF9idXR0b25zIiwidGlja19pY29uIiwibG9hZGluZ19pY29uIiwiY2FyZF9ncmlkcyIsImJyZWFrcG9pbnRfZWxlbWVudHMiLCJicmVha3BvaW50cyIsIm9uX3JlYWR5Iiwic2V0dXBfZm9sbG93X2FjdGlvbnMiLCJzZXR1cF9wcm9kdWN0X2xpa2VfYWN0aW9uIiwic2V0dXBfdGFicyIsInNldHVwX2xvYWRfbW9yZSIsImFkZF90b19jYXJ0Iiwic2V0dXBfYnJlYWtwb2ludHMiLCJjaGVja19icmVha3BvaW50cyIsInNldHVwX2NhcmRzIiwib25fc2Nyb2xsIiwib25fcmVzaXplIiwib24iLCIkYnV0dG9uIiwidGhpcyIsInVzZXJfaWQiLCJhdHRyIiwidHlwZSIsImxvYWRpbmdfY2xhc3MiLCJoYXNDbGFzcyIsImFkZENsYXNzIiwiYWpheCIsInVybCIsImpja193b29zb2NpYWxfdmFycyIsImFqYXhfdXJsIiwiZGF0YVR5cGUiLCJjcm9zc0RvbWFpbiIsImRhdGEiLCJhY3Rpb24iLCJub25jZSIsInN1Y2Nlc3MiLCJ0ZXh0IiwiYnV0dG9uIiwicmVtb3ZlQ2xhc3MiLCJhZGRfZm9sbG93X2h0bWwiLCJwcmVwZW5kIiwiZXJyb3IiLCIkY3VycmVudF9saWtlc19saXN0IiwiY2xvc2VzdCIsInByb2R1Y3RfaWQiLCIkY291bnQiLCJmaW5kIiwiJGljb24iLCJsZW5ndGgiLCJjb3VudCIsInBhcnNlSW50IiwibmV3X2NvdW50IiwiYWRkX2xpa2VfaHRtbCIsImFmdGVyIiwicmVtb3ZlX2xpa2VfY2xhc3MiLCJyZW1vdmUiLCJ0YXJnZXQiLCJhY3RpdmVfY2xhc3MiLCJoaWRlIiwic2hvdyIsInNwaW5faWNvbl9zdGFydCIsInNwaW5faWNvbl9zdG9wIiwiZGlzYWJsZV9sb2FkX21vcmVfYnV0dG9uIiwiaHRtbCIsInN0cmluZ3MiLCJub19tb3JlIiwicmVtb3ZlQXR0ciIsIiRsb2FkX21vcmVfYnV0dG9uIiwiJGxvYWRfbW9yZV9pY29uIiwibG9hZF9tb3JlX2FjdGl2aXR5IiwibG9hZF9tb3JlX2xpa2VzIiwibG9hZF9tb3JlX2ZvbGxvd2VycyIsImxvYWRfbW9yZV9mb2xsb3dpbmciLCJjYWxsYmFjayIsImxpbWl0Iiwib2Zmc2V0IiwibmV4dF9vZmZzZXQiLCJwcm9maWxlX3VzZXJfaWQiLCIkbG9hZF9tb3JlX2l0ZW0iLCJhY3Rpdml0eV9odG1sIiwiYmVmb3JlIiwidW5kZWZpbmVkIiwibGlrZXNfaHRtbCIsImFwcGVuZCIsImNvbnNvbGUiLCJsb2ciLCJmb2xsb3dlcnNfaHRtbCIsImZvbGxvd2luZ19odG1sIiwiYnV0dG9uX3RleHQiLCJlIiwiZnJhZ21lbnRzIiwiY2FydF9oYXNoIiwiJHdvb3NvY2lhbF9idXR0b25fd3JhcHBlciIsInNldFRpbWVvdXQiLCJlYWNoIiwiaW5kZXgiLCJlbGVtZW50IiwiJGVsZW1lbnQiLCJicmVha3BvaW50c19hcnJheSIsInBhcnNlSlNPTiIsImJyZWFrcG9pbnRfb2JqZWN0Iiwid2lkdGgiLCJwdXNoIiwiZXZlbnQiLCJ1cGRhdGVfYnJlYWtwb2ludHMiLCJwcmV2aW91c193aWR0aCIsImN1cnJlbnRfd2lkdGgiLCJ0cmlnZ2VyIiwiY3VycmVudF9icmVha3BvaW50IiwiYnJlYWtwb2ludF9kYXRhIiwibWF4X3dpZHRoIiwiaG92ZXJJbnRlbnQiLCIkY2FyZCIsInJlYWR5Iiwid2luZG93IiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUVBLEdBQUFDLElBRUFDLE1BQUEsV0FDQUQsRUFBQUUsT0FDQUYsRUFBQUcsUUFFQUgsRUFBQUcsS0FBQUMsZ0JBQUEsMkJBQ0FKLEVBQUFHLEtBQUFFLG1CQUFBLHFCQUNBTCxFQUFBRyxLQUFBRywwQkFBQSx5REFDQU4sRUFBQUcsS0FBQUksc0JBQUEsK0NBQ0FQLEVBQUFHLEtBQUFLLGlCQUFBLDRCQUVBUixFQUFBRSxJQUFBTyxjQUFBWCxFQUFBQyxFQUFBVyxNQUNBVixFQUFBRSxJQUFBUyxhQUFBYixFQUFBLDBCQUNBRSxFQUFBRSxJQUFBVSxVQUFBZCxFQUFBLCtCQUNBRSxFQUFBRSxJQUFBVyxZQUFBZixFQUFBLDhCQUNBRSxFQUFBRSxJQUFBWSxpQkFBQWhCLEVBQUEsNEJBQ0FFLEVBQUFFLElBQUFhLGNBQUFqQixFQUFBLHlCQUNBRSxFQUFBRSxJQUFBYyxnQkFBQWxCLEVBQUEsNkJBQ0FFLEVBQUFFLElBQUFlLG9CQUFBbkIsRUFBQSw0QkFDQUUsRUFBQUUsSUFBQWdCLG9CQUFBcEIsRUFBQSw0QkFDQUUsRUFBQUUsSUFBQWlCLG9CQUFBckIsRUFBQSwwREFDQUUsRUFBQUUsSUFBQWtCLFVBQUF0QixFQUFBLHlDQUNBRSxFQUFBRSxJQUFBbUIsYUFBQXZCLEVBQUEsK0RBQ0FFLEVBQUFFLElBQUFvQixXQUFBeEIsRUFBQSw0QkFDQUUsRUFBQUUsSUFBQXFCLG9CQUFBekIsRUFBQSxzQkFDQUUsRUFBQUUsSUFBQXNCLGdCQUlBQyxTQUFBLFdBRUF6QixFQUFBQyxRQUNBRCxFQUFBMEIsdUJBQ0ExQixFQUFBMkIsNEJBQ0EzQixFQUFBNEIsYUFDQTVCLEVBQUE2QixrQkFDQTdCLEVBQUE4QixjQUNBOUIsRUFBQStCLG9CQUNBL0IsRUFBQWdDLG9CQUNBaEMsRUFBQWlDLGVBSUFDLFVBQUEsYUFJQUMsVUFBQSxXQUVBbkMsRUFBQWdDLHFCQUlBTixxQkFBQSxXQUVBNUIsRUFBQSxnQ0FBQXNDLEdBQUEsUUFBQSxXQUVBLEdBQUFDLEdBQUF2QyxFQUFBd0MsTUFDQUMsRUFBQUYsRUFBQUcsS0FBQSxnQkFDQUMsRUFBQUosRUFBQUcsS0FBQSxhQUNBRSxFQUFBLHNDQUVBLFdBQUFELElBRUFKLEVBQUFNLFNBQUFELEtBRUFMLEVBQUFPLFNBQUFGLEdBRUE1QyxFQUFBK0MsTUFDQUosS0FBQSxNQUNBSyxJQUFBQyxtQkFBQUMsU0FDQS9DLE9BQUEsRUFDQWdELFNBQUEsUUFDQUMsYUFBQSxFQUNBQyxNQUNBQyxPQUFBLDhCQUNBQyxNQUFBTixtQkFBQU0sTUFDQWQsUUFBQUEsRUFDQUUsS0FBQUEsR0FHQWEsUUFBQSxTQUFBSCxHQUVBZCxFQUFBa0IsS0FBQUosRUFBQUssT0FBQUQsTUFDQWxCLEVBQUFHLEtBQUEsWUFBQVcsRUFBQUssT0FBQWYsTUFFQUosRUFBQW9CLFlBQUFmLEdBQ0FMLEVBQUFvQixZQUFBLGdDQUFBaEIsR0FDQUosRUFBQU8sU0FBQSxnQ0FBQU8sRUFBQUssT0FBQWYsTUFFQVUsRUFBQU8saUJBQ0ExRCxFQUFBRSxJQUFBUyxhQUFBZ0QsUUFBQVIsRUFBQU8sa0JBSUFFLE1BQUEsU0FBQVQsWUFhQXhCLDBCQUFBLFdBRUE3QixFQUFBQyxHQUFBcUMsR0FBQSxRQUFBLHFDQUFBLFdBRUEsQ0FBQSxHQUFBQyxHQUFBdkMsRUFBQXdDLE1BQ0F1QixFQUFBeEIsRUFBQXlCLFFBQUEsZ0NBQ0FDLEVBQUExQixFQUFBRyxLQUFBLG1CQUNBQyxFQUFBSixFQUFBRyxLQUFBLGFBQ0F3QixFQUFBM0IsRUFBQTRCLEtBQUEsNkNBQ0F2QixFQUFBLDZDQUNBd0IsRUFBQTdCLEVBQUE0QixLQUFBLElBQ0E1QixHQUFBeUIsUUFBQSx5QkFFQSxNQUFBLFVBQUFyQixHQUVBSixFQUFBTSxTQUFBRCxLQUVBTCxFQUFBTyxTQUFBRixHQUVBNUMsRUFBQStDLE1BQ0FKLEtBQUEsTUFDQUssSUFBQUMsbUJBQUFDLFNBQ0EvQyxPQUFBLEVBQ0FnRCxTQUFBLFFBQ0FDLGFBQUEsRUFDQUMsTUFDQUMsT0FBQSxvQ0FDQUMsTUFBQU4sbUJBQUFNLE1BQ0FVLFdBQUFBLEVBQ0F0QixLQUFBQSxHQUdBYSxRQUFBLFNBQUFILEdBRUEsR0FBQWEsRUFBQUcsT0FBQSxFQUFBLENBRUEsR0FBQUMsR0FBQUMsU0FBQUwsRUFBQVQsUUFDQWUsRUFBQSxTQUFBN0IsRUFBQTJCLEVBQUEsRUFBQUEsRUFBQSxDQUVBSixHQUFBVCxLQUFBZSxHQUNBakMsRUFBQUcsS0FBQSxZQUFBVyxFQUFBSyxPQUFBZixNQUVBSixFQUFBb0IsWUFBQWYsR0FFQUwsRUFBQW9CLFlBQUEsc0NBQUFoQixHQUNBSixFQUFBTyxTQUFBLHNDQUFBTyxFQUFBSyxPQUFBZixNQUVBLFdBQUFVLEVBQUFLLE9BQUFmLEtBQ0F5QixFQUFBMUIsS0FBQSxRQUFBLCtCQUVBMEIsRUFBQTFCLEtBQUEsUUFBQSwwQkFHQVcsRUFBQW9CLGVBQ0FWLEVBQUFJLEtBQUEsbURBQUFPLE1BQUFyQixFQUFBb0IsZUFHQXBCLEVBQUFzQixtQkFDQVosRUFBQUksS0FBQWQsRUFBQXNCLG1CQUFBQyxXQU1BZCxNQUFBLFNBQUFULFNBT0EsR0ExREEsVUFrRUF2QixXQUFBLFdBRUE1QixFQUFBRSxJQUFBVSxVQUFBd0IsR0FBQSxRQUFBLFdBRUEsR0FBQXVDLEdBQUE3RSxFQUFBd0MsTUFBQUUsS0FBQSxRQUNBb0MsRUFBQSxvQ0FTQSxPQVBBNUUsR0FBQUUsSUFBQVUsVUFBQTZDLFlBQUFtQixHQUNBOUUsRUFBQXdDLE1BQUFNLFNBQUFnQyxHQUNBNUUsRUFBQUUsSUFBQVcsWUFBQWdFLE9BQ0EvRSxFQUFBNkUsR0FBQUcsT0FFQTlFLEVBQUFnQyxxQkFFQSxLQU1BK0MsZ0JBQUEsU0FBQWIsR0FFQUEsRUFBQXRCLFNBQUE1QyxFQUFBRyxLQUFBRSxxQkFJQTJFLGVBQUEsU0FBQWQsR0FFQUEsRUFBQVQsWUFBQXpELEVBQUFHLEtBQUFFLHFCQUlBNEUseUJBQUEsU0FBQTVDLEdBRUFBLEVBQ0E2QyxLQUFBbkMsbUJBQUFvQyxRQUFBQyxTQUNBQyxXQUFBLFFBQ0F6QyxTQUFBLHNDQUlBZixnQkFBQSxXQUVBN0IsRUFBQUUsSUFBQVksaUJBQUFzQixHQUFBLFFBQUEsV0FFQSxHQUFBa0QsR0FBQXhGLEVBQUF3QyxNQUNBaUQsRUFBQUQsRUFBQXJCLEtBQUEsSUFFQSxPQUFBcUIsR0FBQTNDLFNBQUEsc0NBQ0EsR0FHQTNDLEVBQUErRSxnQkFBQVEsR0FFQXpGLEVBQUF3QyxNQUFBSyxTQUFBLHNDQUVBM0MsRUFBQXdGLG1CQUFBMUYsRUFBQXdDLE1BQUEsV0FFQXRDLEVBQUFnRixlQUFBTyxLQU1BekYsRUFBQXdDLE1BQUFLLFNBQUEsbUNBRUEzQyxFQUFBeUYsZ0JBQUEzRixFQUFBd0MsTUFBQSxXQUVBdEMsRUFBQWdGLGVBQUFPLEtBTUF6RixFQUFBd0MsTUFBQUssU0FBQSx1Q0FFQTNDLEVBQUEwRixvQkFBQTVGLEVBQUF3QyxNQUFBLFdBRUF0QyxFQUFBZ0YsZUFBQU8sVUFNQXpGLEVBQUF3QyxNQUFBSyxTQUFBLHVDQUVBM0MsRUFBQTJGLG9CQUFBN0YsRUFBQXdDLE1BQUEsV0FFQXRDLEVBQUFnRixlQUFBTyxVQVVBQyxtQkFBQSxTQUFBRixFQUFBTSxHQUVBLEdBQUFDLEdBQUF4QixTQUFBaUIsRUFBQTlDLEtBQUEsZUFDQXNELEVBQUF6QixTQUFBaUIsRUFBQTlDLEtBQUEsZ0JBQ0F1RCxFQUFBRixFQUFBQyxFQUNBdkQsRUFBQStDLEVBQUE5QyxLQUFBLGdCQUNBd0QsRUFBQVYsRUFBQTlDLEtBQUEsd0JBQ0F5RCxFQUFBWCxFQUFBeEIsUUFBQSxLQUVBaEUsR0FBQStDLE1BQ0FKLEtBQUEsTUFDQUssSUFBQUMsbUJBQUFDLFNBQ0EvQyxPQUFBLEVBQ0FnRCxTQUFBLFFBQ0FDLGFBQUEsRUFDQUMsTUFDQUMsT0FBQSxtQ0FDQUMsTUFBQU4sbUJBQUFNLE1BQ0F3QyxNQUFBQSxFQUNBQyxPQUFBQSxFQUNBdkQsUUFBQUEsRUFDQXlELGdCQUFBQSxHQUdBMUMsUUFBQSxTQUFBSCxHQUVBQSxFQUFBK0MsZUFFQUQsRUFBQUUsT0FBQWhELEVBQUErQyxlQUNBWixFQUFBOUMsS0FBQSxjQUFBdUQsSUFJQS9GLEVBQUFpRix5QkFBQUssR0FJQWMsU0FBQVIsR0FDQUEsRUFBQXpDLElBS0FTLE1BQUEsU0FBQVQsUUFPQXNDLGdCQUFBLFNBQUFILEVBQUFNLEdBRUEsR0FBQUMsR0FBQXhCLFNBQUFpQixFQUFBOUMsS0FBQSxlQUNBc0QsRUFBQXpCLFNBQUFpQixFQUFBOUMsS0FBQSxnQkFDQXVELEVBQUFGLEVBQUFDLEVBQ0F2RCxFQUFBK0MsRUFBQTlDLEtBQUEsZUFFQTFDLEdBQUErQyxNQUNBSixLQUFBLE1BQ0FLLElBQUFDLG1CQUFBQyxTQUNBL0MsT0FBQSxFQUNBZ0QsU0FBQSxRQUNBQyxhQUFBLEVBQ0FDLE1BQ0FDLE9BQUEsZ0NBQ0FDLE1BQUFOLG1CQUFBTSxNQUNBd0MsTUFBQUEsRUFDQUMsT0FBQUEsRUFDQXZELFFBQUFBLEdBR0FlLFFBQUEsU0FBQUgsR0FFQUEsRUFBQWtELFlBRUFyRyxFQUFBRSxJQUFBYyxnQkFBQXNGLE9BQUFuRCxFQUFBa0QsWUFDQWYsRUFBQTlDLEtBQUEsY0FBQXVELElBSUEvRixFQUFBaUYseUJBQUFLLEdBSUFjLFNBQUFSLEdBQ0FBLEVBQUF6QyxJQUtBUyxNQUFBLFNBQUFULFFBT0F1QyxvQkFBQSxTQUFBSixFQUFBTSxHQUdBLEdBQUFDLEdBQUF4QixTQUFBaUIsRUFBQTlDLEtBQUEsZUFDQXNELEVBQUF6QixTQUFBaUIsRUFBQTlDLEtBQUEsZ0JBQ0F1RCxFQUFBRixFQUFBQyxFQUNBdkQsRUFBQStDLEVBQUE5QyxLQUFBLGVBRUExQyxHQUFBK0MsTUFDQUosS0FBQSxNQUNBSyxJQUFBQyxtQkFBQUMsU0FDQS9DLE9BQUEsRUFDQWdELFNBQUEsUUFDQUMsYUFBQSxFQUNBQyxNQUNBQyxPQUFBLG9DQUNBQyxNQUFBTixtQkFBQU0sTUFDQXdDLE1BQUFBLEVBQ0FDLE9BQUFBLEVBQ0F2RCxRQUFBQSxHQUdBZSxRQUFBLFNBQUFILEdBRUFvRCxRQUFBQyxJQUFBckQsR0FFQUEsRUFBQXNELGdCQUVBekcsRUFBQUUsSUFBQWdCLG9CQUFBb0YsT0FBQW5ELEVBQUFzRCxnQkFDQW5CLEVBQUE5QyxLQUFBLGNBQUF1RCxJQUlBL0YsRUFBQWlGLHlCQUFBSyxHQUlBYyxTQUFBUixHQUNBQSxFQUFBekMsSUFLQVMsTUFBQSxTQUFBVCxRQU9Bd0Msb0JBQUEsU0FBQUwsRUFBQU0sR0FFQSxHQUFBQyxHQUFBeEIsU0FBQWlCLEVBQUE5QyxLQUFBLGVBQ0FzRCxFQUFBekIsU0FBQWlCLEVBQUE5QyxLQUFBLGdCQUNBdUQsRUFBQUYsRUFBQUMsRUFDQXZELEVBQUErQyxFQUFBOUMsS0FBQSxlQUVBMUMsR0FBQStDLE1BQ0FKLEtBQUEsTUFDQUssSUFBQUMsbUJBQUFDLFNBQ0EvQyxPQUFBLEVBQ0FnRCxTQUFBLFFBQ0FDLGFBQUEsRUFDQUMsTUFDQUMsT0FBQSxvQ0FDQUMsTUFBQU4sbUJBQUFNLE1BQ0F3QyxNQUFBQSxFQUNBQyxPQUFBQSxFQUNBdkQsUUFBQUEsR0FHQWUsUUFBQSxTQUFBSCxHQUVBb0QsUUFBQUMsSUFBQXJELEdBRUFBLEVBQUF1RCxnQkFFQTFHLEVBQUFFLElBQUFlLG9CQUFBcUYsT0FBQW5ELEVBQUF1RCxnQkFDQXBCLEVBQUE5QyxLQUFBLGNBQUF1RCxJQUlBL0YsRUFBQWlGLHlCQUFBSyxHQUlBYyxTQUFBUixHQUNBQSxFQUFBekMsSUFLQVMsTUFBQSxTQUFBVCxRQU9BckIsWUFBQSxXQUVBOUIsRUFBQUUsSUFBQU8sY0FBQTJCLEdBQUEsUUFBQXBDLEVBQUFHLEtBQUFHLDBCQUFBLFdBRUEsR0FBQStCLEdBQUF2QyxFQUFBd0MsTUFDQXFFLEVBQUF0RSxFQUFBa0IsTUFFQWxCLEdBQ0FHLEtBQUEsbUJBQUFtRSxHQUNBTCxPQUFBdEcsRUFBQUUsSUFBQW1CLGdCQUlBckIsRUFBQUUsSUFBQU8sY0FBQTJCLEdBQUEsZ0JBQUEsU0FBQXdFLEVBQUFDLEVBQUFDLEVBQUF6RSxHQUVBLEdBQUEwRSxHQUFBMUUsRUFBQXlCLFFBQUEsc0NBQ0E2QyxFQUFBdEUsRUFBQUcsS0FBQSxtQkFFQXVFLEdBQUE1QyxPQUFBLElBRUE5QixFQUNBNkMsS0FBQXlCLEdBQ0FMLE9BQUF0RyxFQUFBRSxJQUFBa0IsV0FFQTRGLFdBQUEsV0FFQTNFLEVBQUE2QyxLQUFBeUIsSUFFQSxTQVFBNUUsa0JBQUEsV0FFQS9CLEVBQUFFLElBQUFxQixvQkFBQTRDLE9BQUEsR0FJQW5FLEVBQUFFLElBQUFxQixvQkFBQTBGLEtBQUEsU0FBQUMsRUFBQUMsR0FFQSxHQUFBQyxHQUFBdEgsRUFBQXFILEdBQ0EzRixFQUFBNEYsRUFBQTVFLEtBQUEsb0JBQ0E2RSxFQUFBdkgsRUFBQXdILFVBQUE5RixHQUNBK0YsR0FDQUosUUFBQUMsRUFDQTVGLFlBQUE2RixFQUNBRyxNQUFBLEVBR0F4SCxHQUFBRSxJQUFBc0IsWUFBQWlHLEtBQUFGLEtBUUF2SCxFQUFBRSxJQUFBTyxjQUFBMkIsR0FBQSx1QkFBQSxTQUFBc0YsRUFBQUgsR0FFQXZILEVBQUEySCxtQkFBQUosTUFNQXZGLGtCQUFBLFdBRUFoQyxFQUFBRSxJQUFBc0IsWUFBQTJDLE9BQUEsR0FFQXJFLEVBQUFtSCxLQUFBakgsRUFBQUUsSUFBQXNCLFlBQUEsU0FBQTBGLEVBQUFLLEdBRUEsR0FBQUssR0FBQUwsRUFBQUMsTUFDQUssRUFBQU4sRUFBQUosUUFBQUssT0FFQUssS0FBQUQsSUFFQUwsRUFBQUMsTUFBQUssRUFFQTdILEVBQUFFLElBQUFPLGNBQUFxSCxRQUFBLHdCQUFBUCxRQVVBSSxtQkFBQSxTQUFBSixHQUVBLEdBQUFRLElBQUEsQ0FJQWpJLEdBQUFtSCxLQUFBTSxFQUFBL0YsWUFBQSxTQUFBMEYsRUFBQWMsR0FFQVQsRUFBQUMsT0FBQVEsRUFBQUMsWUFFQUYsRUFJQUMsRUFBQUMsV0FBQUYsSUFFQUEsRUFBQUMsRUFBQUMsV0FKQUYsRUFBQUMsRUFBQUMsYUFjQW5JLEVBQUFtSCxLQUFBTSxFQUFBL0YsWUFBQSxTQUFBMEYsRUFBQWMsR0FFQUEsRUFBQUMsWUFBQUYsRUFFQVIsRUFBQUosUUFBQXZFLFNBQUFvRixFQUFBQSxVQUlBVCxFQUFBSixRQUFBMUQsWUFBQXVFLEVBQUFBLGFBUUEvRixZQUFBLFdBRUFqQyxFQUFBRSxJQUFBTyxjQUFBeUgsWUFFQSxXQUVBLEdBQUFDLEdBQUFySSxFQUFBd0MsS0FFQTZGLEdBQUF2RixTQUFBNUMsRUFBQUcsS0FBQUssbUJBSUEsV0FFQSxHQUFBMkgsR0FBQXJJLEVBQUF3QyxLQUVBNkYsR0FBQTFFLFlBQUF6RCxFQUFBRyxLQUFBSyxtQkFJQVIsRUFBQUcsS0FBQUksd0JBT0FULEdBQUFDLEdBQUFxSSxNQUFBcEksRUFBQXlCLFlBQ0EzQixFQUFBdUksUUFBQWpHLEdBQUEsU0FBQSxXQUFBcEMsRUFBQWtDLGNBQ0FwQyxFQUFBdUksUUFBQWpHLEdBQUEsU0FBQSxXQUFBcEMsRUFBQW1DLGVBRUFtRyxPQUFBdkkiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oJCwgZG9jdW1lbnQpIHtcbiAgICBcbiAgICB2YXIgamNrX3dvb3NvY2lhbCA9IHtcbiAgICAgICAgXG4gICAgICAgIGNhY2hlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzID0ge307XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnZhcnMgPSB7fTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC52YXJzLmlzX2hpZGRlbl9jbGFzcyA9IFwiamNrLXdvb3NvY2lhbC0taXMtaGlkZGVuXCI7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnZhcnMuYW5pbWF0ZV9zcGluX2NsYXNzID0gXCJqY2std29vc29jaWFsLXNwaW5cIjtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwudmFycy5hZGRfdG9fY2FydF9idXR0b25zX2NsYXNzID0gJy5qY2std29vc29jaWFsLWFkZC10by1jYXJ0LXdyYXBwZXIgLmFkZF90b19jYXJ0X2J1dHRvbic7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnZhcnMuY2FyZF9ncmlkX2NhcmRzX2NsYXNzID0gJy5qY2std29vc29jaWFsLWNhcmQtZ3JpZCAuamNrLXdvb3NvY2lhbC1jYXJkJztcbiAgICAgICAgICAgIGpja193b29zb2NpYWwudmFycy5jYXJkX2hvdmVyX2NsYXNzID0gJ2pjay13b29zb2NpYWwtY2FyZC0taG92ZXInO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5kb2N1bWVudF9ib2R5ID0gJChkb2N1bWVudC5ib2R5KTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmFjdGlvbnNfbGlzdCA9ICQoJy5qY2std29vc29jaWFsLWFjdGlvbnMnKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLnRhYl9saW5rcyA9ICQoJy5qY2std29vc29jaWFsLXByb2ZpbGUtbGluaycpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMudGFiX2NvbnRlbnQgPSAkKCcuamNrLXdvb3NvY2lhbC10YWItY29udGVudCcpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMubG9hZF9tb3JlX2J1dHRvbiA9ICQoJy5qY2std29vc29jaWFsLWxvYWQtbW9yZScpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuYWN0aW9uX2Jsb2NrcyA9ICQoJy5qY2std29vc29jaWFsLWFjdGlvbicpOyAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMubGlrZXNfY29udGFpbmVyID0gJCgnLmpjay13b29zb2NpYWwtdXNlci1saWtlcycpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuZm9sbG93aW5nX2NvbnRhaW5lciA9ICQoJy5qY2std29vc29jaWFsLWZvbGxvd2luZycpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuZm9sbG93ZXJzX2NvbnRhaW5lciA9ICQoJy5qY2std29vc29jaWFsLWZvbGxvd2VycycpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuYWRkX3RvX2NhcnRfYnV0dG9ucyA9ICQoJy5qY2std29vc29jaWFsLWFkZC10by1jYXJ0LXdyYXBwZXIgLmFkZF90b19jYXJ0X2J1dHRvbicpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMudGlja19pY29uID0gJCgnPGkgY2xhc3M9XCJqY2std29vc29jaWFsLWljLXRpY2tcIj48L2k+Jyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5sb2FkaW5nX2ljb24gPSAkKCc8aSBjbGFzcz1cImpjay13b29zb2NpYWwtaWMtbG9hZGluZyBqY2std29vc29jaWFsLXNwaW5cIj48L2k+Jyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5jYXJkX2dyaWRzID0gJCgnLmpjay13b29zb2NpYWwtY2FyZC1ncmlkJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5icmVha3BvaW50X2VsZW1lbnRzID0gJCgnW2RhdGEtYnJlYWtwb2ludHNdJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5icmVha3BvaW50cyA9IFtdO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gXG4gICAgICAgIG9uX3JlYWR5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5jYWNoZSgpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9mb2xsb3dfYWN0aW9ucygpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9wcm9kdWN0X2xpa2VfYWN0aW9uKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX3RhYnMoKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuc2V0dXBfbG9hZF9tb3JlKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmFkZF90b19jYXJ0KCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX2JyZWFrcG9pbnRzKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmNoZWNrX2JyZWFrcG9pbnRzKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX2NhcmRzKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIG9uX3Njcm9sbDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIG9uX3Jlc2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuY2hlY2tfYnJlYWtwb2ludHMoKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICBcbiAgICAgICAgc2V0dXBfZm9sbG93X2FjdGlvbnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkKCcuamNrLXdvb3NvY2lhbC1mb2xsb3ctYWN0aW9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgJGJ1dHRvbiA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgIHVzZXJfaWQgPSAkYnV0dG9uLmF0dHIoJ2RhdGEtdXNlci1pZCcpLFxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gJGJ1dHRvbi5hdHRyKCdkYXRhLXR5cGUnKSxcbiAgICAgICAgICAgICAgICAgICAgbG9hZGluZ19jbGFzcyA9ICdqY2std29vc29jaWFsLWZvbGxvdy1hY3Rpb24tLWxvYWRpbmcnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKCB0eXBlICE9PSBcImxvZ2luXCIgKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmKCAhJGJ1dHRvbi5oYXNDbGFzcyhsb2FkaW5nX2NsYXNzKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgJGJ1dHRvbi5hZGRDbGFzcyhsb2FkaW5nX2NsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgXHRcdFx0XHR0eXBlOiAgICAgICAgXCJHRVRcIixcbiAgICAgICAgICAgIFx0XHRcdFx0dXJsOiAgICAgICAgIGpja193b29zb2NpYWxfdmFycy5hamF4X3VybCxcbiAgICAgICAgICAgIFx0XHRcdFx0Y2FjaGU6ICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgXHRcdFx0XHRkYXRhVHlwZTogICAgXCJqc29ucFwiLFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdGNyb3NzRG9tYWluOiB0cnVlLFxuICAgICAgICAgICAgXHRcdFx0XHRkYXRhOiB7XG4gICAgICAgICAgICBcdFx0XHRcdFx0YWN0aW9uOiAgJ2pja193b29zb2NpYWxfZm9sbG93X2FjdGlvbicsXG4gICAgICAgICAgICBcdFx0XHRcdFx0bm9uY2U6ICAgamNrX3dvb3NvY2lhbF92YXJzLm5vbmNlLFxuICAgICAgICAgICAgXHRcdFx0XHRcdHVzZXJfaWQ6IHVzZXJfaWQsXG4gICAgICAgICAgICBcdFx0XHRcdFx0dHlwZTogICAgdHlwZVxuICAgICAgICAgICAgXHRcdFx0XHR9LFxuICAgICAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi50ZXh0KGRhdGEuYnV0dG9uLnRleHQpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24uYXR0cignZGF0YS10eXBlJyxkYXRhLmJ1dHRvbi50eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLnJlbW92ZUNsYXNzKGxvYWRpbmdfY2xhc3MpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24ucmVtb3ZlQ2xhc3MoJ2pjay13b29zb2NpYWwtZm9sbG93LWFjdGlvbi0tJyt0eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLmFkZENsYXNzKCdqY2std29vc29jaWFsLWZvbGxvdy1hY3Rpb24tLScrZGF0YS5idXR0b24udHlwZSk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0aWYoZGF0YS5hZGRfZm9sbG93X2h0bWwpIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0amNrX3dvb3NvY2lhbC5lbHMuYWN0aW9uc19saXN0LnByZXBlbmQoZGF0YS5hZGRfZm9sbG93X2h0bWwpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdH1cbiAgICAgICAgICAgIFx0XHRcdFx0fSxcbiAgICAgICAgICAgIFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdGVycm9yOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHR9XG4gICAgICAgICAgICBcdFx0XHR9KTtcbiAgICAgICAgXHRcdFx0XG4gICAgICAgIFx0XHRcdH1cbiAgICBcdFx0XHRcbiAgICBcdFx0XHR9XG5cdFx0XHRcblx0XHRcdH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzZXR1cF9wcm9kdWN0X2xpa2VfYWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5qY2std29vc29jaWFsLXByb2R1Y3QtbGlrZS1hY3Rpb24nLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciAkYnV0dG9uID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgJGN1cnJlbnRfbGlrZXNfbGlzdCA9ICRidXR0b24uY2xvc2VzdCgnLmpjay13b29zb2NpYWwtcHJvZHVjdC1saWtlcycpLFxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X2lkID0gJGJ1dHRvbi5hdHRyKCdkYXRhLXByb2R1Y3QtaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICRidXR0b24uYXR0cignZGF0YS10eXBlJyksXG4gICAgICAgICAgICAgICAgICAgICRjb3VudCA9ICRidXR0b24uZmluZCgnLmpjay13b29zb2NpYWwtcHJvZHVjdC1saWtlLWJ1dHRvbl9fY291bnQnKSxcbiAgICAgICAgICAgICAgICAgICAgbG9hZGluZ19jbGFzcyA9ICdqY2std29vc29jaWFsLXByb2R1Y3QtbGlrZS1hY3Rpb24tLWxvYWRpbmcnLFxuICAgICAgICAgICAgICAgICAgICAkaWNvbiA9ICRidXR0b24uZmluZCgnaScpLFxuICAgICAgICAgICAgICAgICAgICAkYWN0aW9uID0gJGJ1dHRvbi5jbG9zZXN0KCcuamNrLXdvb3NvY2lhbC1hY3Rpb24nKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggdHlwZSAhPT0gXCJsb2dpblwiICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoICEkYnV0dG9uLmhhc0NsYXNzKGxvYWRpbmdfY2xhc3MpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgJGJ1dHRvbi5hZGRDbGFzcyhsb2FkaW5nX2NsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIFx0XHRcdFx0dHlwZTogXCJHRVRcIixcbiAgICAgICAgICAgIFx0XHRcdFx0dXJsOiBqY2tfd29vc29jaWFsX3ZhcnMuYWpheF91cmwsXG4gICAgICAgICAgICBcdFx0XHRcdGNhY2hlOiBmYWxzZSxcbiAgICAgICAgICAgIFx0XHRcdFx0ZGF0YVR5cGU6IFwianNvbnBcIixcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcbiAgICAgICAgICAgIFx0XHRcdFx0ZGF0YToge1xuICAgICAgICAgICAgXHRcdFx0XHRcdGFjdGlvbjogJ2pja193b29zb2NpYWxfcHJvZHVjdF9saWtlX2FjdGlvbicsXG4gICAgICAgICAgICBcdFx0XHRcdFx0bm9uY2U6IGpja193b29zb2NpYWxfdmFycy5ub25jZSxcbiAgICAgICAgICAgIFx0XHRcdFx0XHRwcm9kdWN0X2lkOiBwcm9kdWN0X2lkLFxuICAgICAgICAgICAgXHRcdFx0XHRcdHR5cGU6IHR5cGVcbiAgICAgICAgICAgIFx0XHRcdFx0fSxcbiAgICAgICAgICAgIFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdGlmKCAkY291bnQubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdHZhciBjb3VudCA9IHBhcnNlSW50KCRjb3VudC50ZXh0KCkpLFxuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQgICAgbmV3X2NvdW50ID0gdHlwZSA9PT0gXCJsaWtlXCIgPyBjb3VudCsxIDogY291bnQtMTtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdCRjb3VudC50ZXh0KCBuZXdfY291bnQgKTsgXG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24uYXR0cignZGF0YS10eXBlJywgZGF0YS5idXR0b24udHlwZSk7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLnJlbW92ZUNsYXNzKGxvYWRpbmdfY2xhc3MpO1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5yZW1vdmVDbGFzcygnamNrLXdvb3NvY2lhbC1wcm9kdWN0LWxpa2UtYWN0aW9uLS0nK3R5cGUpO1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLmFkZENsYXNzKCdqY2std29vc29jaWFsLXByb2R1Y3QtbGlrZS1hY3Rpb24tLScrZGF0YS5idXR0b24udHlwZSk7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHRpZiggZGF0YS5idXR0b24udHlwZSA9PT0gXCJ1bmxpa2VcIiApIHtcbiAgICAgICAgICAgICAgICAgICAgXHRcdFx0XHRcdCRpY29uLmF0dHIoJ2NsYXNzJywnamNrLXdvb3NvY2lhbC1pYy1oZWFydC1mdWxsJyk7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkaWNvbi5hdHRyKCdjbGFzcycsJ2pjay13b29zb2NpYWwtaWMtaGVhcnQnKTtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0fVxuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0aWYoZGF0YS5hZGRfbGlrZV9odG1sKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkY3VycmVudF9saWtlc19saXN0LmZpbmQoJy5qY2std29vc29jaWFsLXByb2R1Y3QtbGlrZXNfX2l0ZW0tLWxpa2UtYnV0dG9uJykuYWZ0ZXIoZGF0YS5hZGRfbGlrZV9odG1sKTtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0fVxuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0aWYoZGF0YS5yZW1vdmVfbGlrZV9jbGFzcykge1xuICAgICAgICAgICAgICAgICAgICBcdFx0XHRcdFx0JGN1cnJlbnRfbGlrZXNfbGlzdC5maW5kKGRhdGEucmVtb3ZlX2xpa2VfY2xhc3MpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHR9XHRcdFx0XHRcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0fVxuICAgICAgICAgICAgXHRcdFx0XHR9LFxuICAgICAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdH1cbiAgICAgICAgICAgIFx0XHRcdH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc2V0dXBfdGFiczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLnRhYl9saW5rcy5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKSxcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlX2NsYXNzID0gJ2pjay13b29zb2NpYWwtcHJvZmlsZS1saW5rLS1hY3RpdmUnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLnRhYl9saW5rcy5yZW1vdmVDbGFzcyhhY3RpdmVfY2xhc3MpO1xuICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoYWN0aXZlX2NsYXNzKTtcbiAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50YWJfY29udGVudC5oaWRlKCk7XG4gICAgICAgICAgICAgICAgJCh0YXJnZXQpLnNob3coKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmNoZWNrX2JyZWFrcG9pbnRzKCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNwaW5faWNvbl9zdGFydDogZnVuY3Rpb24oICRpY29uICl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICRpY29uLmFkZENsYXNzKCBqY2tfd29vc29jaWFsLnZhcnMuYW5pbWF0ZV9zcGluX2NsYXNzICk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNwaW5faWNvbl9zdG9wOiBmdW5jdGlvbiggJGljb24gKXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJGljb24ucmVtb3ZlQ2xhc3MoIGpja193b29zb2NpYWwudmFycy5hbmltYXRlX3NwaW5fY2xhc3MgKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgZGlzYWJsZV9sb2FkX21vcmVfYnV0dG9uOiBmdW5jdGlvbiggJGJ1dHRvbiApe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkYnV0dG9uXG4gICAgICAgICAgICAuaHRtbCggamNrX3dvb3NvY2lhbF92YXJzLnN0cmluZ3Mubm9fbW9yZSApXG4gICAgICAgICAgICAucmVtb3ZlQXR0cignaHJlZicpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoXCJqY2std29vc29jaWFsLWxvYWQtbW9yZS0tZGlzYWJsZWRcIik7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNldHVwX2xvYWRfbW9yZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmxvYWRfbW9yZV9idXR0b24ub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgJGxvYWRfbW9yZV9idXR0b24gPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICAkbG9hZF9tb3JlX2ljb24gPSAkbG9hZF9tb3JlX2J1dHRvbi5maW5kKCdpJyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKCAkbG9hZF9tb3JlX2J1dHRvbi5oYXNDbGFzcyhcImpjay13b29zb2NpYWwtbG9hZC1tb3JlLS1kaXNhYmxlZFwiKSApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLnNwaW5faWNvbl9zdGFydCggJGxvYWRfbW9yZV9pY29uICk7XG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggJCh0aGlzKS5oYXNDbGFzcygnamNrLXdvb3NvY2lhbC1sb2FkLW1vcmUtLWFjdGl2aXR5JykgKSB7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmxvYWRfbW9yZV9hY3Rpdml0eSggJCh0aGlzKSwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zcGluX2ljb25fc3RvcCggJGxvYWRfbW9yZV9pY29uICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKCAkKHRoaXMpLmhhc0NsYXNzKCdqY2std29vc29jaWFsLWxvYWQtbW9yZS0tbGlrZXMnKSApIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwubG9hZF9tb3JlX2xpa2VzKCAkKHRoaXMpLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLnNwaW5faWNvbl9zdG9wKCAkbG9hZF9tb3JlX2ljb24gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggJCh0aGlzKS5oYXNDbGFzcygnamNrLXdvb3NvY2lhbC1sb2FkLW1vcmUtLWZvbGxvd2VycycpICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5sb2FkX21vcmVfZm9sbG93ZXJzKCAkKHRoaXMpLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLnNwaW5faWNvbl9zdG9wKCAkbG9hZF9tb3JlX2ljb24gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggJCh0aGlzKS5oYXNDbGFzcygnamNrLXdvb3NvY2lhbC1sb2FkLW1vcmUtLWZvbGxvd2luZycpICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5sb2FkX21vcmVfZm9sbG93aW5nKCAkKHRoaXMpLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLnNwaW5faWNvbl9zdG9wKCAkbG9hZF9tb3JlX2ljb24gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBsb2FkX21vcmVfYWN0aXZpdHk6IGZ1bmN0aW9uKCAkbG9hZF9tb3JlX2J1dHRvbiwgY2FsbGJhY2sgKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBsaW1pdCA9IHBhcnNlSW50KCAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLWxpbWl0JykgKSxcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBwYXJzZUludCggJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1vZmZzZXQnKSApLFxuICAgICAgICAgICAgICAgIG5leHRfb2Zmc2V0ID0gbGltaXQrb2Zmc2V0LFxuICAgICAgICAgICAgICAgIHVzZXJfaWQgPSAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLXVzZXItaWQnKSxcbiAgICAgICAgICAgICAgICBwcm9maWxlX3VzZXJfaWQgPSAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLXByb2ZpbGUtdXNlci1pZCcpLFxuICAgICAgICAgICAgICAgICRsb2FkX21vcmVfaXRlbSA9ICRsb2FkX21vcmVfYnV0dG9uLmNsb3Nlc3QoJ2xpJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAkLmFqYXgoe1xuXHRcdFx0XHR0eXBlOiAgICAgICAgXCJHRVRcIixcblx0XHRcdFx0dXJsOiAgICAgICAgIGpja193b29zb2NpYWxfdmFycy5hamF4X3VybCxcblx0XHRcdFx0Y2FjaGU6ICAgICAgIGZhbHNlLFxuXHRcdFx0XHRkYXRhVHlwZTogICAgXCJqc29ucFwiLFx0XHRcdFx0XG5cdFx0XHRcdGNyb3NzRG9tYWluOiB0cnVlLFxuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uOiAgICAgICAgICAnamNrX3dvb3NvY2lhbF9sb2FkX21vcmVfYWN0aXZpdHknLFxuXHRcdFx0XHRcdG5vbmNlOiAgICAgICAgICAgamNrX3dvb3NvY2lhbF92YXJzLm5vbmNlLFxuXHRcdFx0XHRcdGxpbWl0OiAgICAgICAgICAgbGltaXQsXG5cdFx0XHRcdFx0b2Zmc2V0OiAgICAgICAgICBvZmZzZXQsXG5cdFx0XHRcdFx0dXNlcl9pZDogICAgICAgICB1c2VyX2lkLFxuXHRcdFx0XHRcdHByb2ZpbGVfdXNlcl9pZDogcHJvZmlsZV91c2VyX2lkXG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiggZGF0YS5hY3Rpdml0eV9odG1sICkge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0JGxvYWRfbW9yZV9pdGVtLmJlZm9yZSggZGF0YS5hY3Rpdml0eV9odG1sICk7XG4gICAgXHRcdFx0XHRcdCRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtb2Zmc2V0JywgbmV4dF9vZmZzZXQpIDtcbiAgICBcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fSBlbHNlIHtcbiAgICBcdFx0XHRcdFx0XG4gICAgXHRcdFx0XHRcdGpja193b29zb2NpYWwuZGlzYWJsZV9sb2FkX21vcmVfYnV0dG9uKCAkbG9hZF9tb3JlX2J1dHRvbiApO1xuICAgIFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoY2FsbGJhY2sgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgXHRcdFx0Y2FsbGJhY2soZGF0YSk7XG4gICAgICAgICAgICBcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgIFx0XHRcdFx0XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBsb2FkX21vcmVfbGlrZXM6IGZ1bmN0aW9uKCAkbG9hZF9tb3JlX2J1dHRvbiwgY2FsbGJhY2sgKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBsaW1pdCA9IHBhcnNlSW50KCAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLWxpbWl0JykgKSxcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBwYXJzZUludCggJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1vZmZzZXQnKSApLFxuICAgICAgICAgICAgICAgIG5leHRfb2Zmc2V0ID0gbGltaXQrb2Zmc2V0LFxuICAgICAgICAgICAgICAgIHVzZXJfaWQgPSAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLXVzZXItaWQnKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICQuYWpheCh7XG5cdFx0XHRcdHR5cGU6ICAgICAgICBcIkdFVFwiLFxuXHRcdFx0XHR1cmw6ICAgICAgICAgamNrX3dvb3NvY2lhbF92YXJzLmFqYXhfdXJsLFxuXHRcdFx0XHRjYWNoZTogICAgICAgZmFsc2UsXG5cdFx0XHRcdGRhdGFUeXBlOiAgICBcImpzb25wXCIsXHRcdFx0XHRcblx0XHRcdFx0Y3Jvc3NEb21haW46IHRydWUsXG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRhY3Rpb246ICAnamNrX3dvb3NvY2lhbF9sb2FkX21vcmVfbGlrZXMnLFxuXHRcdFx0XHRcdG5vbmNlOiAgIGpja193b29zb2NpYWxfdmFycy5ub25jZSxcblx0XHRcdFx0XHRsaW1pdDogICBsaW1pdCxcblx0XHRcdFx0XHRvZmZzZXQ6ICBvZmZzZXQsXG5cdFx0XHRcdFx0dXNlcl9pZDogdXNlcl9pZFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIGRhdGEgKSB7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoIGRhdGEubGlrZXNfaHRtbCApIHtcbiAgICBcdFx0XHRcdFx0XG4gICAgXHRcdFx0XHRcdGpja193b29zb2NpYWwuZWxzLmxpa2VzX2NvbnRhaW5lci5hcHBlbmQoIGRhdGEubGlrZXNfaHRtbCApO1xuICAgIFx0XHRcdFx0XHQkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLW9mZnNldCcsIG5leHRfb2Zmc2V0KSA7XG4gICAgXHRcdFx0XHRcdFxuXHRcdFx0XHRcdH0gZWxzZSB7XG4gICAgXHRcdFx0XHRcdFxuICAgIFx0XHRcdFx0XHRqY2tfd29vc29jaWFsLmRpc2FibGVfbG9hZF9tb3JlX2J1dHRvbiggJGxvYWRfbW9yZV9idXR0b24gKTtcbiAgICBcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKGNhbGxiYWNrICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIFx0XHRcdGNhbGxiYWNrKGRhdGEpO1xuICAgICAgICAgICAgXHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0fSxcblx0XHRcdFx0XG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICBcdFx0XHRcdFxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgbG9hZF9tb3JlX2ZvbGxvd2VyczogZnVuY3Rpb24oICRsb2FkX21vcmVfYnV0dG9uLCBjYWxsYmFjayApIHtcbiAgICAgICAgXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBsaW1pdCA9IHBhcnNlSW50KCAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLWxpbWl0JykgKSxcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBwYXJzZUludCggJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1vZmZzZXQnKSApLFxuICAgICAgICAgICAgICAgIG5leHRfb2Zmc2V0ID0gbGltaXQrb2Zmc2V0LFxuICAgICAgICAgICAgICAgIHVzZXJfaWQgPSAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLXVzZXItaWQnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJC5hamF4KHtcblx0XHRcdFx0dHlwZTogICAgICAgIFwiR0VUXCIsXG5cdFx0XHRcdHVybDogICAgICAgICBqY2tfd29vc29jaWFsX3ZhcnMuYWpheF91cmwsXG5cdFx0XHRcdGNhY2hlOiAgICAgICBmYWxzZSxcblx0XHRcdFx0ZGF0YVR5cGU6ICAgIFwianNvbnBcIixcdFx0XHRcdFxuXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcblx0XHRcdFx0ZGF0YToge1xuXHRcdFx0XHRcdGFjdGlvbjogICdqY2tfd29vc29jaWFsX2xvYWRfbW9yZV9mb2xsb3dlcnMnLFxuXHRcdFx0XHRcdG5vbmNlOiAgIGpja193b29zb2NpYWxfdmFycy5ub25jZSxcblx0XHRcdFx0XHRsaW1pdDogICBsaW1pdCxcblx0XHRcdFx0XHRvZmZzZXQ6ICBvZmZzZXQsXG5cdFx0XHRcdFx0dXNlcl9pZDogdXNlcl9pZFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgXHRcdFx0XHRcbiAgICBcdFx0XHRcdGNvbnNvbGUubG9nKGRhdGEpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKCBkYXRhLmZvbGxvd2Vyc19odG1sICkge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0amNrX3dvb3NvY2lhbC5lbHMuZm9sbG93ZXJzX2NvbnRhaW5lci5hcHBlbmQoIGRhdGEuZm9sbG93ZXJzX2h0bWwgKTtcbiAgICBcdFx0XHRcdFx0JGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1vZmZzZXQnLCBuZXh0X29mZnNldCkgO1xuICAgIFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9IGVsc2Uge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0amNrX3dvb3NvY2lhbC5kaXNhYmxlX2xvYWRfbW9yZV9idXR0b24oICRsb2FkX21vcmVfYnV0dG9uICk7XG4gICAgXHRcdFx0XHRcdFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihjYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBcdFx0XHRjYWxsYmFjayhkYXRhKTtcbiAgICAgICAgICAgIFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgXHRcdFx0XHRcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG4gICAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgbG9hZF9tb3JlX2ZvbGxvd2luZzogZnVuY3Rpb24oICRsb2FkX21vcmVfYnV0dG9uLCBjYWxsYmFjayApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGxpbWl0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtbGltaXQnKSApLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHBhcnNlSW50KCAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLW9mZnNldCcpICksXG4gICAgICAgICAgICAgICAgbmV4dF9vZmZzZXQgPSBsaW1pdCtvZmZzZXQsXG4gICAgICAgICAgICAgICAgdXNlcl9pZCA9ICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtdXNlci1pZCcpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkLmFqYXgoe1xuXHRcdFx0XHR0eXBlOiAgICAgICAgXCJHRVRcIixcblx0XHRcdFx0dXJsOiAgICAgICAgIGpja193b29zb2NpYWxfdmFycy5hamF4X3VybCxcblx0XHRcdFx0Y2FjaGU6ICAgICAgIGZhbHNlLFxuXHRcdFx0XHRkYXRhVHlwZTogICAgXCJqc29ucFwiLFx0XHRcdFx0XG5cdFx0XHRcdGNyb3NzRG9tYWluOiB0cnVlLFxuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uOiAgJ2pja193b29zb2NpYWxfbG9hZF9tb3JlX2ZvbGxvd2luZycsXG5cdFx0XHRcdFx0bm9uY2U6ICAgamNrX3dvb3NvY2lhbF92YXJzLm5vbmNlLFxuXHRcdFx0XHRcdGxpbWl0OiAgIGxpbWl0LFxuXHRcdFx0XHRcdG9mZnNldDogIG9mZnNldCxcblx0XHRcdFx0XHR1c2VyX2lkOiB1c2VyX2lkXG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICBcdFx0XHRcdFxuICAgIFx0XHRcdFx0Y29uc29sZS5sb2coZGF0YSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoIGRhdGEuZm9sbG93aW5nX2h0bWwgKSB7XG4gICAgXHRcdFx0XHRcdFxuICAgIFx0XHRcdFx0XHRqY2tfd29vc29jaWFsLmVscy5mb2xsb3dpbmdfY29udGFpbmVyLmFwcGVuZCggZGF0YS5mb2xsb3dpbmdfaHRtbCApO1xuICAgIFx0XHRcdFx0XHQkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLW9mZnNldCcsIG5leHRfb2Zmc2V0KSA7XG4gICAgXHRcdFx0XHRcdFxuXHRcdFx0XHRcdH0gZWxzZSB7XG4gICAgXHRcdFx0XHRcdFxuICAgIFx0XHRcdFx0XHRqY2tfd29vc29jaWFsLmRpc2FibGVfbG9hZF9tb3JlX2J1dHRvbiggJGxvYWRfbW9yZV9idXR0b24gKTtcbiAgICBcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKGNhbGxiYWNrICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIFx0XHRcdGNhbGxiYWNrKGRhdGEpO1xuICAgICAgICAgICAgXHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0fSxcblx0XHRcdFx0XG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICBcdFx0XHRcdFxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgIFx0XG4gICAgXHRhZGRfdG9fY2FydDogZnVuY3Rpb24oKSB7XG4gICAgICAgIFx0XG4gICAgICAgIFx0amNrX3dvb3NvY2lhbC5lbHMuZG9jdW1lbnRfYm9keS5vbignY2xpY2snLCBqY2tfd29vc29jaWFsLnZhcnMuYWRkX3RvX2NhcnRfYnV0dG9uc19jbGFzcywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIFx0XG4gICAgICAgICAgICBcdHZhciAkYnV0dG9uID0gJCh0aGlzKSxcbiAgICAgICAgICAgIFx0ICAgIGJ1dHRvbl90ZXh0ID0gJGJ1dHRvbi50ZXh0KCk7XG4gICAgICAgICAgICBcdCAgICBcbiAgICAgICAgICAgICAgICAkYnV0dG9uXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2RhdGEtYnV0dG9uLXRleHQnLGJ1dHRvbl90ZXh0KVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoIGpja193b29zb2NpYWwuZWxzLmxvYWRpbmdfaWNvbiApO1xuICAgICAgICAgICAgXHRcbiAgICAgICAgXHR9KTtcbiAgICAgICAgXHRcbiAgICAgICAgXHRqY2tfd29vc29jaWFsLmVscy5kb2N1bWVudF9ib2R5Lm9uKCAnYWRkZWRfdG9fY2FydCcsIGZ1bmN0aW9uKCBlLCBmcmFnbWVudHMsIGNhcnRfaGFzaCwgJGJ1dHRvbiApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciAkd29vc29jaWFsX2J1dHRvbl93cmFwcGVyID0gJGJ1dHRvbi5jbG9zZXN0KCcuamNrLXdvb3NvY2lhbC1hZGQtdG8tY2FydC13cmFwcGVyJyksXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbl90ZXh0ID0gJGJ1dHRvbi5hdHRyKCdkYXRhLWJ1dHRvbi10ZXh0Jyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICR3b29zb2NpYWxfYnV0dG9uX3dyYXBwZXIubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICRidXR0b25cbiAgICAgICAgICAgICAgICAgICAgLmh0bWwoIGJ1dHRvbl90ZXh0ICkgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoIGpja193b29zb2NpYWwuZWxzLnRpY2tfaWNvbiApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAkYnV0dG9uLmh0bWwoIGJ1dHRvbl90ZXh0ICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFx0XG4gICAgICAgIFx0fSk7XG4gICAgICAgIFx0XG4gICAgXHR9LFxuICAgIFx0XG4gICAgICAgIHNldHVwX2JyZWFrcG9pbnRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYoIGpja193b29zb2NpYWwuZWxzLmJyZWFrcG9pbnRfZWxlbWVudHMubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBzdG9yZSBicmVha3BvaW50IGRhdGEgaW4gY2FjaGUgZm9yIGZ1dHVyZSByZWZlcmVuY2VcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmJyZWFrcG9pbnRfZWxlbWVudHMuZWFjaChmdW5jdGlvbiggaW5kZXgsIGVsZW1lbnQgKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyICRlbGVtZW50ID0gJChlbGVtZW50KSxcbiAgICAgICAgICAgICAgICBcdCAgICBicmVha3BvaW50cyA9ICRlbGVtZW50LmF0dHIoJ2RhdGEtYnJlYWtwb2ludHMnKSxcbiAgICAgICAgICAgICAgICBcdCAgICBicmVha3BvaW50c19hcnJheSA9ICQucGFyc2VKU09OKCBicmVha3BvaW50cyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtwb2ludF9vYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcdGVsZW1lbnQ6ICRlbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnRzOiBicmVha3BvaW50c19hcnJheSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmJyZWFrcG9pbnRzLnB1c2goIGJyZWFrcG9pbnRfb2JqZWN0ICk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIHdoZW4gYW4gZWxlbWVudCB3aWR0aCBoYXMgY2hhbmdlZCwgdHJpZ2dlciBicmVha3BvaW50IHVwZGF0ZVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5kb2N1bWVudF9ib2R5Lm9uKCdlbGVtZW50X3dpZHRoX2NoYW5nZScsIGZ1bmN0aW9uKCBldmVudCwgYnJlYWtwb2ludF9vYmplY3QgKXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwudXBkYXRlX2JyZWFrcG9pbnRzKCBicmVha3BvaW50X29iamVjdCApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGNoZWNrX2JyZWFrcG9pbnRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgXG4gICAgICAgICAgICBpZiggamNrX3dvb3NvY2lhbC5lbHMuYnJlYWtwb2ludHMubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXHQkLmVhY2goamNrX3dvb3NvY2lhbC5lbHMuYnJlYWtwb2ludHMsIGZ1bmN0aW9uKGluZGV4LCBicmVha3BvaW50X29iamVjdCl7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgcHJldmlvdXNfd2lkdGggPSBicmVha3BvaW50X29iamVjdC53aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfd2lkdGggPSBicmVha3BvaW50X29iamVjdC5lbGVtZW50LndpZHRoKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiggY3VycmVudF93aWR0aCAhPT0gcHJldmlvdXNfd2lkdGggKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnRfb2JqZWN0LndpZHRoID0gY3VycmVudF93aWR0aDtcbiAgICAgICAgICAgICAgICAgICAgXHRcbiAgICAgICAgICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmRvY3VtZW50X2JvZHkudHJpZ2dlcignZWxlbWVudF93aWR0aF9jaGFuZ2UnLCBbYnJlYWtwb2ludF9vYmplY3RdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgfSxcblxuICAgIFx0dXBkYXRlX2JyZWFrcG9pbnRzOiBmdW5jdGlvbiggYnJlYWtwb2ludF9vYmplY3QgKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBjdXJyZW50X2JyZWFrcG9pbnQgPSBmYWxzZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gZmlndXJlIG91dCB3aGljaCBicmVha3BvaW50IGRhdGEgd2Ugd2FudCB0byB1c2VcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJC5lYWNoKCBicmVha3BvaW50X29iamVjdC5icmVha3BvaW50cywgZnVuY3Rpb24oIGluZGV4LCBicmVha3BvaW50X2RhdGEgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFx0XG4gICAgICAgICAgICAgICAgaWYoIGJyZWFrcG9pbnRfb2JqZWN0LndpZHRoIDw9IGJyZWFrcG9pbnRfZGF0YS5tYXhfd2lkdGggKSB7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiggISBjdXJyZW50X2JyZWFrcG9pbnQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfYnJlYWtwb2ludCA9IGJyZWFrcG9pbnRfZGF0YS5tYXhfd2lkdGg7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggYnJlYWtwb2ludF9kYXRhLm1heF93aWR0aCA8PSBjdXJyZW50X2JyZWFrcG9pbnQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfYnJlYWtwb2ludCA9IGJyZWFrcG9pbnRfZGF0YS5tYXhfd2lkdGg7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gbm93IHdlIGtub3cgdGhlIGJyZWFrcG9pbnQgdG8gdXNlLCBhcHBseSB0aGF0IGNsYXNzIGFuZCByZW1vdmUgdGhlIG90aGVyc1xuICAgICAgICAgICAgICAgICAgICBcdFxuICAgICAgICAgICAgJC5lYWNoKCBicmVha3BvaW50X29iamVjdC5icmVha3BvaW50cywgZnVuY3Rpb24oIGluZGV4LCBicmVha3BvaW50X2RhdGEgKXtcblxuICAgICAgICAgICAgICAgIGlmKCBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoID09PSBjdXJyZW50X2JyZWFrcG9pbnQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWtwb2ludF9vYmplY3QuZWxlbWVudC5hZGRDbGFzcyggYnJlYWtwb2ludF9kYXRhLmNsYXNzICk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnRfb2JqZWN0LmVsZW1lbnQucmVtb3ZlQ2xhc3MoIGJyZWFrcG9pbnRfZGF0YS5jbGFzcyApO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgXHRcbiAgICBcdH0sXG4gICAgXHRcbiAgICBcdHNldHVwX2NhcmRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgXHRcbiAgICAgICAgXHRqY2tfd29vc29jaWFsLmVscy5kb2N1bWVudF9ib2R5LmhvdmVySW50ZW50KCBcbiAgICAgICAgICAgIFx0XG4gICAgICAgIFx0ICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBcdCAgICBcbiAgICAgICAgICAgIFx0ICAgIHZhciAkY2FyZCA9ICQodGhpcyk7XG4gICAgICAgICAgICBcdCAgICBcbiAgICAgICAgICAgIFx0ICAgICRjYXJkLmFkZENsYXNzKCBqY2tfd29vc29jaWFsLnZhcnMuY2FyZF9ob3Zlcl9jbGFzcyApO1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgIFx0ICAgIH0sIFxuICAgICAgICBcdCAgICBcbiAgICAgICAgXHQgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIFx0ICAgIFxuICAgICAgICAgICAgXHQgICAgdmFyICRjYXJkID0gJCh0aGlzKTtcbiAgICAgICAgICAgIFx0ICAgIFxuICAgICAgICAgICAgXHQgICAgJGNhcmQucmVtb3ZlQ2xhc3MoIGpja193b29zb2NpYWwudmFycy5jYXJkX2hvdmVyX2NsYXNzICk7XG4gICAgICAgICAgICBcdCAgICBcbiAgICAgICAgXHQgICAgfSwgXG4gICAgICAgIFx0ICAgIFxuICAgICAgICBcdCAgICBqY2tfd29vc29jaWFsLnZhcnMuY2FyZF9ncmlkX2NhcmRzX2NsYXNzIFxuICAgICAgICAgICAgKTtcbiAgICAgICAgXHRcbiAgICBcdH1cbiAgICAgXG4gICAgfTtcbiAgICBcblx0JChkb2N1bWVudCkucmVhZHkoIGpja193b29zb2NpYWwub25fcmVhZHkoKSApO1x0XG5cdCQod2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7IGpja193b29zb2NpYWwub25fc2Nyb2xsKCk7IH0gKTtcblx0JCh3aW5kb3cpLm9uKCdyZXNpemUnLCBmdW5jdGlvbigpIHsgamNrX3dvb3NvY2lhbC5vbl9yZXNpemUoKTsgfSApO1xuXG59KGpRdWVyeSwgZG9jdW1lbnQpKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=