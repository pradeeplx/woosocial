!function(o,a){var t={cache:function(){t.els={},t.vars={},t.els.$actions_list=o(".jck-woosocial-actions"),t.els.$tab_links=o(".jck-woosocial-tab-link"),t.els.$tab_content=o(".jck-woosocial-tab-content"),t.els.$load_more_button=o(".jck-woosocial-load-more"),t.els.$action_blocks=o(".jck-woosocial-action"),t.els.$likes_container=o(".jck-woosocial-user-likes"),t.vars.action_offset=1,t.vars.is_hidden_class="jck-woosocial--is-hidden"},on_ready:function(){t.cache(),t.setup_follow_actions(),t.setup_like_action(),t.setup_tabs(),t.setup_load_more(),t.setup_activity_log()},on_scroll:function(){t.scroll_activity_log()},setup_follow_actions:function(){o(".jck-woosocial-follow-action").on("click",function(){var a=o(this),s=a.attr("data-user-id"),i=a.attr("data-type"),c="jck-woosocial-follow-action--loading";"login"===i||a.hasClass(c)||(a.addClass(c),o.ajax({type:"GET",url:jck-woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck-woosocial_follow_action",nonce:jck-woosocial_vars.nonce,user_id:s,type:i},success:function(s){a.text(s.button.text),a.attr("data-type",s.button.type),a.removeClass(c),a.removeClass("jck-woosocial-follow-action--"+i),a.addClass("jck-woosocial-follow-action--"+s.button.type),s.add_follow_html&&t.els.$actions_list.prepend(s.add_follow_html),s.remove_follow_class&&o(s.remove_follow_class).remove()},error:function(o){}}))})},setup_like_action:function(){o(a).on("click",".jck-woo-social-like-action",function(){var a=o(this),t=a.closest(".jck-woo-social-likes"),s=a.attr("data-product-id"),i=a.attr("data-type"),c=a.find(".jck-woo-social-like-button__count"),e="jck-woosocial-follow-action--loading";return a.hasClass(e)||(a.addClass(e),o.ajax({type:"GET",url:jck-woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck-woosocial_like_action",nonce:jck-woosocial_vars.nonce,product_id:s,type:i},success:function(o){if(c.length>0){var s=parseInt(c.text()),n="like"===i?s+1:s-1;c.text(n),a.attr("data-type",o.button.type),a.removeClass(e),a.removeClass("jck-woosocial-like-action--"+i),a.addClass("jck-woosocial-like-action--"+o.button.type),o.add_like_html&&t.find(".jck-woo-social-likes__item--like-button").after(o.add_like_html),o.remove_like_class&&t.find(o.remove_like_class).remove()}},error:function(o){}})),!1})},setup_tabs:function(){t.els.$tab_links.on("click",function(){var a=o(this).attr("href"),s="jck-woosocial-tab-link--active";return t.els.$tab_links.removeClass(s),o(this).addClass(s),t.els.$tab_content.hide(),o(a).show(),!1})},setup_load_more:function(){t.els.$load_more_button.on("click",function(){o(this).hasClass("jck-woosocial-load-more--activity")&&t.load_more_activity(o(this)),o(this).hasClass("jck-woosocial-load-more--likes")&&t.load_more_likes(o(this))})},load_more_activity:function(a){var t=parseInt(a.attr("data-limit")),s=parseInt(a.attr("data-offset")),i=t+s,c=a.attr("data-user-id"),e=a.attr("data-profile-user-id"),n=a.parent();o.ajax({type:"GET",url:jck-woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck-woosocial_load_more_activity",nonce:jck-woosocial_vars.nonce,limit:t,offset:s,user_id:c,profile_user_id:e},success:function(o){o.activity_html?(n.before(o.activity_html),a.attr("data-offset",i)):n.remove()},error:function(o){}})},load_more_likes:function(a){var s=parseInt(a.attr("data-limit")),i=parseInt(a.attr("data-offset")),c=s+i,e=a.attr("data-user-id");o.ajax({type:"GET",url:jck-woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck-woosocial_load_more_likes",nonce:jck-woosocial_vars.nonce,limit:s,offset:i,user_id:e},success:function(o){o.likes_html?(t.els.$likes_container.append(o.likes_html),a.attr("data-offset",c)):a.remove()},error:function(o){}})},setup_activity_log:function(){t.hide_actions(t.els.$action_blocks,t.vars.action_offset)},hide_actions:function(a,s){a.each(function(){o(this).offset().top>o(window).scrollTop()+o(window).height()*s&&o(this).find(".jck-woosocial-action__icon, .jck-woosocial-action__wrapper").css({opacity:0}).addClass(t.vars.is_hidden_class)})},show_actions:function(a,s){a.each(function(){o(this).offset().top<=o(window).scrollTop()+o(window).height()*s&&o(this).find(".jck-woosocial-action__icon").hasClass(t.vars.is_hidden_class)&&o(this).find(".jck-woosocial-action__icon, .jck-woosocial-action__wrapper").removeClass(t.vars.is_hidden_class).animate({opacity:1})})},scroll_activity_log:function(){window.requestAnimationFrame?window.requestAnimationFrame(function(){t.show_actions(t.els.$action_blocks,t.vars.action_offset)}):setTimeout(function(){t.show_actions(t.els.$action_blocks,t.vars.action_offset)},100)}};o(a).ready(t.on_ready()),o(window).on("scroll",function(){t.on_scroll()})}(jQuery,document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwiamNrX3dvb3NvY2lhbCIsImNhY2hlIiwiZWxzIiwidmFycyIsIiRhY3Rpb25zX2xpc3QiLCIkdGFiX2xpbmtzIiwiJHRhYl9jb250ZW50IiwiJGxvYWRfbW9yZV9idXR0b24iLCIkYWN0aW9uX2Jsb2NrcyIsIiRsaWtlc19jb250YWluZXIiLCJhY3Rpb25fb2Zmc2V0IiwiaXNfaGlkZGVuX2NsYXNzIiwib25fcmVhZHkiLCJzZXR1cF9mb2xsb3dfYWN0aW9ucyIsInNldHVwX2xpa2VfYWN0aW9uIiwic2V0dXBfdGFicyIsInNldHVwX2xvYWRfbW9yZSIsInNldHVwX2FjdGl2aXR5X2xvZyIsIm9uX3Njcm9sbCIsInNjcm9sbF9hY3Rpdml0eV9sb2ciLCJvbiIsIiRidXR0b24iLCJ0aGlzIiwidXNlcl9pZCIsImF0dHIiLCJ0eXBlIiwibG9hZGluZ19jbGFzcyIsImhhc0NsYXNzIiwiYWRkQ2xhc3MiLCJhamF4IiwidXJsIiwiamNrIiwid29vc29jaWFsX3ZhcnMiLCJhamF4X3VybCIsImRhdGFUeXBlIiwiY3Jvc3NEb21haW4iLCJkYXRhIiwiYWN0aW9uIiwibm9uY2UiLCJzdWNjZXNzIiwidGV4dCIsImJ1dHRvbiIsInJlbW92ZUNsYXNzIiwiYWRkX2ZvbGxvd19odG1sIiwicHJlcGVuZCIsInJlbW92ZV9mb2xsb3dfY2xhc3MiLCJyZW1vdmUiLCJlcnJvciIsIiRjdXJyZW50X2xpa2VzX2xpc3QiLCJjbG9zZXN0IiwicHJvZHVjdF9pZCIsIiRjb3VudCIsImZpbmQiLCJsZW5ndGgiLCJjb3VudCIsInBhcnNlSW50IiwibmV3X2NvdW50IiwiYWRkX2xpa2VfaHRtbCIsImFmdGVyIiwicmVtb3ZlX2xpa2VfY2xhc3MiLCJ0YXJnZXQiLCJhY3RpdmVfY2xhc3MiLCJoaWRlIiwic2hvdyIsImxvYWRfbW9yZV9hY3Rpdml0eSIsImxvYWRfbW9yZV9saWtlcyIsImxpbWl0Iiwib2Zmc2V0IiwibmV4dF9vZmZzZXQiLCJwcm9maWxlX3VzZXJfaWQiLCIkbG9hZF9tb3JlX2l0ZW0iLCJwYXJlbnQiLCJhY3Rpdml0eV9odG1sIiwiYmVmb3JlIiwibGlrZXNfaHRtbCIsImFwcGVuZCIsImhpZGVfYWN0aW9ucyIsImVhY2giLCJ0b3AiLCJ3aW5kb3ciLCJzY3JvbGxUb3AiLCJoZWlnaHQiLCJjc3MiLCJvcGFjaXR5Iiwic2hvd19hY3Rpb25zIiwiYW5pbWF0ZSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInNldFRpbWVvdXQiLCJyZWFkeSIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FFQSxHQUFBQyxJQUVBQyxNQUFBLFdBQ0FELEVBQUFFLE9BQ0FGLEVBQUFHLFFBRUFILEVBQUFFLElBQUFFLGNBQUFOLEVBQUEsMEJBQ0FFLEVBQUFFLElBQUFHLFdBQUFQLEVBQUEsMkJBQ0FFLEVBQUFFLElBQUFJLGFBQUFSLEVBQUEsOEJBQ0FFLEVBQUFFLElBQUFLLGtCQUFBVCxFQUFBLDRCQUNBRSxFQUFBRSxJQUFBTSxlQUFBVixFQUFBLHlCQUNBRSxFQUFBRSxJQUFBTyxpQkFBQVgsRUFBQSw2QkFFQUUsRUFBQUcsS0FBQU8sY0FBQSxFQUNBVixFQUFBRyxLQUFBUSxnQkFBQSw0QkFJQUMsU0FBQSxXQUVBWixFQUFBQyxRQUNBRCxFQUFBYSx1QkFDQWIsRUFBQWMsb0JBQ0FkLEVBQUFlLGFBQ0FmLEVBQUFnQixrQkFDQWhCLEVBQUFpQixzQkFJQUMsVUFBQSxXQUVBbEIsRUFBQW1CLHVCQUlBTixxQkFBQSxXQUVBZixFQUFBLGdDQUFBc0IsR0FBQSxRQUFBLFdBRUEsR0FBQUMsR0FBQXZCLEVBQUF3QixNQUNBQyxFQUFBRixFQUFBRyxLQUFBLGdCQUNBQyxFQUFBSixFQUFBRyxLQUFBLGFBQ0FFLEVBQUEsc0NBRUEsV0FBQUQsR0FJQUosRUFBQU0sU0FBQUQsS0FFQUwsRUFBQU8sU0FBQUYsR0FFQTVCLEVBQUErQixNQUNBSixLQUFBLE1BQ0FLLElBQUFDLElBQUFDLGVBQUFDLFNB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QUFBLFdBRUEvRSxFQUFBd0IsTUFBQTZDLFNBQUFXLEtBQUFoRixFQUFBaUYsUUFBQUMsWUFBQWxGLEVBQUFpRixRQUFBRSxTQUFBdkUsR0FBQVosRUFBQXdCLE1BQUE4QixLQUFBLCtCQUFBekIsU0FBQTNCLEVBQUFHLEtBQUFRLGtCQUNBYixFQUFBd0IsTUFBQThCLEtBQUEsK0RBQ0FWLFlBQUExQyxFQUFBRyxLQUFBUSxpQkFDQTBFLFNBQUFGLFFBQUEsT0FPQWhFLG9CQUFBLFdBRUE0RCxPQUFBTyxzQkFNQVAsT0FBQU8sc0JBQUEsV0FBQXRGLEVBQUFvRixhQUFBcEYsRUFBQUUsSUFBQU0sZUFBQVIsRUFBQUcsS0FBQU8saUJBSkE2RSxXQUFBLFdBQUF2RixFQUFBb0YsYUFBQXBGLEVBQUFFLElBQUFNLGVBQUFSLEVBQUFHLEtBQUFPLGdCQUFBLE1BWUFaLEdBQUFDLEdBQUF5RixNQUFBeEYsRUFBQVksWUFFQWQsRUFBQWlGLFFBQUEzRCxHQUFBLFNBQUEsV0FDQXBCLEVBQUFrQixlQUdBdUUsT0FBQTFGIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCQsIGRvY3VtZW50KSB7XG4gICAgXG4gICAgdmFyIGpja193b29zb2NpYWwgPSB7XG4gICAgICAgIFxuICAgICAgICBjYWNoZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscyA9IHt9O1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC52YXJzID0ge307XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLiRhY3Rpb25zX2xpc3QgPSAkKCcuamNrLXdvb3NvY2lhbC1hY3Rpb25zJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy4kdGFiX2xpbmtzID0gJCgnLmpjay13b29zb2NpYWwtdGFiLWxpbmsnKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLiR0YWJfY29udGVudCA9ICQoJy5qY2std29vc29jaWFsLXRhYi1jb250ZW50Jyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy4kbG9hZF9tb3JlX2J1dHRvbiA9ICQoJy5qY2std29vc29jaWFsLWxvYWQtbW9yZScpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuJGFjdGlvbl9ibG9ja3MgPSAkKCcuamNrLXdvb3NvY2lhbC1hY3Rpb24nKTsgICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLiRsaWtlc19jb250YWluZXIgPSAkKCcuamNrLXdvb3NvY2lhbC11c2VyLWxpa2VzJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwudmFycy5hY3Rpb25fb2Zmc2V0ID0gMTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwudmFycy5pc19oaWRkZW5fY2xhc3MgPSBcImpjay13b29zb2NpYWwtLWlzLWhpZGRlblwiO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gXG4gICAgICAgIG9uX3JlYWR5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5jYWNoZSgpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9mb2xsb3dfYWN0aW9ucygpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9saWtlX2FjdGlvbigpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF90YWJzKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX2xvYWRfbW9yZSgpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9hY3Rpdml0eV9sb2coKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgb25fc2Nyb2xsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zY3JvbGxfYWN0aXZpdHlfbG9nKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgXG4gICAgICAgIHNldHVwX2ZvbGxvd19hY3Rpb25zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJCgnLmpjay13b29zb2NpYWwtZm9sbG93LWFjdGlvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyICRidXR0b24gPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICB1c2VyX2lkID0gJGJ1dHRvbi5hdHRyKCdkYXRhLXVzZXItaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICRidXR0b24uYXR0cignZGF0YS10eXBlJyksXG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmdfY2xhc3MgPSAnamNrLXdvb3NvY2lhbC1mb2xsb3ctYWN0aW9uLS1sb2FkaW5nJztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggdHlwZSA9PT0gXCJsb2dpblwiICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiggISRidXR0b24uaGFzQ2xhc3MobG9hZGluZ19jbGFzcykgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICRidXR0b24uYWRkQ2xhc3MobG9hZGluZ19jbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIFx0XHRcdFx0dHlwZTogXCJHRVRcIixcbiAgICAgICAgICAgIFx0XHRcdFx0dXJsOiBqY2std29vc29jaWFsX3ZhcnMuYWpheF91cmwsXG4gICAgICAgICAgICBcdFx0XHRcdGNhY2hlOiBmYWxzZSxcbiAgICAgICAgICAgIFx0XHRcdFx0ZGF0YVR5cGU6IFwianNvbnBcIixcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcbiAgICAgICAgICAgIFx0XHRcdFx0ZGF0YToge1xuICAgICAgICAgICAgXHRcdFx0XHRcdGFjdGlvbiA6ICdqY2std29vc29jaWFsX2ZvbGxvd19hY3Rpb24nLFxuICAgICAgICAgICAgXHRcdFx0XHRcdG5vbmNlIDogamNrLXdvb3NvY2lhbF92YXJzLm5vbmNlLFxuICAgICAgICAgICAgXHRcdFx0XHRcdHVzZXJfaWQgOiB1c2VyX2lkLFxuICAgICAgICAgICAgXHRcdFx0XHRcdHR5cGUgOiB0eXBlXG4gICAgICAgICAgICBcdFx0XHRcdH0sXG4gICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLnRleHQoZGF0YS5idXR0b24udGV4dCk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5hdHRyKCdkYXRhLXR5cGUnLGRhdGEuYnV0dG9uLnR5cGUpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24ucmVtb3ZlQ2xhc3MobG9hZGluZ19jbGFzcyk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5yZW1vdmVDbGFzcygnamNrLXdvb3NvY2lhbC1mb2xsb3ctYWN0aW9uLS0nK3R5cGUpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24uYWRkQ2xhc3MoJ2pjay13b29zb2NpYWwtZm9sbG93LWFjdGlvbi0tJytkYXRhLmJ1dHRvbi50eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHRpZihkYXRhLmFkZF9mb2xsb3dfaHRtbCkge1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHRqY2tfd29vc29jaWFsLmVscy4kYWN0aW9uc19saXN0LnByZXBlbmQoZGF0YS5hZGRfZm9sbG93X2h0bWwpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdH1cbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHRpZihkYXRhLnJlbW92ZV9mb2xsb3dfY2xhc3MpIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0JChkYXRhLnJlbW92ZV9mb2xsb3dfY2xhc3MpLnJlbW92ZSgpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdH1cbiAgICAgICAgICAgIFx0XHRcdFx0fSxcbiAgICAgICAgICAgIFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdGVycm9yOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHR9XG4gICAgICAgICAgICBcdFx0XHR9KTtcbiAgICAgICAgXHRcdFx0XG4gICAgICAgIFx0XHRcdH1cbiAgICBcdFx0XHRcbiAgICBcdFx0XHR9XG5cdFx0XHRcblx0XHRcdH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzZXR1cF9saWtlX2FjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuamNrLXdvby1zb2NpYWwtbGlrZS1hY3Rpb24nLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciAkYnV0dG9uID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgJGN1cnJlbnRfbGlrZXNfbGlzdCA9ICRidXR0b24uY2xvc2VzdCgnLmpjay13b28tc29jaWFsLWxpa2VzJyksXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfaWQgPSAkYnV0dG9uLmF0dHIoJ2RhdGEtcHJvZHVjdC1pZCcpLFxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gJGJ1dHRvbi5hdHRyKCdkYXRhLXR5cGUnKSxcbiAgICAgICAgICAgICAgICAgICAgJGNvdW50ID0gJGJ1dHRvbi5maW5kKCcuamNrLXdvby1zb2NpYWwtbGlrZS1idXR0b25fX2NvdW50JyksXG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmdfY2xhc3MgPSAnamNrLXdvb3NvY2lhbC1mb2xsb3ctYWN0aW9uLS1sb2FkaW5nJztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICEkYnV0dG9uLmhhc0NsYXNzKGxvYWRpbmdfY2xhc3MpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICRidXR0b24uYWRkQ2xhc3MobG9hZGluZ19jbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICBcdFx0XHRcdHR5cGU6IFwiR0VUXCIsXG4gICAgICAgIFx0XHRcdFx0dXJsOiBqY2std29vc29jaWFsX3ZhcnMuYWpheF91cmwsXG4gICAgICAgIFx0XHRcdFx0Y2FjaGU6IGZhbHNlLFxuICAgICAgICBcdFx0XHRcdGRhdGFUeXBlOiBcImpzb25wXCIsXHRcdFx0XHRcbiAgICAgICAgXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcbiAgICAgICAgXHRcdFx0XHRkYXRhOiB7XG4gICAgICAgIFx0XHRcdFx0XHRhY3Rpb24gOiAnamNrLXdvb3NvY2lhbF9saWtlX2FjdGlvbicsXG4gICAgICAgIFx0XHRcdFx0XHRub25jZSA6IGpjay13b29zb2NpYWxfdmFycy5ub25jZSxcbiAgICAgICAgXHRcdFx0XHRcdHByb2R1Y3RfaWQgOiBwcm9kdWN0X2lkLFxuICAgICAgICBcdFx0XHRcdFx0dHlwZSA6IHR5cGVcbiAgICAgICAgXHRcdFx0XHR9LFxuICAgICAgICBcdFx0XHRcdFxuICAgICAgICBcdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgIFx0XHRcdFx0XHRpZiggJGNvdW50Lmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0dmFyIGNvdW50ID0gcGFyc2VJbnQoJGNvdW50LnRleHQoKSksXG4gICAgICAgICAgICBcdFx0XHRcdFx0ICAgIG5ld19jb3VudCA9IHR5cGUgPT09IFwibGlrZVwiID8gY291bnQrMSA6IGNvdW50LTE7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGNvdW50LnRleHQoIG5ld19jb3VudCApOyBcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLmF0dHIoJ2RhdGEtdHlwZScsIGRhdGEuYnV0dG9uLnR5cGUpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24ucmVtb3ZlQ2xhc3MobG9hZGluZ19jbGFzcyk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5yZW1vdmVDbGFzcygnamNrLXdvb3NvY2lhbC1saWtlLWFjdGlvbi0tJyt0eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLmFkZENsYXNzKCdqY2std29vc29jaWFsLWxpa2UtYWN0aW9uLS0nK2RhdGEuYnV0dG9uLnR5cGUpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdGlmKGRhdGEuYWRkX2xpa2VfaHRtbCkge1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkY3VycmVudF9saWtlc19saXN0LmZpbmQoJy5qY2std29vLXNvY2lhbC1saWtlc19faXRlbS0tbGlrZS1idXR0b24nKS5hZnRlcihkYXRhLmFkZF9saWtlX2h0bWwpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdH1cbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHRpZihkYXRhLnJlbW92ZV9saWtlX2NsYXNzKSB7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdCRjdXJyZW50X2xpa2VzX2xpc3QuZmluZChkYXRhLnJlbW92ZV9saWtlX2NsYXNzKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHR9ICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgIFx0XHRcdFx0XHR9XG4gICAgICAgIFx0XHRcdFx0fSxcbiAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICBcdFx0XHRcdH1cbiAgICAgICAgXHRcdFx0fSk7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc2V0dXBfdGFiczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLiR0YWJfbGlua3Mub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gJCh0aGlzKS5hdHRyKCdocmVmJyksXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZV9jbGFzcyA9ICdqY2std29vc29jaWFsLXRhYi1saW5rLS1hY3RpdmUnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLiR0YWJfbGlua3MucmVtb3ZlQ2xhc3MoYWN0aXZlX2NsYXNzKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKGFjdGl2ZV9jbGFzcyk7XG4gICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuJHRhYl9jb250ZW50LmhpZGUoKTtcbiAgICAgICAgICAgICAgICAkKHRhcmdldCkuc2hvdygpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzZXR1cF9sb2FkX21vcmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy4kbG9hZF9tb3JlX2J1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICQodGhpcykuaGFzQ2xhc3MoJ2pjay13b29zb2NpYWwtbG9hZC1tb3JlLS1hY3Rpdml0eScpICkge1xuICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmxvYWRfbW9yZV9hY3Rpdml0eSggJCh0aGlzKSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICQodGhpcykuaGFzQ2xhc3MoJ2pjay13b29zb2NpYWwtbG9hZC1tb3JlLS1saWtlcycpICkge1xuICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmxvYWRfbW9yZV9saWtlcyggJCh0aGlzKSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBsb2FkX21vcmVfYWN0aXZpdHk6IGZ1bmN0aW9uKCAkbG9hZF9tb3JlX2J1dHRvbiApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGxpbWl0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtbGltaXQnKSApLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHBhcnNlSW50KCAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLW9mZnNldCcpICksXG4gICAgICAgICAgICAgICAgbmV4dF9vZmZzZXQgPSBsaW1pdCtvZmZzZXQsXG4gICAgICAgICAgICAgICAgdXNlcl9pZCA9ICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtdXNlci1pZCcpLFxuICAgICAgICAgICAgICAgIHByb2ZpbGVfdXNlcl9pZCA9ICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtcHJvZmlsZS11c2VyLWlkJyksXG4gICAgICAgICAgICAgICAgJGxvYWRfbW9yZV9pdGVtID0gJGxvYWRfbW9yZV9idXR0b24ucGFyZW50KCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAkLmFqYXgoe1xuXHRcdFx0XHR0eXBlOiBcIkdFVFwiLFxuXHRcdFx0XHR1cmw6IGpjay13b29zb2NpYWxfdmFycy5hamF4X3VybCxcblx0XHRcdFx0Y2FjaGU6IGZhbHNlLFxuXHRcdFx0XHRkYXRhVHlwZTogXCJqc29ucFwiLFx0XHRcdFx0XG5cdFx0XHRcdGNyb3NzRG9tYWluOiB0cnVlLFxuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uIDogJ2pjay13b29zb2NpYWxfbG9hZF9tb3JlX2FjdGl2aXR5Jyxcblx0XHRcdFx0XHRub25jZSA6IGpjay13b29zb2NpYWxfdmFycy5ub25jZSxcblx0XHRcdFx0XHRsaW1pdCA6IGxpbWl0LFxuXHRcdFx0XHRcdG9mZnNldCA6IG9mZnNldCxcblx0XHRcdFx0XHR1c2VyX2lkIDogdXNlcl9pZCxcblx0XHRcdFx0XHRwcm9maWxlX3VzZXJfaWQgOiBwcm9maWxlX3VzZXJfaWRcblx0XHRcdFx0fSxcblx0XHRcdFx0XG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCBkYXRhICkge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKCBkYXRhLmFjdGl2aXR5X2h0bWwgKSB7XG4gICAgXHRcdFx0XHRcdFxuICAgIFx0XHRcdFx0XHQkbG9hZF9tb3JlX2l0ZW0uYmVmb3JlKCBkYXRhLmFjdGl2aXR5X2h0bWwgKTtcbiAgICBcdFx0XHRcdFx0JGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1vZmZzZXQnLCBuZXh0X29mZnNldCkgO1xuICAgIFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9IGVsc2Uge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0JGxvYWRfbW9yZV9pdGVtLnJlbW92ZSgpO1xuICAgIFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgXHRcdFx0XHRcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGxvYWRfbW9yZV9saWtlczogZnVuY3Rpb24oICRsb2FkX21vcmVfYnV0dG9uICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgbGltaXQgPSBwYXJzZUludCggJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1saW1pdCcpICksXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtb2Zmc2V0JykgKSxcbiAgICAgICAgICAgICAgICBuZXh0X29mZnNldCA9IGxpbWl0K29mZnNldCxcbiAgICAgICAgICAgICAgICB1c2VyX2lkID0gJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS11c2VyLWlkJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAkLmFqYXgoe1xuXHRcdFx0XHR0eXBlOiBcIkdFVFwiLFxuXHRcdFx0XHR1cmw6IGpjay13b29zb2NpYWxfdmFycy5hamF4X3VybCxcblx0XHRcdFx0Y2FjaGU6IGZhbHNlLFxuXHRcdFx0XHRkYXRhVHlwZTogXCJqc29ucFwiLFx0XHRcdFx0XG5cdFx0XHRcdGNyb3NzRG9tYWluOiB0cnVlLFxuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uIDogJ2pjay13b29zb2NpYWxfbG9hZF9tb3JlX2xpa2VzJyxcblx0XHRcdFx0XHRub25jZSA6IGpjay13b29zb2NpYWxfdmFycy5ub25jZSxcblx0XHRcdFx0XHRsaW1pdCA6IGxpbWl0LFxuXHRcdFx0XHRcdG9mZnNldCA6IG9mZnNldCxcblx0XHRcdFx0XHR1c2VyX2lkIDogdXNlcl9pZFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIGRhdGEgKSB7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoIGRhdGEubGlrZXNfaHRtbCApIHtcbiAgICBcdFx0XHRcdFx0XG4gICAgXHRcdFx0XHRcdGpja193b29zb2NpYWwuZWxzLiRsaWtlc19jb250YWluZXIuYXBwZW5kKCBkYXRhLmxpa2VzX2h0bWwgKTtcbiAgICBcdFx0XHRcdFx0JGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1vZmZzZXQnLCBuZXh0X29mZnNldCkgO1xuICAgIFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9IGVsc2Uge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0JGxvYWRfbW9yZV9idXR0b24ucmVtb3ZlKCk7XG4gICAgXHRcdFx0XHRcdFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0fSxcblx0XHRcdFx0XG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICBcdFx0XHRcdFxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc2V0dXBfYWN0aXZpdHlfbG9nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5oaWRlX2FjdGlvbnMoamNrX3dvb3NvY2lhbC5lbHMuJGFjdGlvbl9ibG9ja3MsIGpja193b29zb2NpYWwudmFycy5hY3Rpb25fb2Zmc2V0KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgaGlkZV9hY3Rpb25zOiBmdW5jdGlvbigkYWN0aW9uX2Jsb2NrcywgYWN0aW9uX29mZnNldCkge1xuICAgIFx0XHRcbiAgICBcdFx0JGFjdGlvbl9ibG9ja3MuZWFjaChmdW5jdGlvbigpe1xuICAgIFx0XHRcdFxuICAgIFx0XHRcdGlmKCAkKHRoaXMpLm9mZnNldCgpLnRvcCA+ICQod2luZG93KS5zY3JvbGxUb3AoKSskKHdpbmRvdykuaGVpZ2h0KCkqYWN0aW9uX29mZnNldCApIHtcbiAgICAgICAgXHRcdFx0JCh0aGlzKS5maW5kKCcuamNrLXdvb3NvY2lhbC1hY3Rpb25fX2ljb24sIC5qY2std29vc29jaWFsLWFjdGlvbl9fd3JhcHBlcicpLmNzcyh7IG9wYWNpdHk6IDAgfSkuYWRkQ2xhc3MoamNrX3dvb3NvY2lhbC52YXJzLmlzX2hpZGRlbl9jbGFzcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgIFx0XHRcdFxuICAgIFx0XHR9KTtcbiAgICBcdFx0XG4gICAgXHR9LFxuICAgIFxuICAgIFx0c2hvd19hY3Rpb25zOiBmdW5jdGlvbigkYWN0aW9uX2Jsb2NrcywgYWN0aW9uX29mZnNldCkge1xuICAgIFx0XHRcbiAgICBcdFx0JGFjdGlvbl9ibG9ja3MuZWFjaChmdW5jdGlvbigpe1xuICAgIFx0XHRcdFxuICAgIFx0XHRcdGlmKCAkKHRoaXMpLm9mZnNldCgpLnRvcCA8PSAkKHdpbmRvdykuc2Nyb2xsVG9wKCkrJCh3aW5kb3cpLmhlaWdodCgpKmFjdGlvbl9vZmZzZXQgJiYgJCh0aGlzKS5maW5kKCcuamNrLXdvb3NvY2lhbC1hY3Rpb25fX2ljb24nKS5oYXNDbGFzcyhqY2tfd29vc29jaWFsLnZhcnMuaXNfaGlkZGVuX2NsYXNzKSApIHtcbiAgICAgICAgXHRcdFx0JCh0aGlzKS5maW5kKCcuamNrLXdvb3NvY2lhbC1hY3Rpb25fX2ljb24sIC5qY2std29vc29jaWFsLWFjdGlvbl9fd3JhcHBlcicpXG4gICAgICAgIFx0XHRcdCAgICAucmVtb3ZlQ2xhc3MoamNrX3dvb3NvY2lhbC52YXJzLmlzX2hpZGRlbl9jbGFzcylcbiAgICAgICAgXHRcdFx0ICAgIC5hbmltYXRlKHsgb3BhY2l0eTogMSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgXHRcdFx0XG4gICAgXHRcdH0pO1xuICAgIFx0XHRcbiAgICBcdH0sXG4gICAgXHRcbiAgICBcdHNjcm9sbF9hY3Rpdml0eV9sb2c6IGZ1bmN0aW9uKCkge1xuICAgICAgICBcdFxuICAgICAgICBcdGlmKCF3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKSB7XG4gICAgICAgICAgICBcdFxuXHRcdFx0ICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsgamNrX3dvb3NvY2lhbC5zaG93X2FjdGlvbnMoamNrX3dvb3NvY2lhbC5lbHMuJGFjdGlvbl9ibG9ja3MsIGpja193b29zb2NpYWwudmFycy5hY3Rpb25fb2Zmc2V0KTsgfSwgMTAwKTtcbiAgICAgICAgICAgXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXsgamNrX3dvb3NvY2lhbC5zaG93X2FjdGlvbnMoamNrX3dvb3NvY2lhbC5lbHMuJGFjdGlvbl9ibG9ja3MsIGpja193b29zb2NpYWwudmFycy5hY3Rpb25fb2Zmc2V0KTsgfSk7ICBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgIFx0fVxuICAgICBcbiAgICB9O1xuICAgIFxuXHQkKGRvY3VtZW50KS5yZWFkeSggamNrX3dvb3NvY2lhbC5vbl9yZWFkeSgpICk7XG5cdFxuXHQkKHdpbmRvdykub24oJ3Njcm9sbCcsIGZ1bmN0aW9uKCl7XG4gICAgXHRqY2tfd29vc29jaWFsLm9uX3Njcm9sbCgpO1xuICAgIH0pO1xuXG59KGpRdWVyeSwgZG9jdW1lbnQpKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=