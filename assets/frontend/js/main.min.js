!function(o,a){var t={cache:function(){t.els={},t.vars={},t.vars.is_hidden_class="jck-woosocial--is-hidden",t.vars.animate_spin_class="jck-woosocial-spin",t.vars.add_to_cart_buttons_class=".jck-woosocial-add-to-cart-wrapper .add_to_cart_button",t.vars.card_grid_cards_class=".jck-woosocial-card-grid .jck-woosocial-card",t.vars.card_hover_class="jck-woosocial-card--hover",t.els.document_body=o(a.body),t.els.actions_list=o(".jck-woosocial-actions"),t.els.tab_links=o(".jck-woosocial-profile-link"),t.els.tab_content=o(".jck-woosocial-tab-content"),t.els.load_more_button=o(".jck-woosocial-load-more"),t.els.action_blocks=o(".jck-woosocial-action"),t.els.likes_container=o(".jck-woosocial-user-likes"),t.els.add_to_cart_buttons=o(".jck-woosocial-add-to-cart-wrapper .add_to_cart_button"),t.els.tick_icon=o('<i class="jck-woosocial-ic-tick"></i>'),t.els.loading_icon=o('<i class="jck-woosocial-ic-loading jck-woosocial-spin"></i>'),t.els.card_grids=o(".jck-woosocial-card-grid"),t.els.breakpoint_elements=o("[data-breakpoints]"),t.els.breakpoints=[]},on_ready:function(){t.cache(),t.setup_follow_actions(),t.setup_product_like_action(),t.setup_tabs(),t.setup_load_more(),t.add_to_cart(),t.setup_breakpoints(),t.check_breakpoints(),t.setup_cards()},on_scroll:function(){},on_resize:function(){t.check_breakpoints()},setup_follow_actions:function(){o(".jck-woosocial-follow-action").on("click",function(){var a=o(this),s=a.attr("data-user-id"),c=a.attr("data-type"),i="jck-woosocial-follow-action--loading";"login"!==c&&(a.hasClass(i)||(a.addClass(i),o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_follow_action",nonce:jck_woosocial_vars.nonce,user_id:s,type:c},success:function(o){a.text(o.button.text),a.attr("data-type",o.button.type),a.removeClass(i),a.removeClass("jck-woosocial-follow-action--"+c),a.addClass("jck-woosocial-follow-action--"+o.button.type),o.add_follow_html&&t.els.actions_list.prepend(o.add_follow_html)},error:function(o){}})))})},setup_product_like_action:function(){o(a).on("click",".jck-woosocial-product-like-action",function(){{var a=o(this),t=a.closest(".jck-woosocial-product-likes"),s=a.attr("data-product-id"),c=a.attr("data-type"),i=a.find(".jck-woosocial-product-like-button__count"),e="jck-woosocial-product-like-action--loading",n=a.find("i");a.closest(".jck-woosocial-action")}return"login"!==c?(a.hasClass(e)||(a.addClass(e),o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_product_like_action",nonce:jck_woosocial_vars.nonce,product_id:s,type:c},success:function(o){if(i.length>0){var s=parseInt(i.text()),l="like"===c?s+1:s-1;i.text(l),a.attr("data-type",o.button.type),a.removeClass(e),a.removeClass("jck-woosocial-product-like-action--"+c),a.addClass("jck-woosocial-product-like-action--"+o.button.type),"unlike"===o.button.type?n.attr("class","jck-woosocial-ic-heart-full"):n.attr("class","jck-woosocial-ic-heart"),o.add_like_html&&t.find(".jck-woosocial-product-likes__item--like-button").after(o.add_like_html),o.remove_like_class&&t.find(o.remove_like_class).remove()}},error:function(o){}})),!1):void 0})},setup_tabs:function(){t.els.tab_links.on("click",function(){var a=o(this).attr("href"),s="jck-woosocial-profile-link--active";return t.els.tab_links.removeClass(s),o(this).addClass(s),t.els.tab_content.hide(),o(a).show(),t.check_breakpoints(),!1})},spin_icon_start:function(o){o.addClass(t.vars.animate_spin_class)},spin_icon_stop:function(o){o.removeClass(t.vars.animate_spin_class)},disable_load_more_button:function(o){o.html(jck_woosocial_vars.strings.no_more).removeAttr("href").addClass("jck-woosocial-load-more--disabled")},setup_load_more:function(){t.els.load_more_button.on("click",function(){var a=o(this),s=a.find("i");return a.hasClass("jck-woosocial-load-more--disabled")?!1:(t.spin_icon_start(s),o(this).hasClass("jck-woosocial-load-more--activity")&&t.load_more_activity(o(this),function(){t.spin_icon_stop(s)}),void(o(this).hasClass("jck-woosocial-load-more--likes")&&t.load_more_likes(o(this),function(){t.spin_icon_stop(s)})))})},load_more_activity:function(a,s){var c=parseInt(a.attr("data-limit")),i=parseInt(a.attr("data-offset")),e=c+i,n=a.attr("data-user-id"),l=a.attr("data-profile-user-id"),r=a.closest("li");o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_activity",nonce:jck_woosocial_vars.nonce,limit:c,offset:i,user_id:n,profile_user_id:l},success:function(o){o.activity_html?(r.before(o.activity_html),a.attr("data-offset",e)):t.disable_load_more_button(a),void 0!==s&&s(o)},error:function(o){}})},load_more_likes:function(a,s){var c=parseInt(a.attr("data-limit")),i=parseInt(a.attr("data-offset")),e=c+i,n=a.attr("data-user-id");o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_likes",nonce:jck_woosocial_vars.nonce,limit:c,offset:i,user_id:n},success:function(o){o.likes_html?(t.els.likes_container.append(o.likes_html),a.attr("data-offset",e)):t.disable_load_more_button(a),void 0!==s&&s(o)},error:function(o){}})},add_to_cart:function(){t.els.document_body.on("click",t.vars.add_to_cart_buttons_class,function(){var a=o(this),s=a.text();a.attr("data-button-text",s).append(t.els.loading_icon)}),t.els.document_body.on("added_to_cart",function(o,a,s,c){var i=c.closest(".jck-woosocial-add-to-cart-wrapper"),e=c.attr("data-button-text");i.length>0&&(c.html(e).append(t.els.tick_icon),setTimeout(function(){c.html(e)},2e3))})},setup_breakpoints:function(){t.els.breakpoint_elements.length>0&&t.els.breakpoint_elements.each(function(a,s){var c=o(s),i=c.attr("data-breakpoints"),e=o.parseJSON(i),n={element:c,breakpoints:e,width:0};t.els.breakpoints.push(n)}),t.els.document_body.on("element_width_change",function(o,a){t.update_breakpoints(a)})},check_breakpoints:function(){t.els.breakpoints.length>0&&o.each(t.els.breakpoints,function(o,a){var s=a.width,c=a.element.width();c!==s&&(a.width=c,t.els.document_body.trigger("element_width_change",[a]))})},update_breakpoints:function(a){var t=!1;o.each(a.breakpoints,function(o,s){a.width<=s.max_width&&(t?s.max_width<=t&&(t=s.max_width):t=s.max_width)}),o.each(a.breakpoints,function(o,s){s.max_width===t?a.element.addClass(s["class"]):a.element.removeClass(s["class"])})},setup_cards:function(){t.els.document_body.hoverIntent(function(){var a=o(this);a.addClass(t.vars.card_hover_class)},function(){var a=o(this);a.removeClass(t.vars.card_hover_class)},t.vars.card_grid_cards_class)}};o(a).ready(t.on_ready()),o(window).on("scroll",function(){t.on_scroll()}),o(window).on("resize",function(){t.on_resize()})}(jQuery,document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwiamNrX3dvb3NvY2lhbCIsImNhY2hlIiwiZWxzIiwidmFycyIsImlzX2hpZGRlbl9jbGFzcyIsImFuaW1hdGVfc3Bpbl9jbGFzcyIsImFkZF90b19jYXJ0X2J1dHRvbnNfY2xhc3MiLCJjYXJkX2dyaWRfY2FyZHNfY2xhc3MiLCJjYXJkX2hvdmVyX2NsYXNzIiwiZG9jdW1lbnRfYm9keSIsImJvZHkiLCJhY3Rpb25zX2xpc3QiLCJ0YWJfbGlua3MiLCJ0YWJfY29udGVudCIsImxvYWRfbW9yZV9idXR0b24iLCJhY3Rpb25fYmxvY2tzIiwibGlrZXNfY29udGFpbmVyIiwiYWRkX3RvX2NhcnRfYnV0dG9ucyIsInRpY2tfaWNvbiIsImxvYWRpbmdfaWNvbiIsImNhcmRfZ3JpZHMiLCJicmVha3BvaW50X2VsZW1lbnRzIiwiYnJlYWtwb2ludHMiLCJvbl9yZWFkeSIsInNldHVwX2ZvbGxvd19hY3Rpb25zIiwic2V0dXBfcHJvZHVjdF9saWtlX2FjdGlvbiIsInNldHVwX3RhYnMiLCJzZXR1cF9sb2FkX21vcmUiLCJhZGRfdG9fY2FydCIsInNldHVwX2JyZWFrcG9pbnRzIiwiY2hlY2tfYnJlYWtwb2ludHMiLCJzZXR1cF9jYXJkcyIsIm9uX3Njcm9sbCIsIm9uX3Jlc2l6ZSIsIm9uIiwiJGJ1dHRvbiIsInRoaXMiLCJ1c2VyX2lkIiwiYXR0ciIsInR5cGUiLCJsb2FkaW5nX2NsYXNzIiwiaGFzQ2xhc3MiLCJhZGRDbGFzcyIsImFqYXgiLCJ1cmwiLCJqY2tfd29vc29jaWFsX3ZhcnMiLCJhamF4X3VybCIsImRhdGFUeXBlIiwiY3Jvc3NEb21haW4iLCJkYXRhIiwiYWN0aW9uIiwibm9uY2UiLCJzdWNjZXNzIiwidGV4dCIsImJ1dHRvbiIsInJlbW92ZUNsYXNzIiwiYWRkX2ZvbGxvd19odG1sIiwicHJlcGVuZCIsImVycm9yIiwiJGN1cnJlbnRfbGlrZXNfbGlzdCIsImNsb3Nlc3QiLCJwcm9kdWN0X2lkIiwiJGNvdW50IiwiZmluZCIsIiRpY29uIiwibGVuZ3RoIiwiY291bnQiLCJwYXJzZUludCIsIm5ld19jb3VudCIsImFkZF9saWtlX2h0bWwiLCJhZnRlciIsInJlbW92ZV9saWtlX2NsYXNzIiwicmVtb3ZlIiwidGFyZ2V0IiwiYWN0aXZlX2NsYXNzIiwiaGlkZSIsInNob3ciLCJzcGluX2ljb25fc3RhcnQiLCJzcGluX2ljb25fc3RvcCIsImRpc2FibGVfbG9hZF9tb3JlX2J1dHRvbiIsImh0bWwiLCJzdHJpbmdzIiwibm9fbW9yZSIsInJlbW92ZUF0dHIiLCIkbG9hZF9tb3JlX2J1dHRvbiIsIiRsb2FkX21vcmVfaWNvbiIsImxvYWRfbW9yZV9hY3Rpdml0eSIsImxvYWRfbW9yZV9saWtlcyIsImNhbGxiYWNrIiwibGltaXQiLCJvZmZzZXQiLCJuZXh0X29mZnNldCIsInByb2ZpbGVfdXNlcl9pZCIsIiRsb2FkX21vcmVfaXRlbSIsImFjdGl2aXR5X2h0bWwiLCJiZWZvcmUiLCJ1bmRlZmluZWQiLCJsaWtlc19odG1sIiwiYXBwZW5kIiwiYnV0dG9uX3RleHQiLCJlIiwiZnJhZ21lbnRzIiwiY2FydF9oYXNoIiwiJHdvb3NvY2lhbF9idXR0b25fd3JhcHBlciIsInNldFRpbWVvdXQiLCJlYWNoIiwiaW5kZXgiLCJlbGVtZW50IiwiJGVsZW1lbnQiLCJicmVha3BvaW50c19hcnJheSIsInBhcnNlSlNPTiIsImJyZWFrcG9pbnRfb2JqZWN0Iiwid2lkdGgiLCJwdXNoIiwiZXZlbnQiLCJ1cGRhdGVfYnJlYWtwb2ludHMiLCJwcmV2aW91c193aWR0aCIsImN1cnJlbnRfd2lkdGgiLCJ0cmlnZ2VyIiwiY3VycmVudF9icmVha3BvaW50IiwiYnJlYWtwb2ludF9kYXRhIiwibWF4X3dpZHRoIiwiaG92ZXJJbnRlbnQiLCIkY2FyZCIsInJlYWR5Iiwid2luZG93IiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUVBLEdBQUFDLElBRUFDLE1BQUEsV0FDQUQsRUFBQUUsT0FD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KGZ1bmN0aW9uKCQsIGRvY3VtZW50KSB7XG4gICAgXG4gICAgdmFyIGpja193b29zb2NpYWwgPSB7XG4gICAgICAgIFxuICAgICAgICBjYWNoZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscyA9IHt9O1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC52YXJzID0ge307XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwudmFycy5pc19oaWRkZW5fY2xhc3MgPSBcImpjay13b29zb2NpYWwtLWlzLWhpZGRlblwiO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC52YXJzLmFuaW1hdGVfc3Bpbl9jbGFzcyA9IFwiamNrLXdvb3NvY2lhbC1zcGluXCI7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnZhcnMuYWRkX3RvX2NhcnRfYnV0dG9uc19jbGFzcyA9ICcuamNrLXdvb3NvY2lhbC1hZGQtdG8tY2FydC13cmFwcGVyIC5hZGRfdG9fY2FydF9idXR0b24nO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC52YXJzLmNhcmRfZ3JpZF9jYXJkc19jbGFzcyA9ICcuamNrLXdvb3NvY2lhbC1jYXJkLWdyaWQgLmpjay13b29zb2NpYWwtY2FyZCc7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnZhcnMuY2FyZF9ob3Zlcl9jbGFzcyA9ICdqY2std29vc29jaWFsLWNhcmQtLWhvdmVyJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuZG9jdW1lbnRfYm9keSA9ICQoZG9jdW1lbnQuYm9keSk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5hY3Rpb25zX2xpc3QgPSAkKCcuamNrLXdvb3NvY2lhbC1hY3Rpb25zJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50YWJfbGlua3MgPSAkKCcuamNrLXdvb3NvY2lhbC1wcm9maWxlLWxpbmsnKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLnRhYl9jb250ZW50ID0gJCgnLmpjay13b29zb2NpYWwtdGFiLWNvbnRlbnQnKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmxvYWRfbW9yZV9idXR0b24gPSAkKCcuamNrLXdvb3NvY2lhbC1sb2FkLW1vcmUnKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmFjdGlvbl9ibG9ja3MgPSAkKCcuamNrLXdvb3NvY2lhbC1hY3Rpb24nKTsgICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmxpa2VzX2NvbnRhaW5lciA9ICQoJy5qY2std29vc29jaWFsLXVzZXItbGlrZXMnKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmFkZF90b19jYXJ0X2J1dHRvbnMgPSAkKCcuamNrLXdvb3NvY2lhbC1hZGQtdG8tY2FydC13cmFwcGVyIC5hZGRfdG9fY2FydF9idXR0b24nKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLnRpY2tfaWNvbiA9ICQoJzxpIGNsYXNzPVwiamNrLXdvb3NvY2lhbC1pYy10aWNrXCI+PC9pPicpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMubG9hZGluZ19pY29uID0gJCgnPGkgY2xhc3M9XCJqY2std29vc29jaWFsLWljLWxvYWRpbmcgamNrLXdvb3NvY2lhbC1zcGluXCI+PC9pPicpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuY2FyZF9ncmlkcyA9ICQoJy5qY2std29vc29jaWFsLWNhcmQtZ3JpZCcpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuYnJlYWtwb2ludF9lbGVtZW50cyA9ICQoJ1tkYXRhLWJyZWFrcG9pbnRzXScpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuYnJlYWtwb2ludHMgPSBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuIFxuICAgICAgICBvbl9yZWFkeTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuY2FjaGUoKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuc2V0dXBfZm9sbG93X2FjdGlvbnMoKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuc2V0dXBfcHJvZHVjdF9saWtlX2FjdGlvbigpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF90YWJzKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX2xvYWRfbW9yZSgpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5hZGRfdG9fY2FydCgpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9icmVha3BvaW50cygpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5jaGVja19icmVha3BvaW50cygpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9jYXJkcygpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBvbl9zY3JvbGw6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBvbl9yZXNpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmNoZWNrX2JyZWFrcG9pbnRzKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgXG4gICAgICAgIHNldHVwX2ZvbGxvd19hY3Rpb25zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJCgnLmpjay13b29zb2NpYWwtZm9sbG93LWFjdGlvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyICRidXR0b24gPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICB1c2VyX2lkID0gJGJ1dHRvbi5hdHRyKCdkYXRhLXVzZXItaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICRidXR0b24uYXR0cignZGF0YS10eXBlJyksXG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmdfY2xhc3MgPSAnamNrLXdvb3NvY2lhbC1mb2xsb3ctYWN0aW9uLS1sb2FkaW5nJztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggdHlwZSAhPT0gXCJsb2dpblwiICkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiggISRidXR0b24uaGFzQ2xhc3MobG9hZGluZ19jbGFzcykgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICRidXR0b24uYWRkQ2xhc3MobG9hZGluZ19jbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIFx0XHRcdFx0dHlwZTogICAgICAgIFwiR0VUXCIsXG4gICAgICAgICAgICBcdFx0XHRcdHVybDogICAgICAgICBqY2tfd29vc29jaWFsX3ZhcnMuYWpheF91cmwsXG4gICAgICAgICAgICBcdFx0XHRcdGNhY2hlOiAgICAgICBmYWxzZSxcbiAgICAgICAgICAgIFx0XHRcdFx0ZGF0YVR5cGU6ICAgIFwianNvbnBcIixcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcbiAgICAgICAgICAgIFx0XHRcdFx0ZGF0YToge1xuICAgICAgICAgICAgXHRcdFx0XHRcdGFjdGlvbjogICdqY2tfd29vc29jaWFsX2ZvbGxvd19hY3Rpb24nLFxuICAgICAgICAgICAgXHRcdFx0XHRcdG5vbmNlOiAgIGpja193b29zb2NpYWxfdmFycy5ub25jZSxcbiAgICAgICAgICAgIFx0XHRcdFx0XHR1c2VyX2lkOiB1c2VyX2lkLFxuICAgICAgICAgICAgXHRcdFx0XHRcdHR5cGU6ICAgIHR5cGVcbiAgICAgICAgICAgIFx0XHRcdFx0fSxcbiAgICAgICAgICAgIFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24udGV4dChkYXRhLmJ1dHRvbi50ZXh0KTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLmF0dHIoJ2RhdGEtdHlwZScsZGF0YS5idXR0b24udHlwZSk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5yZW1vdmVDbGFzcyhsb2FkaW5nX2NsYXNzKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLnJlbW92ZUNsYXNzKCdqY2std29vc29jaWFsLWZvbGxvdy1hY3Rpb24tLScrdHlwZSk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5hZGRDbGFzcygnamNrLXdvb3NvY2lhbC1mb2xsb3ctYWN0aW9uLS0nK2RhdGEuYnV0dG9uLnR5cGUpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdGlmKGRhdGEuYWRkX2ZvbGxvd19odG1sKSB7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdGpja193b29zb2NpYWwuZWxzLmFjdGlvbnNfbGlzdC5wcmVwZW5kKGRhdGEuYWRkX2ZvbGxvd19odG1sKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHR9XG4gICAgICAgICAgICBcdFx0XHRcdH0sXG4gICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0fVxuICAgICAgICAgICAgXHRcdFx0fSk7XG4gICAgICAgIFx0XHRcdFxuICAgICAgICBcdFx0XHR9XG4gICAgXHRcdFx0XG4gICAgXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc2V0dXBfcHJvZHVjdF9saWtlX2FjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuamNrLXdvb3NvY2lhbC1wcm9kdWN0LWxpa2UtYWN0aW9uJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgJGJ1dHRvbiA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICRjdXJyZW50X2xpa2VzX2xpc3QgPSAkYnV0dG9uLmNsb3Nlc3QoJy5qY2std29vc29jaWFsLXByb2R1Y3QtbGlrZXMnKSxcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF9pZCA9ICRidXR0b24uYXR0cignZGF0YS1wcm9kdWN0LWlkJyksXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAkYnV0dG9uLmF0dHIoJ2RhdGEtdHlwZScpLFxuICAgICAgICAgICAgICAgICAgICAkY291bnQgPSAkYnV0dG9uLmZpbmQoJy5qY2std29vc29jaWFsLXByb2R1Y3QtbGlrZS1idXR0b25fX2NvdW50JyksXG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmdfY2xhc3MgPSAnamNrLXdvb3NvY2lhbC1wcm9kdWN0LWxpa2UtYWN0aW9uLS1sb2FkaW5nJyxcbiAgICAgICAgICAgICAgICAgICAgJGljb24gPSAkYnV0dG9uLmZpbmQoJ2knKSxcbiAgICAgICAgICAgICAgICAgICAgJGFjdGlvbiA9ICRidXR0b24uY2xvc2VzdCgnLmpjay13b29zb2NpYWwtYWN0aW9uJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoIHR5cGUgIT09IFwibG9naW5cIiApIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmKCAhJGJ1dHRvbi5oYXNDbGFzcyhsb2FkaW5nX2NsYXNzKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICRidXR0b24uYWRkQ2xhc3MobG9hZGluZ19jbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICBcdFx0XHRcdHR5cGU6IFwiR0VUXCIsXG4gICAgICAgICAgICBcdFx0XHRcdHVybDogamNrX3dvb3NvY2lhbF92YXJzLmFqYXhfdXJsLFxuICAgICAgICAgICAgXHRcdFx0XHRjYWNoZTogZmFsc2UsXG4gICAgICAgICAgICBcdFx0XHRcdGRhdGFUeXBlOiBcImpzb25wXCIsXHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0Y3Jvc3NEb21haW46IHRydWUsXG4gICAgICAgICAgICBcdFx0XHRcdGRhdGE6IHtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRhY3Rpb246ICdqY2tfd29vc29jaWFsX3Byb2R1Y3RfbGlrZV9hY3Rpb24nLFxuICAgICAgICAgICAgXHRcdFx0XHRcdG5vbmNlOiBqY2tfd29vc29jaWFsX3ZhcnMubm9uY2UsXG4gICAgICAgICAgICBcdFx0XHRcdFx0cHJvZHVjdF9pZDogcHJvZHVjdF9pZCxcbiAgICAgICAgICAgIFx0XHRcdFx0XHR0eXBlOiB0eXBlXG4gICAgICAgICAgICBcdFx0XHRcdH0sXG4gICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHRpZiggJGNvdW50Lmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHR2YXIgY291bnQgPSBwYXJzZUludCgkY291bnQudGV4dCgpKSxcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0ICAgIG5ld19jb3VudCA9IHR5cGUgPT09IFwibGlrZVwiID8gY291bnQrMSA6IGNvdW50LTE7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkY291bnQudGV4dCggbmV3X2NvdW50ICk7IFxuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLmF0dHIoJ2RhdGEtdHlwZScsIGRhdGEuYnV0dG9uLnR5cGUpO1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5yZW1vdmVDbGFzcyhsb2FkaW5nX2NsYXNzKTtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24ucmVtb3ZlQ2xhc3MoJ2pjay13b29zb2NpYWwtcHJvZHVjdC1saWtlLWFjdGlvbi0tJyt0eXBlKTtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5hZGRDbGFzcygnamNrLXdvb3NvY2lhbC1wcm9kdWN0LWxpa2UtYWN0aW9uLS0nK2RhdGEuYnV0dG9uLnR5cGUpO1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0aWYoIGRhdGEuYnV0dG9uLnR5cGUgPT09IFwidW5saWtlXCIgKSB7XG4gICAgICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkaWNvbi5hdHRyKCdjbGFzcycsJ2pjay13b29zb2NpYWwtaWMtaGVhcnQtZnVsbCcpO1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHR9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBcdFx0XHRcdFx0JGljb24uYXR0cignY2xhc3MnLCdqY2std29vc29jaWFsLWljLWhlYXJ0Jyk7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdH1cbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdGlmKGRhdGEuYWRkX2xpa2VfaHRtbCkge1xuICAgICAgICAgICAgICAgICAgICBcdFx0XHRcdFx0JGN1cnJlbnRfbGlrZXNfbGlzdC5maW5kKCcuamNrLXdvb3NvY2lhbC1wcm9kdWN0LWxpa2VzX19pdGVtLS1saWtlLWJ1dHRvbicpLmFmdGVyKGRhdGEuYWRkX2xpa2VfaHRtbCk7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdH1cbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdGlmKGRhdGEucmVtb3ZlX2xpa2VfY2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgXHRcdFx0XHRcdCRjdXJyZW50X2xpa2VzX2xpc3QuZmluZChkYXRhLnJlbW92ZV9saWtlX2NsYXNzKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0fVx0XHRcdFx0XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdH1cbiAgICAgICAgICAgIFx0XHRcdFx0fSxcbiAgICAgICAgICAgIFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdGVycm9yOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHR9XG4gICAgICAgICAgICBcdFx0XHR9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNldHVwX3RhYnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50YWJfbGlua3Mub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gJCh0aGlzKS5hdHRyKCdocmVmJyksXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZV9jbGFzcyA9ICdqY2std29vc29jaWFsLXByb2ZpbGUtbGluay0tYWN0aXZlJztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50YWJfbGlua3MucmVtb3ZlQ2xhc3MoYWN0aXZlX2NsYXNzKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKGFjdGl2ZV9jbGFzcyk7XG4gICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMudGFiX2NvbnRlbnQuaGlkZSgpO1xuICAgICAgICAgICAgICAgICQodGFyZ2V0KS5zaG93KCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5jaGVja19icmVha3BvaW50cygpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzcGluX2ljb25fc3RhcnQ6IGZ1bmN0aW9uKCAkaWNvbiApe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkaWNvbi5hZGRDbGFzcyggamNrX3dvb3NvY2lhbC52YXJzLmFuaW1hdGVfc3Bpbl9jbGFzcyApO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzcGluX2ljb25fc3RvcDogZnVuY3Rpb24oICRpY29uICl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICRpY29uLnJlbW92ZUNsYXNzKCBqY2tfd29vc29jaWFsLnZhcnMuYW5pbWF0ZV9zcGluX2NsYXNzICk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGRpc2FibGVfbG9hZF9tb3JlX2J1dHRvbjogZnVuY3Rpb24oICRidXR0b24gKXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJGJ1dHRvblxuICAgICAgICAgICAgLmh0bWwoIGpja193b29zb2NpYWxfdmFycy5zdHJpbmdzLm5vX21vcmUgKVxuICAgICAgICAgICAgLnJlbW92ZUF0dHIoJ2hyZWYnKVxuICAgICAgICAgICAgLmFkZENsYXNzKFwiamNrLXdvb3NvY2lhbC1sb2FkLW1vcmUtLWRpc2FibGVkXCIpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzZXR1cF9sb2FkX21vcmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5sb2FkX21vcmVfYnV0dG9uLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyICRsb2FkX21vcmVfYnV0dG9uID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgJGxvYWRfbW9yZV9pY29uID0gJGxvYWRfbW9yZV9idXR0b24uZmluZCgnaScpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggJGxvYWRfbW9yZV9idXR0b24uaGFzQ2xhc3MoXCJqY2std29vc29jaWFsLWxvYWQtbW9yZS0tZGlzYWJsZWRcIikgKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zcGluX2ljb25fc3RhcnQoICRsb2FkX21vcmVfaWNvbiApO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICQodGhpcykuaGFzQ2xhc3MoJ2pjay13b29zb2NpYWwtbG9hZC1tb3JlLS1hY3Rpdml0eScpICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5sb2FkX21vcmVfYWN0aXZpdHkoICQodGhpcyksIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuc3Bpbl9pY29uX3N0b3AoICRsb2FkX21vcmVfaWNvbiApO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggJCh0aGlzKS5oYXNDbGFzcygnamNrLXdvb3NvY2lhbC1sb2FkLW1vcmUtLWxpa2VzJykgKSB7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmxvYWRfbW9yZV9saWtlcyggJCh0aGlzKSwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zcGluX2ljb25fc3RvcCggJGxvYWRfbW9yZV9pY29uICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgbG9hZF9tb3JlX2FjdGl2aXR5OiBmdW5jdGlvbiggJGxvYWRfbW9yZV9idXR0b24sIGNhbGxiYWNrICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgbGltaXQgPSBwYXJzZUludCggJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1saW1pdCcpICksXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtb2Zmc2V0JykgKSxcbiAgICAgICAgICAgICAgICBuZXh0X29mZnNldCA9IGxpbWl0K29mZnNldCxcbiAgICAgICAgICAgICAgICB1c2VyX2lkID0gJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS11c2VyLWlkJyksXG4gICAgICAgICAgICAgICAgcHJvZmlsZV91c2VyX2lkID0gJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1wcm9maWxlLXVzZXItaWQnKSxcbiAgICAgICAgICAgICAgICAkbG9hZF9tb3JlX2l0ZW0gPSAkbG9hZF9tb3JlX2J1dHRvbi5jbG9zZXN0KCdsaScpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgJC5hamF4KHtcblx0XHRcdFx0dHlwZTogICAgICAgIFwiR0VUXCIsXG5cdFx0XHRcdHVybDogICAgICAgICBqY2tfd29vc29jaWFsX3ZhcnMuYWpheF91cmwsXG5cdFx0XHRcdGNhY2hlOiAgICAgICBmYWxzZSxcblx0XHRcdFx0ZGF0YVR5cGU6ICAgIFwianNvbnBcIixcdFx0XHRcdFxuXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcblx0XHRcdFx0ZGF0YToge1xuXHRcdFx0XHRcdGFjdGlvbjogICAgICAgICAgJ2pja193b29zb2NpYWxfbG9hZF9tb3JlX2FjdGl2aXR5Jyxcblx0XHRcdFx0XHRub25jZTogICAgICAgICAgIGpja193b29zb2NpYWxfdmFycy5ub25jZSxcblx0XHRcdFx0XHRsaW1pdDogICAgICAgICAgIGxpbWl0LFxuXHRcdFx0XHRcdG9mZnNldDogICAgICAgICAgb2Zmc2V0LFxuXHRcdFx0XHRcdHVzZXJfaWQ6ICAgICAgICAgdXNlcl9pZCxcblx0XHRcdFx0XHRwcm9maWxlX3VzZXJfaWQ6IHByb2ZpbGVfdXNlcl9pZFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIGRhdGEgKSB7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoIGRhdGEuYWN0aXZpdHlfaHRtbCApIHtcbiAgICBcdFx0XHRcdFx0XG4gICAgXHRcdFx0XHRcdCRsb2FkX21vcmVfaXRlbS5iZWZvcmUoIGRhdGEuYWN0aXZpdHlfaHRtbCApO1xuICAgIFx0XHRcdFx0XHQkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLW9mZnNldCcsIG5leHRfb2Zmc2V0KSA7XG4gICAgXHRcdFx0XHRcdFxuXHRcdFx0XHRcdH0gZWxzZSB7XG4gICAgXHRcdFx0XHRcdFxuICAgIFx0XHRcdFx0XHRqY2tfd29vc29jaWFsLmRpc2FibGVfbG9hZF9tb3JlX2J1dHRvbiggJGxvYWRfbW9yZV9idXR0b24gKTtcbiAgICBcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKGNhbGxiYWNrICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIFx0XHRcdGNhbGxiYWNrKGRhdGEpO1xuICAgICAgICAgICAgXHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0fSxcblx0XHRcdFx0XG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICBcdFx0XHRcdFxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgbG9hZF9tb3JlX2xpa2VzOiBmdW5jdGlvbiggJGxvYWRfbW9yZV9idXR0b24sIGNhbGxiYWNrICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgbGltaXQgPSBwYXJzZUludCggJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1saW1pdCcpICksXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtb2Zmc2V0JykgKSxcbiAgICAgICAgICAgICAgICBuZXh0X29mZnNldCA9IGxpbWl0K29mZnNldCxcbiAgICAgICAgICAgICAgICB1c2VyX2lkID0gJGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS11c2VyLWlkJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAkLmFqYXgoe1xuXHRcdFx0XHR0eXBlOiAgICAgICAgXCJHRVRcIixcblx0XHRcdFx0dXJsOiAgICAgICAgIGpja193b29zb2NpYWxfdmFycy5hamF4X3VybCxcblx0XHRcdFx0Y2FjaGU6ICAgICAgIGZhbHNlLFxuXHRcdFx0XHRkYXRhVHlwZTogICAgXCJqc29ucFwiLFx0XHRcdFx0XG5cdFx0XHRcdGNyb3NzRG9tYWluOiB0cnVlLFxuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uOiAgJ2pja193b29zb2NpYWxfbG9hZF9tb3JlX2xpa2VzJyxcblx0XHRcdFx0XHRub25jZTogICBqY2tfd29vc29jaWFsX3ZhcnMubm9uY2UsXG5cdFx0XHRcdFx0bGltaXQ6ICAgbGltaXQsXG5cdFx0XHRcdFx0b2Zmc2V0OiAgb2Zmc2V0LFxuXHRcdFx0XHRcdHVzZXJfaWQ6IHVzZXJfaWRcblx0XHRcdFx0fSxcblx0XHRcdFx0XG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCBkYXRhICkge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKCBkYXRhLmxpa2VzX2h0bWwgKSB7XG4gICAgXHRcdFx0XHRcdFxuICAgIFx0XHRcdFx0XHRqY2tfd29vc29jaWFsLmVscy5saWtlc19jb250YWluZXIuYXBwZW5kKCBkYXRhLmxpa2VzX2h0bWwgKTtcbiAgICBcdFx0XHRcdFx0JGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1vZmZzZXQnLCBuZXh0X29mZnNldCkgO1xuICAgIFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9IGVsc2Uge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0amNrX3dvb3NvY2lhbC5kaXNhYmxlX2xvYWRfbW9yZV9idXR0b24oICRsb2FkX21vcmVfYnV0dG9uICk7XG4gICAgXHRcdFx0XHRcdFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihjYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBcdFx0XHRjYWxsYmFjayhkYXRhKTtcbiAgICAgICAgICAgIFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgXHRcdFx0XHRcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICBcdFxuICAgIFx0YWRkX3RvX2NhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBcdFxuICAgICAgICBcdGpja193b29zb2NpYWwuZWxzLmRvY3VtZW50X2JvZHkub24oJ2NsaWNrJywgamNrX3dvb3NvY2lhbC52YXJzLmFkZF90b19jYXJ0X2J1dHRvbnNfY2xhc3MsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBcdFxuICAgICAgICAgICAgXHR2YXIgJGJ1dHRvbiA9ICQodGhpcyksXG4gICAgICAgICAgICBcdCAgICBidXR0b25fdGV4dCA9ICRidXR0b24udGV4dCgpO1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgICAgICAgICAgJGJ1dHRvblxuICAgICAgICAgICAgICAgIC5hdHRyKCdkYXRhLWJ1dHRvbi10ZXh0JyxidXR0b25fdGV4dClcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCBqY2tfd29vc29jaWFsLmVscy5sb2FkaW5nX2ljb24gKTtcbiAgICAgICAgICAgIFx0XG4gICAgICAgIFx0fSk7XG4gICAgICAgIFx0XG4gICAgICAgIFx0amNrX3dvb3NvY2lhbC5lbHMuZG9jdW1lbnRfYm9keS5vbiggJ2FkZGVkX3RvX2NhcnQnLCBmdW5jdGlvbiggZSwgZnJhZ21lbnRzLCBjYXJ0X2hhc2gsICRidXR0b24gKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgJHdvb3NvY2lhbF9idXR0b25fd3JhcHBlciA9ICRidXR0b24uY2xvc2VzdCgnLmpjay13b29zb2NpYWwtYWRkLXRvLWNhcnQtd3JhcHBlcicpLFxuICAgICAgICAgICAgICAgICAgICBidXR0b25fdGV4dCA9ICRidXR0b24uYXR0cignZGF0YS1idXR0b24tdGV4dCcpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKCAkd29vc29jaWFsX2J1dHRvbl93cmFwcGVyLmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAkYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5odG1sKCBidXR0b25fdGV4dCApICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCBqY2tfd29vc29jaWFsLmVscy50aWNrX2ljb24gKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgJGJ1dHRvbi5odG1sKCBidXR0b25fdGV4dCApO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0sIDIwMDApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBcdFxuICAgICAgICBcdH0pO1xuICAgICAgICBcdFxuICAgIFx0fSxcbiAgICBcdFxuICAgICAgICBzZXR1cF9icmVha3BvaW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmKCBqY2tfd29vc29jaWFsLmVscy5icmVha3BvaW50X2VsZW1lbnRzLmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gc3RvcmUgYnJlYWtwb2ludCBkYXRhIGluIGNhY2hlIGZvciBmdXR1cmUgcmVmZXJlbmNlXG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5icmVha3BvaW50X2VsZW1lbnRzLmVhY2goZnVuY3Rpb24oIGluZGV4LCBlbGVtZW50ICl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCksXG4gICAgICAgICAgICAgICAgXHQgICAgYnJlYWtwb2ludHMgPSAkZWxlbWVudC5hdHRyKCdkYXRhLWJyZWFrcG9pbnRzJyksXG4gICAgICAgICAgICAgICAgXHQgICAgYnJlYWtwb2ludHNfYXJyYXkgPSAkLnBhcnNlSlNPTiggYnJlYWtwb2ludHMgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnRfb2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgXHRlbGVtZW50OiAkZWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha3BvaW50czogYnJlYWtwb2ludHNfYXJyYXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5icmVha3BvaW50cy5wdXNoKCBicmVha3BvaW50X29iamVjdCApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyB3aGVuIGFuIGVsZW1lbnQgd2lkdGggaGFzIGNoYW5nZWQsIHRyaWdnZXIgYnJlYWtwb2ludCB1cGRhdGVcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuZG9jdW1lbnRfYm9keS5vbignZWxlbWVudF93aWR0aF9jaGFuZ2UnLCBmdW5jdGlvbiggZXZlbnQsIGJyZWFrcG9pbnRfb2JqZWN0ICl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLnVwZGF0ZV9icmVha3BvaW50cyggYnJlYWtwb2ludF9vYmplY3QgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBjaGVja19icmVha3BvaW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgIFxuICAgICAgICAgICAgaWYoIGpja193b29zb2NpYWwuZWxzLmJyZWFrcG9pbnRzLmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFx0JC5lYWNoKGpja193b29zb2NpYWwuZWxzLmJyZWFrcG9pbnRzLCBmdW5jdGlvbihpbmRleCwgYnJlYWtwb2ludF9vYmplY3Qpe1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZpb3VzX3dpZHRoID0gYnJlYWtwb2ludF9vYmplY3Qud2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3dpZHRoID0gYnJlYWtwb2ludF9vYmplY3QuZWxlbWVudC53aWR0aCgpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoIGN1cnJlbnRfd2lkdGggIT09IHByZXZpb3VzX3dpZHRoICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha3BvaW50X29iamVjdC53aWR0aCA9IGN1cnJlbnRfd2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIFx0XG4gICAgICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5kb2N1bWVudF9ib2R5LnRyaWdnZXIoJ2VsZW1lbnRfd2lkdGhfY2hhbmdlJywgW2JyZWFrcG9pbnRfb2JqZWN0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIH0sXG5cbiAgICBcdHVwZGF0ZV9icmVha3BvaW50czogZnVuY3Rpb24oIGJyZWFrcG9pbnRfb2JqZWN0ICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgY3VycmVudF9icmVha3BvaW50ID0gZmFsc2U7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGZpZ3VyZSBvdXQgd2hpY2ggYnJlYWtwb2ludCBkYXRhIHdlIHdhbnQgdG8gdXNlXG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQuZWFjaCggYnJlYWtwb2ludF9vYmplY3QuYnJlYWtwb2ludHMsIGZ1bmN0aW9uKCBpbmRleCwgYnJlYWtwb2ludF9kYXRhICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBcdFxuICAgICAgICAgICAgICAgIGlmKCBicmVha3BvaW50X29iamVjdC53aWR0aCA8PSBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoICEgY3VycmVudF9icmVha3BvaW50ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2JyZWFrcG9pbnQgPSBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIGJyZWFrcG9pbnRfZGF0YS5tYXhfd2lkdGggPD0gY3VycmVudF9icmVha3BvaW50ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2JyZWFrcG9pbnQgPSBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIG5vdyB3ZSBrbm93IHRoZSBicmVha3BvaW50IHRvIHVzZSwgYXBwbHkgdGhhdCBjbGFzcyBhbmQgcmVtb3ZlIHRoZSBvdGhlcnNcbiAgICAgICAgICAgICAgICAgICAgXHRcbiAgICAgICAgICAgICQuZWFjaCggYnJlYWtwb2ludF9vYmplY3QuYnJlYWtwb2ludHMsIGZ1bmN0aW9uKCBpbmRleCwgYnJlYWtwb2ludF9kYXRhICl7XG5cbiAgICAgICAgICAgICAgICBpZiggYnJlYWtwb2ludF9kYXRhLm1heF93aWR0aCA9PT0gY3VycmVudF9icmVha3BvaW50ICkge1xuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnRfb2JqZWN0LmVsZW1lbnQuYWRkQ2xhc3MoIGJyZWFrcG9pbnRfZGF0YS5jbGFzcyApO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICBicmVha3BvaW50X29iamVjdC5lbGVtZW50LnJlbW92ZUNsYXNzKCBicmVha3BvaW50X2RhdGEuY2xhc3MgKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIFx0XG4gICAgXHR9LFxuICAgIFx0XG4gICAgXHRzZXR1cF9jYXJkczogZnVuY3Rpb24oKSB7XG4gICAgICAgIFx0XG4gICAgICAgIFx0amNrX3dvb3NvY2lhbC5lbHMuZG9jdW1lbnRfYm9keS5ob3ZlckludGVudCggXG4gICAgICAgICAgICBcdFxuICAgICAgICBcdCAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgICAgICBcdCAgICB2YXIgJGNhcmQgPSAkKHRoaXMpO1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgICAgICBcdCAgICAkY2FyZC5hZGRDbGFzcyggamNrX3dvb3NvY2lhbC52YXJzLmNhcmRfaG92ZXJfY2xhc3MgKTtcbiAgICAgICAgICAgIFx0ICAgIFxuICAgICAgICBcdCAgICB9LCBcbiAgICAgICAgXHQgICAgXG4gICAgICAgIFx0ICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBcdCAgICBcbiAgICAgICAgICAgIFx0ICAgIHZhciAkY2FyZCA9ICQodGhpcyk7XG4gICAgICAgICAgICBcdCAgICBcbiAgICAgICAgICAgIFx0ICAgICRjYXJkLnJlbW92ZUNsYXNzKCBqY2tfd29vc29jaWFsLnZhcnMuY2FyZF9ob3Zlcl9jbGFzcyApO1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgIFx0ICAgIH0sIFxuICAgICAgICBcdCAgICBcbiAgICAgICAgXHQgICAgamNrX3dvb3NvY2lhbC52YXJzLmNhcmRfZ3JpZF9jYXJkc19jbGFzcyBcbiAgICAgICAgICAgICk7XG4gICAgICAgIFx0XG4gICAgXHR9XG4gICAgIFxuICAgIH07XG4gICAgXG5cdCQoZG9jdW1lbnQpLnJlYWR5KCBqY2tfd29vc29jaWFsLm9uX3JlYWR5KCkgKTtcdFxuXHQkKHdpbmRvdykub24oJ3Njcm9sbCcsIGZ1bmN0aW9uKCkgeyBqY2tfd29vc29jaWFsLm9uX3Njcm9sbCgpOyB9ICk7XG5cdCQod2luZG93KS5vbigncmVzaXplJywgZnVuY3Rpb24oKSB7IGpja193b29zb2NpYWwub25fcmVzaXplKCk7IH0gKTtcblxufShqUXVlcnksIGRvY3VtZW50KSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9