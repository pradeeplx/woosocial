!function(o,a){var t={cache:function(){t.els={},t.vars={},t.vars.is_hidden_class="jck-woosocial--is-hidden",t.vars.animate_spin_class="jck-woosocial-spin",t.vars.add_to_cart_buttons_class=".jck-woosocial-add-to-cart-wrapper .add_to_cart_button",t.vars.card_grid_cards_class=".jck-woosocial-card-grid .jck-woosocial-card",t.vars.card_hover_class="jck-woosocial-card--hover",t.els.document_body=o(a.body),t.els.actions_list=o(".jck-woosocial-actions"),t.els.tab_links=o(".jck-woosocial-profile-link"),t.els.tab_content=o(".jck-woosocial-tab-content"),t.els.load_more_button=o(".jck-woosocial-load-more"),t.els.action_blocks=o(".jck-woosocial-action"),t.els.likes_container=o(".jck-woosocial-user-likes"),t.els.add_to_cart_buttons=o(".jck-woosocial-add-to-cart-wrapper .add_to_cart_button"),t.els.tick_icon=o('<i class="jck-woosocial-ic-tick"></i>'),t.els.loading_icon=o('<i class="jck-woosocial-ic-loading jck-woosocial-spin"></i>'),t.els.card_grids=o(".jck-woosocial-card-grid"),t.els.breakpoint_elements=o("[data-breakpoints]")},on_ready:function(){t.cache(),t.setup_follow_actions(),t.setup_like_action(),t.setup_tabs(),t.setup_load_more(),t.add_to_cart(),t.setup_breakpoints(),t.setup_cards()},on_scroll:function(){},on_resize:function(){t.setup_breakpoints()},setup_follow_actions:function(){o(".jck-woosocial-follow-action").on("click",function(){var a=o(this),s=a.attr("data-user-id"),i=a.attr("data-type"),c="jck-woosocial-follow-action--loading";"login"===i||a.hasClass(c)||(a.addClass(c),o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_follow_action",nonce:jck_woosocial_vars.nonce,user_id:s,type:i},success:function(s){a.text(s.button.text),a.attr("data-type",s.button.type),a.removeClass(c),a.removeClass("jck-woosocial-follow-action--"+i),a.addClass("jck-woosocial-follow-action--"+s.button.type),s.add_follow_html&&t.els.actions_list.prepend(s.add_follow_html),s.remove_follow_class&&o(s.remove_follow_class).remove()},error:function(o){}}))})},setup_like_action:function(){o(a).on("click",".jck-woosocial-like-action",function(){var a=o(this),t=a.closest(".jck-woosocial-likes"),s=a.attr("data-product-id"),i=a.attr("data-type"),c=a.find(".jck-woosocial-like-button__count"),e="jck-woosocial-follow-action--loading";return a.hasClass(e)||(a.addClass(e),o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_like_action",nonce:jck_woosocial_vars.nonce,product_id:s,type:i},success:function(o){if(c.length>0){var s=parseInt(c.text()),n="like"===i?s+1:s-1;c.text(n),a.attr("data-type",o.button.type),a.removeClass(e),a.removeClass("jck-woosocial-like-action--"+i),a.addClass("jck-woosocial-like-action--"+o.button.type),o.add_like_html&&t.find(".jck-woosocial-likes__item--like-button").after(o.add_like_html),o.remove_like_class&&t.find(o.remove_like_class).remove()}},error:function(o){}})),!1})},setup_tabs:function(){t.els.tab_links.on("click",function(){var a=o(this).attr("href"),s="jck-woosocial-profile-link--active";return t.els.tab_links.removeClass(s),o(this).addClass(s),t.els.tab_content.hide(),o(a).show(),t.setup_breakpoints(),!1})},spin_icon_start:function(o){o.addClass(t.vars.animate_spin_class)},spin_icon_stop:function(o){o.removeClass(t.vars.animate_spin_class)},disable_load_more_button:function(o){o.html(jck_woosocial_vars.strings.no_more).removeAttr("href").addClass("jck-woosocial-load-more--disabled")},setup_load_more:function(){t.els.load_more_button.on("click",function(){var a=o(this),s=a.find("i");return a.hasClass("jck-woosocial-load-more--disabled")?!1:(t.spin_icon_start(s),o(this).hasClass("jck-woosocial-load-more--activity")&&t.load_more_activity(o(this),function(){t.spin_icon_stop(s)}),void(o(this).hasClass("jck-woosocial-load-more--likes")&&t.load_more_likes(o(this),function(){t.spin_icon_stop(s)})))})},load_more_activity:function(a,s){var i=parseInt(a.attr("data-limit")),c=parseInt(a.attr("data-offset")),e=i+c,n=a.attr("data-user-id"),l=a.attr("data-profile-user-id"),r=a.closest("li");o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_activity",nonce:jck_woosocial_vars.nonce,limit:i,offset:c,user_id:n,profile_user_id:l},success:function(o){o.activity_html?(r.before(o.activity_html),a.attr("data-offset",e)):t.disable_load_more_button(a),void 0!==s&&s(o)},error:function(o){}})},load_more_likes:function(a,s){var i=parseInt(a.attr("data-limit")),c=parseInt(a.attr("data-offset")),e=i+c,n=a.attr("data-user-id");o.ajax({type:"GET",url:jck_woosocial_vars.ajax_url,cache:!1,dataType:"jsonp",crossDomain:!0,data:{action:"jck_woosocial_load_more_likes",nonce:jck_woosocial_vars.nonce,limit:i,offset:c,user_id:n},success:function(o){o.likes_html?(t.els.likes_container.append(o.likes_html),a.attr("data-offset",e)):t.disable_load_more_button(a),void 0!==s&&s(o)},error:function(o){}})},add_to_cart:function(){t.els.document_body.on("click",t.vars.add_to_cart_buttons_class,function(){var a=o(this),s=a.text();a.attr("data-button-text",s).append(t.els.loading_icon)}),t.els.document_body.on("added_to_cart",function(o,a,s,i){var c=i.closest(".jck-woosocial-add-to-cart-wrapper"),e=i.attr("data-button-text");c.length>0&&(i.html(e).append(t.els.tick_icon),setTimeout(function(){i.html(e)},2e3))})},setup_breakpoints:function(){t.els.breakpoint_elements.length>0&&t.els.breakpoint_elements.each(function(a,t){var s=o(t),i=s.innerWidth(),c=s.attr("data-breakpoints"),e=o.parseJSON(c),n=!1;s.is(":visible")&&(o.each(e,function(o,a){i<=a.max_width&&(n?a.max_width<=n&&(n=a.max_width):n=a.max_width)}),o.each(e,function(o,a){a.max_width===n?s.addClass(a["class"]):s.removeClass(a["class"])}))})},setup_cards:function(){t.els.document_body.hoverIntent(function(){var a=o(this);a.addClass(t.vars.card_hover_class)},function(){var a=o(this);a.removeClass(t.vars.card_hover_class)},t.vars.card_grid_cards_class)}};o(a).ready(t.on_ready()),o(window).on("scroll",function(){t.on_scroll()}),o(window).on("resize",function(){t.on_resize()})}(jQuery,document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwiamNrX3dvb3NvY2lhbCIsImNhY2hlIiwiZWxzIiwidmFycyIsImlzX2hpZGRlbl9jbGFzcyIsImFuaW1hdGVfc3Bpbl9jbGFzcyIsImFkZF90b19jYXJ0X2J1dHRvbnNfY2xhc3MiLCJjYXJkX2dyaWRfY2FyZHNfY2xhc3MiLCJjYXJkX2hvdmVyX2NsYXNzIiwiZG9jdW1lbnRfYm9keSIsImJvZHkiLCJhY3Rpb25zX2xpc3QiLCJ0YWJfbGlua3MiLCJ0YWJfY29udGVudCIsImxvYWRfbW9yZV9idXR0b24iLCJhY3Rpb25fYmxvY2tzIiwibGlrZXNfY29udGFpbmVyIiwiYWRkX3RvX2NhcnRfYnV0dG9ucyIsInRpY2tfaWNvbiIsImxvYWRpbmdfaWNvbiIsImNhcmRfZ3JpZHMiLCJicmVha3BvaW50X2VsZW1lbnRzIiwib25fcmVhZHkiLCJzZXR1cF9mb2xsb3dfYWN0aW9ucyIsInNldHVwX2xpa2VfYWN0aW9uIiwic2V0dXBfdGFicyIsInNldHVwX2xvYWRfbW9yZSIsImFkZF90b19jYXJ0Iiwic2V0dXBfYnJlYWtwb2ludHMiLCJzZXR1cF9jYXJkcyIsIm9uX3Njcm9sbCIsIm9uX3Jlc2l6ZSIsIm9uIiwiJGJ1dHRvbiIsInRoaXMiLCJ1c2VyX2lkIiwiYXR0ciIsInR5cGUiLCJsb2FkaW5nX2NsYXNzIiwiaGFzQ2xhc3MiLCJhZGRDbGFzcyIsImFqYXgiLCJ1cmwiLCJqY2tfd29vc29jaWFsX3ZhcnMiLCJhamF4X3VybCIsImRhdGFUeXBlIiwiY3Jvc3NEb21haW4iLCJkYXRhIiwiYWN0aW9uIiwibm9uY2UiLCJzdWNjZXNzIiwidGV4dCIsImJ1dHRvbiIsInJlbW92ZUNsYXNzIiwiYWRkX2ZvbGxvd19odG1sIiwicHJlcGVuZCIsInJlbW92ZV9mb2xsb3dfY2xhc3MiLCJyZW1vdmUiLCJlcnJvciIsIiRjdXJyZW50X2xpa2VzX2xpc3QiLCJjbG9zZXN0IiwicHJvZHVjdF9pZCIsIiRjb3VudCIsImZpbmQiLCJsZW5ndGgiLCJjb3VudCIsInBhcnNlSW50IiwibmV3X2NvdW50IiwiYWRkX2xpa2VfaHRtbCIsImFmdGVyIiwicmVtb3ZlX2xpa2VfY2xhc3MiLCJ0YXJnZXQiLCJhY3RpdmVfY2xhc3MiLCJoaWRlIiwic2hvdyIsInNwaW5faWNvbl9zdGFydCIsIiRpY29uIiwic3Bpbl9pY29uX3N0b3AiLCJkaXNhYmxlX2xvYWRfbW9yZV9idXR0b24iLCJodG1sIiwic3RyaW5ncyIsIm5vX21vcmUiLCJyZW1vdmVBdHRyIiwiJGxvYWRfbW9yZV9idXR0b24iLCIkbG9hZF9tb3JlX2ljb24iLCJsb2FkX21vcmVfYWN0aXZpdHkiLCJsb2FkX21vcmVfbGlrZXMiLCJjYWxsYmFjayIsImxpbWl0Iiwib2Zmc2V0IiwibmV4dF9vZmZzZXQiLCJwcm9maWxlX3VzZXJfaWQiLCIkbG9hZF9tb3JlX2l0ZW0iLCJhY3Rpdml0eV9odG1sIiwiYmVmb3JlIiwidW5kZWZpbmVkIiwibGlrZXNfaHRtbCIsImFwcGVuZCIsImJ1dHRvbl90ZXh0IiwiZSIsImZyYWdtZW50cyIsImNhcnRfaGFzaCIsIiR3b29zb2NpYWxfYnV0dG9uX3dyYXBwZXIiLCJzZXRUaW1lb3V0IiwiZWFjaCIsImluZGV4IiwiZWxlbWVudCIsIiRlbGVtZW50IiwiZWxlbWVudF93aWR0aCIsImlubmVyV2lkdGgiLCJicmVha3BvaW50cyIsImJyZWFrcG9pbnRzX2FycmF5IiwicGFyc2VKU09OIiwiY3VycmVudF9icmVha3BvaW50IiwiaXMiLCJicmVha3BvaW50X2RhdGEiLCJtYXhfd2lkdGgiLCJob3ZlckludGVudCIsIiRjYXJkIiwicmVhZHkiLCJ3aW5kb3ciLCJqUXVlcnkiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBRUEsR0FBQUMsSUFFQUMsTUFBQSxXQUNBRCxFQUFBRSxPQUNBRixFQUFBRyxRQUVBSCxFQUFBRyxLQUFBQyxnQkFBQSwyQkFDQUosRUFBQUcsS0FBQUUsbUJBQUEscUJBQ0FMLEVBQUFHLEtBQUFHLDBC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eEgsRUFBQW9DLEtBRUFvRixHQUFBOUUsU0FBQXhDLEVBQUFHLEtBQUFLLG1CQUlBLFdBRUEsR0FBQThHLEdBQUF4SCxFQUFBb0MsS0FFQW9GLEdBQUFqRSxZQUFBckQsRUFBQUcsS0FBQUssbUJBSUFSLEVBQUFHLEtBQUFJLHdCQU9BVCxHQUFBQyxHQUFBd0gsTUFBQXZILEVBQUFzQixZQUNBeEIsRUFBQTBILFFBQUF4RixHQUFBLFNBQUEsV0FBQWhDLEVBQUE4QixjQUNBaEMsRUFBQTBILFFBQUF4RixHQUFBLFNBQUEsV0FBQWhDLEVBQUErQixlQUVBMEYsT0FBQTFIIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCQsIGRvY3VtZW50KSB7XG4gICAgXG4gICAgdmFyIGpja193b29zb2NpYWwgPSB7XG4gICAgICAgIFxuICAgICAgICBjYWNoZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscyA9IHt9O1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC52YXJzID0ge307XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwudmFycy5pc19oaWRkZW5fY2xhc3MgPSBcImpjay13b29zb2NpYWwtLWlzLWhpZGRlblwiO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC52YXJzLmFuaW1hdGVfc3Bpbl9jbGFzcyA9IFwiamNrLXdvb3NvY2lhbC1zcGluXCI7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnZhcnMuYWRkX3RvX2NhcnRfYnV0dG9uc19jbGFzcyA9ICcuamNrLXdvb3NvY2lhbC1hZGQtdG8tY2FydC13cmFwcGVyIC5hZGRfdG9fY2FydF9idXR0b24nO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC52YXJzLmNhcmRfZ3JpZF9jYXJkc19jbGFzcyA9ICcuamNrLXdvb3NvY2lhbC1jYXJkLWdyaWQgLmpjay13b29zb2NpYWwtY2FyZCc7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnZhcnMuY2FyZF9ob3Zlcl9jbGFzcyA9ICdqY2std29vc29jaWFsLWNhcmQtLWhvdmVyJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuZG9jdW1lbnRfYm9keSA9ICQoZG9jdW1lbnQuYm9keSk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy5hY3Rpb25zX2xpc3QgPSAkKCcuamNrLXdvb3NvY2lhbC1hY3Rpb25zJyk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLmVscy50YWJfbGlua3MgPSAkKCcuamNrLXdvb3NvY2lhbC1wcm9maWxlLWxpbmsnKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLnRhYl9jb250ZW50ID0gJCgnLmpjay13b29zb2NpYWwtdGFiLWNvbnRlbnQnKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmxvYWRfbW9yZV9idXR0b24gPSAkKCcuamNrLXdvb3NvY2lhbC1sb2FkLW1vcmUnKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmFjdGlvbl9ibG9ja3MgPSAkKCcuamNrLXdvb3NvY2lhbC1hY3Rpb24nKTsgICAgICAgICAgICBcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmxpa2VzX2NvbnRhaW5lciA9ICQoJy5qY2std29vc29jaWFsLXVzZXItbGlrZXMnKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLmFkZF90b19jYXJ0X2J1dHRvbnMgPSAkKCcuamNrLXdvb3NvY2lhbC1hZGQtdG8tY2FydC13cmFwcGVyIC5hZGRfdG9fY2FydF9idXR0b24nKTtcbiAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLnRpY2tfaWNvbiA9ICQoJzxpIGNsYXNzPVwiamNrLXdvb3NvY2lhbC1pYy10aWNrXCI+PC9pPicpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMubG9hZGluZ19pY29uID0gJCgnPGkgY2xhc3M9XCJqY2std29vc29jaWFsLWljLWxvYWRpbmcgamNrLXdvb3NvY2lhbC1zcGluXCI+PC9pPicpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuY2FyZF9ncmlkcyA9ICQoJy5qY2std29vc29jaWFsLWNhcmQtZ3JpZCcpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMuYnJlYWtwb2ludF9lbGVtZW50cyA9ICQoJ1tkYXRhLWJyZWFrcG9pbnRzXScpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gXG4gICAgICAgIG9uX3JlYWR5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5jYWNoZSgpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9mb2xsb3dfYWN0aW9ucygpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9saWtlX2FjdGlvbigpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF90YWJzKCk7XG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX2xvYWRfbW9yZSgpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5hZGRfdG9fY2FydCgpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9icmVha3BvaW50cygpO1xuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5zZXR1cF9jYXJkcygpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBvbl9zY3JvbGw6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBvbl9yZXNpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqY2tfd29vc29jaWFsLnNldHVwX2JyZWFrcG9pbnRzKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgXG4gICAgICAgIHNldHVwX2ZvbGxvd19hY3Rpb25zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJCgnLmpjay13b29zb2NpYWwtZm9sbG93LWFjdGlvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyICRidXR0b24gPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICB1c2VyX2lkID0gJGJ1dHRvbi5hdHRyKCdkYXRhLXVzZXItaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICRidXR0b24uYXR0cignZGF0YS10eXBlJyksXG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmdfY2xhc3MgPSAnamNrLXdvb3NvY2lhbC1mb2xsb3ctYWN0aW9uLS1sb2FkaW5nJztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggdHlwZSA9PT0gXCJsb2dpblwiICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiggISRidXR0b24uaGFzQ2xhc3MobG9hZGluZ19jbGFzcykgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICRidXR0b24uYWRkQ2xhc3MobG9hZGluZ19jbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIFx0XHRcdFx0dHlwZTogICAgICAgIFwiR0VUXCIsXG4gICAgICAgICAgICBcdFx0XHRcdHVybDogICAgICAgICBqY2tfd29vc29jaWFsX3ZhcnMuYWpheF91cmwsXG4gICAgICAgICAgICBcdFx0XHRcdGNhY2hlOiAgICAgICBmYWxzZSxcbiAgICAgICAgICAgIFx0XHRcdFx0ZGF0YVR5cGU6ICAgIFwianNvbnBcIixcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcbiAgICAgICAgICAgIFx0XHRcdFx0ZGF0YToge1xuICAgICAgICAgICAgXHRcdFx0XHRcdGFjdGlvbjogICdqY2tfd29vc29jaWFsX2ZvbGxvd19hY3Rpb24nLFxuICAgICAgICAgICAgXHRcdFx0XHRcdG5vbmNlOiAgIGpja193b29zb2NpYWxfdmFycy5ub25jZSxcbiAgICAgICAgICAgIFx0XHRcdFx0XHR1c2VyX2lkOiB1c2VyX2lkLFxuICAgICAgICAgICAgXHRcdFx0XHRcdHR5cGU6ICAgIHR5cGVcbiAgICAgICAgICAgIFx0XHRcdFx0fSxcbiAgICAgICAgICAgIFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24udGV4dChkYXRhLmJ1dHRvbi50ZXh0KTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLmF0dHIoJ2RhdGEtdHlwZScsZGF0YS5idXR0b24udHlwZSk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5yZW1vdmVDbGFzcyhsb2FkaW5nX2NsYXNzKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLnJlbW92ZUNsYXNzKCdqY2std29vc29jaWFsLWZvbGxvdy1hY3Rpb24tLScrdHlwZSk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5hZGRDbGFzcygnamNrLXdvb3NvY2lhbC1mb2xsb3ctYWN0aW9uLS0nK2RhdGEuYnV0dG9uLnR5cGUpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdGlmKGRhdGEuYWRkX2ZvbGxvd19odG1sKSB7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdGpja193b29zb2NpYWwuZWxzLmFjdGlvbnNfbGlzdC5wcmVwZW5kKGRhdGEuYWRkX2ZvbGxvd19odG1sKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHR9XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0aWYoZGF0YS5yZW1vdmVfZm9sbG93X2NsYXNzKSB7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcdCQoZGF0YS5yZW1vdmVfZm9sbG93X2NsYXNzKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHR9XG4gICAgICAgICAgICBcdFx0XHRcdH0sXG4gICAgICAgICAgICBcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgXHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0fVxuICAgICAgICAgICAgXHRcdFx0fSk7XG4gICAgICAgIFx0XHRcdFxuICAgICAgICBcdFx0XHR9XG4gICAgXHRcdFx0XG4gICAgXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc2V0dXBfbGlrZV9hY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmpjay13b29zb2NpYWwtbGlrZS1hY3Rpb24nLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciAkYnV0dG9uID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgJGN1cnJlbnRfbGlrZXNfbGlzdCA9ICRidXR0b24uY2xvc2VzdCgnLmpjay13b29zb2NpYWwtbGlrZXMnKSxcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdF9pZCA9ICRidXR0b24uYXR0cignZGF0YS1wcm9kdWN0LWlkJyksXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAkYnV0dG9uLmF0dHIoJ2RhdGEtdHlwZScpLFxuICAgICAgICAgICAgICAgICAgICAkY291bnQgPSAkYnV0dG9uLmZpbmQoJy5qY2std29vc29jaWFsLWxpa2UtYnV0dG9uX19jb3VudCcpLFxuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nX2NsYXNzID0gJ2pjay13b29zb2NpYWwtZm9sbG93LWFjdGlvbi0tbG9hZGluZyc7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKCAhJGJ1dHRvbi5oYXNDbGFzcyhsb2FkaW5nX2NsYXNzKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAkYnV0dG9uLmFkZENsYXNzKGxvYWRpbmdfY2xhc3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgXHRcdFx0XHR0eXBlOiBcIkdFVFwiLFxuICAgICAgICBcdFx0XHRcdHVybDogamNrX3dvb3NvY2lhbF92YXJzLmFqYXhfdXJsLFxuICAgICAgICBcdFx0XHRcdGNhY2hlOiBmYWxzZSxcbiAgICAgICAgXHRcdFx0XHRkYXRhVHlwZTogXCJqc29ucFwiLFx0XHRcdFx0XG4gICAgICAgIFx0XHRcdFx0Y3Jvc3NEb21haW46IHRydWUsXG4gICAgICAgIFx0XHRcdFx0ZGF0YToge1xuICAgICAgICBcdFx0XHRcdFx0YWN0aW9uOiAnamNrX3dvb3NvY2lhbF9saWtlX2FjdGlvbicsXG4gICAgICAgIFx0XHRcdFx0XHRub25jZTogamNrX3dvb3NvY2lhbF92YXJzLm5vbmNlLFxuICAgICAgICBcdFx0XHRcdFx0cHJvZHVjdF9pZDogcHJvZHVjdF9pZCxcbiAgICAgICAgXHRcdFx0XHRcdHR5cGU6IHR5cGVcbiAgICAgICAgXHRcdFx0XHR9LFxuICAgICAgICBcdFx0XHRcdFxuICAgICAgICBcdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgIFx0XHRcdFx0XHRpZiggJGNvdW50Lmxlbmd0aCA+IDAgKSB7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0dmFyIGNvdW50ID0gcGFyc2VJbnQoJGNvdW50LnRleHQoKSksXG4gICAgICAgICAgICBcdFx0XHRcdFx0ICAgIG5ld19jb3VudCA9IHR5cGUgPT09IFwibGlrZVwiID8gY291bnQrMSA6IGNvdW50LTE7XG4gICAgICAgICAgICBcdFx0XHRcdFx0XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGNvdW50LnRleHQoIG5ld19jb3VudCApOyBcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLmF0dHIoJ2RhdGEtdHlwZScsIGRhdGEuYnV0dG9uLnR5cGUpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdCRidXR0b24ucmVtb3ZlQ2xhc3MobG9hZGluZ19jbGFzcyk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0JGJ1dHRvbi5yZW1vdmVDbGFzcygnamNrLXdvb3NvY2lhbC1saWtlLWFjdGlvbi0tJyt0eXBlKTtcbiAgICAgICAgICAgIFx0XHRcdFx0XHQkYnV0dG9uLmFkZENsYXNzKCdqY2std29vc29jaWFsLWxpa2UtYWN0aW9uLS0nK2RhdGEuYnV0dG9uLnR5cGUpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdGlmKGRhdGEuYWRkX2xpa2VfaHRtbCkge1xuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHQkY3VycmVudF9saWtlc19saXN0LmZpbmQoJy5qY2std29vc29jaWFsLWxpa2VzX19pdGVtLS1saWtlLWJ1dHRvbicpLmFmdGVyKGRhdGEuYWRkX2xpa2VfaHRtbCk7XG4gICAgICAgICAgICBcdFx0XHRcdFx0fVxuICAgICAgICAgICAgXHRcdFx0XHRcdFxuICAgICAgICAgICAgXHRcdFx0XHRcdGlmKGRhdGEucmVtb3ZlX2xpa2VfY2xhc3MpIHtcbiAgICAgICAgICAgICAgICBcdFx0XHRcdFx0JGN1cnJlbnRfbGlrZXNfbGlzdC5maW5kKGRhdGEucmVtb3ZlX2xpa2VfY2xhc3MpLnJlbW92ZSgpO1xuICAgICAgICAgICAgXHRcdFx0XHRcdH0gICAgIFx0XHRcdFx0XHRcbiAgICAgICAgICAgIFx0XHRcdFx0XHRcbiAgICAgICAgXHRcdFx0XHRcdH1cbiAgICAgICAgXHRcdFx0XHR9LFxuICAgICAgICBcdFx0XHRcdFxuICAgICAgICBcdFx0XHRcdGVycm9yOiBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgICAgIFx0XHRcdFx0XG4gICAgICAgIFx0XHRcdFx0fVxuICAgICAgICBcdFx0XHR9KTtcbiAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzZXR1cF90YWJzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMudGFiX2xpbmtzLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9ICQodGhpcykuYXR0cignaHJlZicpLFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVfY2xhc3MgPSAnamNrLXdvb3NvY2lhbC1wcm9maWxlLWxpbmstLWFjdGl2ZSc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMudGFiX2xpbmtzLnJlbW92ZUNsYXNzKGFjdGl2ZV9jbGFzcyk7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhhY3RpdmVfY2xhc3MpO1xuICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuZWxzLnRhYl9jb250ZW50LmhpZGUoKTtcbiAgICAgICAgICAgICAgICAkKHRhcmdldCkuc2hvdygpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuc2V0dXBfYnJlYWtwb2ludHMoKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc3Bpbl9pY29uX3N0YXJ0OiBmdW5jdGlvbiggJGljb24gKXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJGljb24uYWRkQ2xhc3MoIGpja193b29zb2NpYWwudmFycy5hbmltYXRlX3NwaW5fY2xhc3MgKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc3Bpbl9pY29uX3N0b3A6IGZ1bmN0aW9uKCAkaWNvbiApe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkaWNvbi5yZW1vdmVDbGFzcyggamNrX3dvb3NvY2lhbC52YXJzLmFuaW1hdGVfc3Bpbl9jbGFzcyApO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBkaXNhYmxlX2xvYWRfbW9yZV9idXR0b246IGZ1bmN0aW9uKCAkYnV0dG9uICl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICRidXR0b25cbiAgICAgICAgICAgIC5odG1sKCBqY2tfd29vc29jaWFsX3ZhcnMuc3RyaW5ncy5ub19tb3JlIClcbiAgICAgICAgICAgIC5yZW1vdmVBdHRyKCdocmVmJylcbiAgICAgICAgICAgIC5hZGRDbGFzcyhcImpjay13b29zb2NpYWwtbG9hZC1tb3JlLS1kaXNhYmxlZFwiKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc2V0dXBfbG9hZF9tb3JlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5lbHMubG9hZF9tb3JlX2J1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciAkbG9hZF9tb3JlX2J1dHRvbiA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICRsb2FkX21vcmVfaWNvbiA9ICRsb2FkX21vcmVfYnV0dG9uLmZpbmQoJ2knKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICRsb2FkX21vcmVfYnV0dG9uLmhhc0NsYXNzKFwiamNrLXdvb3NvY2lhbC1sb2FkLW1vcmUtLWRpc2FibGVkXCIpICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuc3Bpbl9pY29uX3N0YXJ0KCAkbG9hZF9tb3JlX2ljb24gKTtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKCAkKHRoaXMpLmhhc0NsYXNzKCdqY2std29vc29jaWFsLWxvYWQtbW9yZS0tYWN0aXZpdHknKSApIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwubG9hZF9tb3JlX2FjdGl2aXR5KCAkKHRoaXMpLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBqY2tfd29vc29jaWFsLnNwaW5faWNvbl9zdG9wKCAkbG9hZF9tb3JlX2ljb24gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoICQodGhpcykuaGFzQ2xhc3MoJ2pjay13b29zb2NpYWwtbG9hZC1tb3JlLS1saWtlcycpICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgamNrX3dvb3NvY2lhbC5sb2FkX21vcmVfbGlrZXMoICQodGhpcyksIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGpja193b29zb2NpYWwuc3Bpbl9pY29uX3N0b3AoICRsb2FkX21vcmVfaWNvbiApO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGxvYWRfbW9yZV9hY3Rpdml0eTogZnVuY3Rpb24oICRsb2FkX21vcmVfYnV0dG9uLCBjYWxsYmFjayApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGxpbWl0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtbGltaXQnKSApLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHBhcnNlSW50KCAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLW9mZnNldCcpICksXG4gICAgICAgICAgICAgICAgbmV4dF9vZmZzZXQgPSBsaW1pdCtvZmZzZXQsXG4gICAgICAgICAgICAgICAgdXNlcl9pZCA9ICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtdXNlci1pZCcpLFxuICAgICAgICAgICAgICAgIHByb2ZpbGVfdXNlcl9pZCA9ICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtcHJvZmlsZS11c2VyLWlkJyksXG4gICAgICAgICAgICAgICAgJGxvYWRfbW9yZV9pdGVtID0gJGxvYWRfbW9yZV9idXR0b24uY2xvc2VzdCgnbGknKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICQuYWpheCh7XG5cdFx0XHRcdHR5cGU6ICAgICAgICBcIkdFVFwiLFxuXHRcdFx0XHR1cmw6ICAgICAgICAgamNrX3dvb3NvY2lhbF92YXJzLmFqYXhfdXJsLFxuXHRcdFx0XHRjYWNoZTogICAgICAgZmFsc2UsXG5cdFx0XHRcdGRhdGFUeXBlOiAgICBcImpzb25wXCIsXHRcdFx0XHRcblx0XHRcdFx0Y3Jvc3NEb21haW46IHRydWUsXG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRhY3Rpb246ICAgICAgICAgICdqY2tfd29vc29jaWFsX2xvYWRfbW9yZV9hY3Rpdml0eScsXG5cdFx0XHRcdFx0bm9uY2U6ICAgICAgICAgICBqY2tfd29vc29jaWFsX3ZhcnMubm9uY2UsXG5cdFx0XHRcdFx0bGltaXQ6ICAgICAgICAgICBsaW1pdCxcblx0XHRcdFx0XHRvZmZzZXQ6ICAgICAgICAgIG9mZnNldCxcblx0XHRcdFx0XHR1c2VyX2lkOiAgICAgICAgIHVzZXJfaWQsXG5cdFx0XHRcdFx0cHJvZmlsZV91c2VyX2lkOiBwcm9maWxlX3VzZXJfaWRcblx0XHRcdFx0fSxcblx0XHRcdFx0XG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCBkYXRhICkge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmKCBkYXRhLmFjdGl2aXR5X2h0bWwgKSB7XG4gICAgXHRcdFx0XHRcdFxuICAgIFx0XHRcdFx0XHQkbG9hZF9tb3JlX2l0ZW0uYmVmb3JlKCBkYXRhLmFjdGl2aXR5X2h0bWwgKTtcbiAgICBcdFx0XHRcdFx0JGxvYWRfbW9yZV9idXR0b24uYXR0cignZGF0YS1vZmZzZXQnLCBuZXh0X29mZnNldCkgO1xuICAgIFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9IGVsc2Uge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0amNrX3dvb3NvY2lhbC5kaXNhYmxlX2xvYWRfbW9yZV9idXR0b24oICRsb2FkX21vcmVfYnV0dG9uICk7XG4gICAgXHRcdFx0XHRcdFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihjYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBcdFx0XHRjYWxsYmFjayhkYXRhKTtcbiAgICAgICAgICAgIFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgXHRcdFx0XHRcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGxvYWRfbW9yZV9saWtlczogZnVuY3Rpb24oICRsb2FkX21vcmVfYnV0dG9uLCBjYWxsYmFjayApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGxpbWl0ID0gcGFyc2VJbnQoICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtbGltaXQnKSApLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHBhcnNlSW50KCAkbG9hZF9tb3JlX2J1dHRvbi5hdHRyKCdkYXRhLW9mZnNldCcpICksXG4gICAgICAgICAgICAgICAgbmV4dF9vZmZzZXQgPSBsaW1pdCtvZmZzZXQsXG4gICAgICAgICAgICAgICAgdXNlcl9pZCA9ICRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtdXNlci1pZCcpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgJC5hamF4KHtcblx0XHRcdFx0dHlwZTogICAgICAgIFwiR0VUXCIsXG5cdFx0XHRcdHVybDogICAgICAgICBqY2tfd29vc29jaWFsX3ZhcnMuYWpheF91cmwsXG5cdFx0XHRcdGNhY2hlOiAgICAgICBmYWxzZSxcblx0XHRcdFx0ZGF0YVR5cGU6ICAgIFwianNvbnBcIixcdFx0XHRcdFxuXHRcdFx0XHRjcm9zc0RvbWFpbjogdHJ1ZSxcblx0XHRcdFx0ZGF0YToge1xuXHRcdFx0XHRcdGFjdGlvbjogICdqY2tfd29vc29jaWFsX2xvYWRfbW9yZV9saWtlcycsXG5cdFx0XHRcdFx0bm9uY2U6ICAgamNrX3dvb3NvY2lhbF92YXJzLm5vbmNlLFxuXHRcdFx0XHRcdGxpbWl0OiAgIGxpbWl0LFxuXHRcdFx0XHRcdG9mZnNldDogIG9mZnNldCxcblx0XHRcdFx0XHR1c2VyX2lkOiB1c2VyX2lkXG5cdFx0XHRcdH0sXG5cdFx0XHRcdFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiggZGF0YS5saWtlc19odG1sICkge1xuICAgIFx0XHRcdFx0XHRcbiAgICBcdFx0XHRcdFx0amNrX3dvb3NvY2lhbC5lbHMubGlrZXNfY29udGFpbmVyLmFwcGVuZCggZGF0YS5saWtlc19odG1sICk7XG4gICAgXHRcdFx0XHRcdCRsb2FkX21vcmVfYnV0dG9uLmF0dHIoJ2RhdGEtb2Zmc2V0JywgbmV4dF9vZmZzZXQpIDtcbiAgICBcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fSBlbHNlIHtcbiAgICBcdFx0XHRcdFx0XG4gICAgXHRcdFx0XHRcdGpja193b29zb2NpYWwuZGlzYWJsZV9sb2FkX21vcmVfYnV0dG9uKCAkbG9hZF9tb3JlX2J1dHRvbiApO1xuICAgIFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYoY2FsbGJhY2sgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgXHRcdFx0Y2FsbGJhY2soZGF0YSk7XG4gICAgICAgICAgICBcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgIFx0XHRcdFx0XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG4gICAgXHRcbiAgICBcdGFkZF90b19jYXJ0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgXHRcbiAgICAgICAgXHRqY2tfd29vc29jaWFsLmVscy5kb2N1bWVudF9ib2R5Lm9uKCdjbGljaycsIGpja193b29zb2NpYWwudmFycy5hZGRfdG9fY2FydF9idXR0b25zX2NsYXNzLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgXHRcbiAgICAgICAgICAgIFx0dmFyICRidXR0b24gPSAkKHRoaXMpLFxuICAgICAgICAgICAgXHQgICAgYnV0dG9uX3RleHQgPSAkYnV0dG9uLnRleHQoKTtcbiAgICAgICAgICAgIFx0ICAgIFxuICAgICAgICAgICAgICAgICRidXR0b25cbiAgICAgICAgICAgICAgICAuYXR0cignZGF0YS1idXR0b24tdGV4dCcsYnV0dG9uX3RleHQpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCggamNrX3dvb3NvY2lhbC5lbHMubG9hZGluZ19pY29uICk7XG4gICAgICAgICAgICBcdFxuICAgICAgICBcdH0pO1xuICAgICAgICBcdFxuICAgICAgICBcdGpja193b29zb2NpYWwuZWxzLmRvY3VtZW50X2JvZHkub24oICdhZGRlZF90b19jYXJ0JywgZnVuY3Rpb24oIGUsIGZyYWdtZW50cywgY2FydF9oYXNoLCAkYnV0dG9uICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyICR3b29zb2NpYWxfYnV0dG9uX3dyYXBwZXIgPSAkYnV0dG9uLmNsb3Nlc3QoJy5qY2std29vc29jaWFsLWFkZC10by1jYXJ0LXdyYXBwZXInKSxcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uX3RleHQgPSAkYnV0dG9uLmF0dHIoJ2RhdGEtYnV0dG9uLXRleHQnKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggJHdvb3NvY2lhbF9idXR0b25fd3JhcHBlci5sZW5ndGggPiAwICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgJGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAuaHRtbCggYnV0dG9uX3RleHQgKSAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCggamNrX3dvb3NvY2lhbC5lbHMudGlja19pY29uICk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICRidXR0b24uaHRtbCggYnV0dG9uX3RleHQgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9LCAyMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXHRcbiAgICAgICAgXHR9KTtcbiAgICAgICAgXHRcbiAgICBcdH0sXG4gICAgXHRcbiAgICBcdHNldHVwX2JyZWFrcG9pbnRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgXHRcbiAgICAgICAgXHRpZiggamNrX3dvb3NvY2lhbC5lbHMuYnJlYWtwb2ludF9lbGVtZW50cy5sZW5ndGggPiAwICkge1xuICAgICAgICAgICAgXHRcbiAgICAgICAgICAgIFx0amNrX3dvb3NvY2lhbC5lbHMuYnJlYWtwb2ludF9lbGVtZW50cy5lYWNoKGZ1bmN0aW9uKCBpbmRleCwgZWxlbWVudCApe1xuICAgICAgICAgICAgICAgIFx0XG4gICAgICAgICAgICAgICAgXHR2YXIgJGVsZW1lbnQgPSAkKGVsZW1lbnQpLFxuICAgICAgICAgICAgICAgIFx0ICAgIGVsZW1lbnRfd2lkdGggPSAkZWxlbWVudC5pbm5lcldpZHRoKCksXG4gICAgICAgICAgICAgICAgXHQgICAgYnJlYWtwb2ludHMgPSAkZWxlbWVudC5hdHRyKCdkYXRhLWJyZWFrcG9pbnRzJyksXG4gICAgICAgICAgICAgICAgXHQgICAgYnJlYWtwb2ludHNfYXJyYXkgPSAkLnBhcnNlSlNPTiggYnJlYWtwb2ludHMgKSxcbiAgICAgICAgICAgICAgICBcdCAgICBjdXJyZW50X2JyZWFrcG9pbnQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmKCAkZWxlbWVudC5pcygnOnZpc2libGUnKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmlndXJlIG91dCB3aGljaCBicmVha3BvaW50IGRhdGEgd2Ugd2FudCB0byB1c2VcbiAgICAgICAgICAgICAgICBcdFxuICAgICAgICAgICAgICAgICAgICBcdCQuZWFjaCggYnJlYWtwb2ludHNfYXJyYXksIGZ1bmN0aW9uKCBpbmRleCwgYnJlYWtwb2ludF9kYXRhICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBcdFxuICAgICAgICAgICAgICAgICAgICAgICAgXHRpZiggZWxlbWVudF93aWR0aCA8PSBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFx0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHRpZiggISBjdXJyZW50X2JyZWFrcG9pbnQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcdCAgICBjdXJyZW50X2JyZWFrcG9pbnQgPSBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFx0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHR9IGVsc2UgaWYgKCBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoIDw9IGN1cnJlbnRfYnJlYWtwb2ludCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHRjdXJyZW50X2JyZWFrcG9pbnQgPSBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFx0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFx0XG4gICAgICAgICAgICAgICAgICAgICAgICBcdH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFx0XG4gICAgICAgICAgICAgICAgICAgIFx0fSk7XG4gICAgICAgICAgICAgICAgICAgIFx0XG4gICAgICAgICAgICAgICAgICAgIFx0Ly8gbm93IHdlIGtub3cgdGggYnJlYWtwb2ludCB0byB1c2UsIGFwcGx5IHRoYXQgY2xhc3MgYW5kIHJlbW92ZSB0aGUgb3RoZXJzXG4gICAgICAgICAgICAgICAgICAgIFx0XG4gICAgICAgICAgICAgICAgICAgIFx0JC5lYWNoKCBicmVha3BvaW50c19hcnJheSwgZnVuY3Rpb24oIGluZGV4LCBicmVha3BvaW50X2RhdGEgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBicmVha3BvaW50X2RhdGEubWF4X3dpZHRoID09PSBjdXJyZW50X2JyZWFrcG9pbnQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZWxlbWVudC5hZGRDbGFzcyggYnJlYWtwb2ludF9kYXRhLmNsYXNzICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZWxlbWVudC5yZW1vdmVDbGFzcyggYnJlYWtwb2ludF9kYXRhLmNsYXNzICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXHRcbiAgICAgICAgICAgICAgICBcdH1cbiAgICAgICAgICAgICAgICBcdFxuICAgICAgICAgICAgXHR9KTtcbiAgICAgICAgICAgIFx0XG4gICAgICAgIFx0fVxuICAgICAgICBcdFxuICAgIFx0fSxcbiAgICBcdFxuICAgIFx0c2V0dXBfY2FyZHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICBcdFxuICAgICAgICBcdGpja193b29zb2NpYWwuZWxzLmRvY3VtZW50X2JvZHkuaG92ZXJJbnRlbnQoIFxuICAgICAgICAgICAgXHRcbiAgICAgICAgXHQgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIFx0ICAgIFxuICAgICAgICAgICAgXHQgICAgdmFyICRjYXJkID0gJCh0aGlzKTtcbiAgICAgICAgICAgIFx0ICAgIFxuICAgICAgICAgICAgXHQgICAgJGNhcmQuYWRkQ2xhc3MoIGpja193b29zb2NpYWwudmFycy5jYXJkX2hvdmVyX2NsYXNzICk7XG4gICAgICAgICAgICBcdCAgICBcbiAgICAgICAgXHQgICAgfSwgXG4gICAgICAgIFx0ICAgIFxuICAgICAgICBcdCAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgICAgICBcdCAgICB2YXIgJGNhcmQgPSAkKHRoaXMpO1xuICAgICAgICAgICAgXHQgICAgXG4gICAgICAgICAgICBcdCAgICAkY2FyZC5yZW1vdmVDbGFzcyggamNrX3dvb3NvY2lhbC52YXJzLmNhcmRfaG92ZXJfY2xhc3MgKTtcbiAgICAgICAgICAgIFx0ICAgIFxuICAgICAgICBcdCAgICB9LCBcbiAgICAgICAgXHQgICAgXG4gICAgICAgIFx0ICAgIGpja193b29zb2NpYWwudmFycy5jYXJkX2dyaWRfY2FyZHNfY2xhc3MgXG4gICAgICAgICAgICApO1xuICAgICAgICBcdFxuICAgIFx0fVxuICAgICBcbiAgICB9O1xuICAgIFxuXHQkKGRvY3VtZW50KS5yZWFkeSggamNrX3dvb3NvY2lhbC5vbl9yZWFkeSgpICk7XHRcblx0JCh3aW5kb3cpLm9uKCdzY3JvbGwnLCBmdW5jdGlvbigpIHsgamNrX3dvb3NvY2lhbC5vbl9zY3JvbGwoKTsgfSApO1xuXHQkKHdpbmRvdykub24oJ3Jlc2l6ZScsIGZ1bmN0aW9uKCkgeyBqY2tfd29vc29jaWFsLm9uX3Jlc2l6ZSgpOyB9ICk7XG5cbn0oalF1ZXJ5LCBkb2N1bWVudCkpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==